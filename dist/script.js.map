{"version":3,"sources":["source/scripts/collections/blocks.js","source/scripts/collections/courses.js","source/scripts/collections/sessions.js","source/scripts/collections/templates.js","source/scripts/collections/tickets.js","source/scripts/collections/users.js","source/scripts/components/labels.js","source/scripts/components/modal.js","source/scripts/components/prefill.js","source/scripts/listeners.js","source/scripts/polyfill.js","source/scripts/root.js","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":["blocks","module","exports","memory","load","element","innerHTML","Object","keys","reduce","html","key","render_one","dataset","addEventListener","e","drag_x","clientX","drag_y","clientY","drag_block","document","body","style","right","top","root","main","classList","removeAttribute","contains","remove","editor","add_block","courses","add","send","request","view_mode","mode","updated","save_search","search_query","String","value","toLowerCase","edit","options","course","v","property","callback","list","querySelector","history","state","load_course","labels","loading","render","iteration","Math","floor","random","length","children","no_results","message","search","shift","archived","name","indexOf","manager_filter","admin","requestAnimationFrame","elem","createElement","appendChild","archive","toggle_manager","filter","index","toggle","splice","push","load_managers","users","user","role","avatar","JSON","stringify","thumbnail","course_nav","focus","format","date","Date","months","getDate","getMonth","getFullYear","getHours","getMinutes","published_at","view","sessions","url","page","load_page","prevent_url","invite","stats","updater","setTimeout","default_page","load_login","me","session","sign_in","email","parentElement","password","sign_out","check_passwords","inputs","querySelectorAll","alert","old_password","res","localStorage","getItem","forEach","c","window","scrollTo","modal","close","operation","replace","decode","location","pathname","title","encode","parts","split","i","load_courses","language","change_language","setItem","reload","highlight_lang","format_date","format_time","start","console","log","hide_notification","tickets","block","open_invite_block","ticket","toggle_course","ticket_nav","load_clients","load_profile","load_profile_link","load_permissions","render_tasks","tasks","memo","task","load_permission","input","id","add_permission","archive_permission","parseInt","setAttribute","update_permission","checked","map","pop","update_task","users_admin","slice","update","toUpperCase","selectionStart","selectionEnd","save_email","load_email","LANGS","landing","landing_text","landing_description","landing_feel_good","landing_feel_good_description","landing_share_page","landing_joris_merel","landing_joris_merel_description","about_text","about_joris","about_merel","about","sign_in_input","invitations","managers","stats_short","copy","viewed","published","unpublished","edit_password","placeholder","new_password","placeholder_search","save_profile","clients","app_settings","n","hasOwnProperty","label","el","modal_element","open","transform","scrollY","scrollTop","scroll","scrolltop","empty","prefill","collection","item","property_key","property_collection","select","input_collection","submit","selection","ul","loop","updates","init","bind","documentElement","listener","target","type","preventDefault","error","elements","call","bind_one","MutationObserver","observer","observe","attributes","subtree","childList","characterData","mutations","attributeName","d","config","join","prop","text","bg","obj","escape","backgroundImage","load_file","substring","str","xhr","XMLHttpRequest","onreadystatechange","readyState","status","templates","responseText","match","assign","defineProperty","enumerable","configurable","writable","undefined","TypeError","to","arguments","nextSource","keysArray","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","Element","prototype","Array","DOMTokenList","classes","className","token","toString","defineElementGetter","getter","get","__defineGetter__","require","DEV_MODE","incoming","create_websocket","query","pair","p","callbacks","encodeURIComponent","WebSocket","ws","Send","parse","data","removeEventListener","cb","m","merge","notify","redirect","href","MozWebSocket","br","brunch","ar","disabled","_ar","cacheBuster","round","now","browser","navigator","userAgent","forceRepaint","reloaders","stylesheet","link","val","getAttribute","offsetHeight","javascript","scripts","textScripts","script","srcScripts","src","loaded","all","onLoad","eval","newScript","async","onload","head","port","host","server","hostname","connect","connection","onmessage","event","reloader","onerror","onclose"],"mappings":"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","file":"dist/script.js","sourcesContent":["let blocks = module.exports = {\r\n\r\n  memory: [],\r\n\r\n  load: (element) => {\r\n\r\n    element.innerHTML = Object.keys(blocks.memory).reduce((html, key) => `${ html }\r\n      <div><a style=\"background-image:url(/${ key }.jpg);\" data-key=\"${ key }\" data-load=\"blocks.render_one\"></a></div>`, '');\r\n      \r\n  },\r\n\r\n  render_one: (element) => {\r\n\r\n    element.innerHTML = `${ element.dataset.key }`;\r\n\r\n    element.addEventListener('mousedown', (e)=>{\r\n\r\n      blocks.drag_x = e.clientX;\r\n\r\n      blocks.drag_y = e.clientY;\r\n\r\n      blocks.drag_block = element;\r\n\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\ndocument.body.addEventListener('mousemove', (e)=>{\r\n\r\n  if(!blocks.drag_block) return e;\r\n\r\n  blocks.drag_block.style.right = `${ blocks.drag_x - e.clientX }px`;\r\n\r\n  blocks.drag_block.style.top = `${ e.clientY - blocks.drag_y }px`;\r\n\r\n  root.main.classList[blocks.drag_x - e.clientX > 190 ? 'add' : 'remove']('dropzone');\r\n\r\n});\r\n\r\ndocument.body.addEventListener('mouseup', (e)=>{\r\n\r\n  if(!blocks.drag_block) return e;\r\n\r\n  let key = blocks.drag_block.dataset.key;\r\n\r\n  blocks.drag_block.removeAttribute('style');\r\n\r\n  blocks.drag_block = null;\r\n\r\n  if(!root.main.classList.contains('dropzone')) return e;\r\n\r\n  root.main.classList.remove('dropzone');\r\n\r\n  root.editor.add_block(key);\r\n\r\n});","let courses = module.exports = {\r\n\r\n  // here we save all courses in client memory\r\n  // { [key]: OBJECT }\r\n  memory: {},\r\n\r\n  // button is placed to the right of the title of the page\r\n  add: (element) => {\r\n\r\n    // root.send is used to talk to the server\r\n    root.send({ request: 'new_course' });\r\n\r\n  },\r\n\r\n  // view mode can be cards or list, it has a button in the left top of the interface\r\n  view_mode: (element) => {\r\n\r\n    courses.mode = element.dataset.mode;\r\n\r\n    // we put the mode also in the main, to support CSS styling\r\n    root.main.dataset.mode = element.dataset.mode;\r\n\r\n    // see update loop at the bottom of this file\r\n\tcourses.updated = true;\r\n    \r\n  },\r\n  \r\n  // anytime the user triggers the data-input of the search field, we execute this\r\n  save_search: (element) => {\r\n\r\n    // used inside of courses.render()\r\n\tcourses.search_query = String(element.value || '').toLowerCase();\r\n\r\n    // see update loop at the bottom of this file\r\n\tcourses.updated = true;\r\n\r\n  },\r\n\r\n  // goes off anytime course-related data-input is fired\r\n  edit: (element, options) => {\r\n\r\n    // we always need to provide a request string and the key of the object we are editing\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.course\r\n     };\r\n\r\n     // but the value we are changing shall be added dynamically,\r\n     // so we can use this edit function straight from the HTML\r\n     // <input data-input=\"courses.edit\" data-key=\"[KEY]\">\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     // options.callback can only be used when this function is fired manually in Javascript\r\n     // since we cannot write a function inside of the HTML tag\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n\r\n  list: (element) => {\r\n\r\n    // we are lazy developers that do not want to select the list over and over\r\n    // whenever we use this list function manually\r\n    if(!element) element = document.querySelector('[data-load=\"courses.list\"]');\r\n\r\n    // element still not found?! we must stop this madness\r\n    if(!element) return;\r\n\r\n    if(history.state.course) return courses.load_course(element);\r\n    \r\n    // we clean out the old HTML should this function be fired after the list already rendered\r\n    element.innerHTML = ``;\r\n\r\n    // we show a loading text\r\n    root.labels.loading(element);\r\n\r\n    // and start the render loop!\r\n    courses.render(element);\r\n\r\n  },\r\n\r\n  load_course: (element) => {\r\n\r\n    element.innerHTML = `<div data-load=\"courses.render_one\" data-course=\"${ history.state.course }\"></div>`;\r\n\r\n  },\r\n\r\n\r\n  render: (element, keys, iteration) => {\r\n\r\n    // maybe the user navigated away? Somehow the element is gone, RIP loop :'(\r\n    if(!element) return;\r\n\r\n    // we need to make sure we only run 1 loop at the same time\r\n    // every time render is called outside of its own loop, iteration will be undefined\r\n    // so we use this condition to also update the dataset of the element\r\n    // in order for the old loop to kill itself...\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    // if it turns out this execution is an outdated iteration,\r\n    // the element has updated its dataset.iteration outside of this loop\r\n    // we have to bring this loop to the white shores\r\n    // I offer this line of comment in dedication to the loop whos life will be cut before the natural end\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    // every time render is called outside of its own loop, keys will be undefined\r\n    if(!keys) keys = Object.keys(courses.memory);\r\n\r\n    // the loop has finished\r\n    if(!keys.length) {\r\n\r\n        // sadly, no children are found inside of the element\r\n        // this can only mean there were no results\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        // we had results, and are no longer loading, so lets clear that loading message\r\n        return element.dataset.message = '';\r\n\r\n    }\r\n\r\n    let search = courses.search_query, // search value is changed by courses.save_search()\r\n        course = courses.memory[keys.shift()];\r\n\r\n    if(!course || course.archived ||\r\n      (search && String(course.name).toLowerCase().indexOf(search) == -1) ||\r\n      (courses.manager_filter.length && courses.manager_filter.indexOf(course.admin) == -1)\r\n    ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         courses.render(element, keys, iteration);\r\n\r\n       });\r\n\r\n       return courses.render(element, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      courses.render(element, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'courses.render_one';\r\n\r\n    elem.dataset.course = course.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  archive: (element) => {\r\n\r\n    let course = courses.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: course.key }, () => {\r\n\r\n      // see update loop at the bottom of this file\r\n      courses.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  manager_filter: [],\r\n\r\n  toggle_manager: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        filter = courses.manager_filter,\r\n        index = filter.indexOf(key);\r\n\r\n    element.classList.toggle('active');\r\n\r\n    if(index > -1) filter.splice(index, 1);\r\n\r\n    else filter.push(key);\r\n\r\n    courses.updated = true;\r\n\r\n  },\r\n\r\n  load_managers: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.users.memory).reduce((html, key) => {\r\n\r\n      let user = root.users.memory[key];\r\n\r\n      if(user.role == 'admin') html += `<div data-click=\"courses.toggle_manager\" data-key=\"${ user.key }\">\r\n        <img src=\"${ user.avatar }\">\r\n        <span data-load=\"users.memory.${ user.key }.name\"></span>\r\n      </div>`;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n    \r\n    let course = courses.memory[element.dataset.course];\r\n\r\n    element.dataset.key = element.dataset.course;\r\n\r\n    element.innerHTML = courses.mode == 'lists' ? `\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n      <pre>${ JSON.stringify(course, null, 2) }</pre>\r\n    ` : `\r\n      <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n      ${ courses.course_nav(element) }\r\n      <img src=\"${ root.users.memory[course.admin].avatar }\">\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n      <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n    `;\r\n\r\n    if(!course.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  course_nav: (element) => {\r\n\r\n   let course = root.courses.memory[element.dataset.key];\r\n\r\n   return `<div class=\"course-nav\">\r\n        ${ course.published_at ? '<span class=\"published\">PUBLISHED</span>' : '<span class=\"unpublished\">UNPUBLISHED</span>' }<br>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"courses.view\" data-load=\"labels.view\"></a>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"courses.invite\" data-load=\"labels.invite\"></a>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"courses.stats\" data-load=\"labels.stats_short\"></a>\r\n      </div>`;\r\n      \r\n  },\r\n\r\n  view: (element) => {\r\n\r\n    root.sessions.url({ page: 'edit', course: element.dataset.key });\r\n\r\n    root.sessions.load_page(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n\r\n  invite: (element) => {\r\n\r\n    let course = root.courses.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.invite\"></h3>\r\n        ${ courses.course_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n        <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n  \r\n  stats: (element) => {\r\n    \r\n    let course = root.courses.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.stats\"></h3>\r\n        ${ courses.course_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n        <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n    \r\n  }\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!courses.updated) return setTimeout(updater, 300);\r\n\r\n  courses.updated = false;\r\n\r\n  if(root.main.dataset.load == 'edit.html') root.main.dataset.load = 'edit.html'; // this correctly triggers the mutationobserver in listeners.js\r\n\r\n  else courses.list();\r\n\r\n  updater();\r\n\r\n}());","let sessions = module.exports = {\r\n\r\n  default_page: 'landing',\r\n\r\n  memory: {},\r\n  \r\n  load: function load(){\r\n\r\n    root.main = document.querySelector('main');\r\n\r\n    if(!root.main) return setTimeout(load, 0);\r\n    \r\n    sessions.url(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n  load_login: (element) => {\r\n\r\n    if(!root.me.session) return;\r\n\r\n    sessions.url('/courses');\r\n\r\n    sessions.load_page(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n  sign_in: (element) => {\r\n\r\n    root.send({\r\n      request: 'sign_in',\r\n      email: element.parentElement.querySelector('[type=\"email\"]').value || '',\r\n      password: element.parentElement.querySelector('[type=\"password\"]').value || '',\r\n    }, () => {\r\n\r\n      sessions.url('/courses');\r\n\r\n      sessions.load_page(null, { prevent_url: true });\r\n\r\n    });\r\n  \t\r\n  },\r\n\r\n  sign_out: (element) => {\r\n\r\n    root.send({ request: 'sign_out' });\r\n\r\n  },\r\n\r\n  check_passwords: (element) => {\r\n\r\n    let inputs = root.main.querySelectorAll('input[type=\"password\"]');\r\n\r\n    if(inputs[0].value != inputs[1].value) return alert('not equal');\r\n\r\n    root.send({\r\n      request: 'set_password',\r\n      old_password: inputs[0].value,\r\n      password: inputs[2].value || ''\r\n    }, (res) => {\r\n\r\n   \r\n\r\n    });\r\n\r\n  },\r\n\r\n  load_page: (elem, options) => {\r\n\r\n    if(!root.main) return setTimeout(root.main, 0, elem, options);\r\n\r\n    let page = elem ? elem.dataset.page : history.state ? history.state.page : 'landing';\r\n\r\n    if(!localStorage.getItem('authenticated') && ['landing', 'login', 'about'].indexOf(page) == -1) {\r\n      page = 'landing';\r\n    }\r\n\r\n    document.body.classList.forEach((c) => {\r\n\r\n      if(c.indexOf('-page') == -1) return;\r\n\r\n      document.body.classList.remove(c);\r\n\r\n    });\r\n\r\n    document.body.classList.remove('notified');\r\n\r\n    document.body.classList.add(page + '-page');\r\n    \r\n    root.main.dataset.load = page + '.html';\r\n\r\n    if(!options || !options.prevent_url) sessions.url('/' + page);\r\n\r\n    window.scrollTo(0, 0);\r\n\r\n    root.modal.close();\r\n\r\n  },\r\n\r\n  url: (state, options) => {\r\n\r\n    let operation = options && options.replace ? 'replaceState' : 'pushState';\r\n\r\n    let url = typeof state == 'string' ? decode() : location.pathname;\r\n\r\n    return history[operation](state ? state : decode(), options ? options.title : document.title, state ? encode() : pathname);\r\n\r\n    function encode() {\r\n\r\n      let page = state ? state.page || sessions.default_page : sessions.default_page;\r\n\r\n      return Object.keys(state).reduce((url,key)=>{\r\n\r\n        if (key == 'page') return url;\r\n\r\n        return `${url}/${key}/${ state[key] }`;\r\n\r\n      }\r\n      , `/${ page == sessions.default_page ? '' : page }`);\r\n\r\n    }\r\n\r\n    function decode() {\r\n\r\n      let parts = (state || location.pathname).split(/\\//g);\r\n\r\n      state = {};\r\n\r\n      for (let i = 0; i < parts.length; i += 2) {\r\n\r\n        state[parts[i] || 'page'] = parts[i + 1];\r\n\r\n      }\r\n\r\n      state.page = state.page || sessions.default_page;\r\n      \r\n      return state;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};","module.exports = {\r\n\r\n  load_courses: (element) => {\r\n\r\n\tlet html = '',\r\n\t\tkeys = Object.keys(root.courses.memory);\r\n\r\n\tfor(var i = 0; i < keys.length; i++) {\r\n\t\r\n\t\tlet course = root.courses.memory[keys[i]];\r\n\r\n\t\thtml += `\r\n\t\t\t<div class=\"invite-course\" data-key=\"${ keys[i] }\">\r\n\r\n\t\t\t\t<div class=\"thumbnail-container\"><img src=\"${ course.thumbnail }\"></div>\r\n\r\n\t\t\t\t<span>${ course.name }</span>\r\n\r\n\t\t\t\t<small class=\"lang ${ course.language }\"></small>\r\n\r\n\t\t\t</div>\r\n\t\t`;\r\n\r\n\t};\r\n\r\n\telement.innerHTML = html;\r\n\r\n  },\r\n\r\n  change_language: (element) => {\r\n\r\n\tlocalStorage.setItem('language', element.dataset.language);\r\n\r\n\tlocation.reload();\r\n\r\n  },\r\n\r\n  highlight_lang: (element) => {\r\n\r\n  \tif(!element.classList.contains(localStorage.getItem('language') || 'nl')) return;\r\n\r\n  \telement.classList.add('active');\r\n  \t\r\n  },\r\n\r\n  format_date: (element) => {\r\n\r\n  \tlet date = new Date(element.dataset.date),\r\n\t\tmonths = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n\tif (!date || String(date).toLowerCase() == 'invalid date') return;\r\n\r\n\telement.innerHTML = `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;\r\n\r\n  },\r\n\r\n  format_time: (element) => {\r\n\r\n  \tlet date = new Date(element.dataset.date);\r\n\r\n\tif (!date || String(date).toLowerCase() == 'invalid date') return;\r\n\r\n  \telement.innerHTML = `${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }`;\r\n\r\n  },\r\n\r\n  start: (element) => {\r\n\r\n\tconsole.log('e', element);\r\n  \t\r\n  },\r\n\r\n  hide_notification: (element) => {\r\n  \t\r\n  \tdocument.querySelector('body').classList.remove('notified');\r\n\r\n  }\r\n\r\n};","let tickets = module.exports = {\r\n\r\n  // here we save all tickets in client memory\r\n  // { [key]: OBJECT }\r\n  memory: {},\r\n\r\n  change_language: (element) => {\r\n\r\n    let block = document.querySelector('#invite-block');\r\n\r\n    block.dataset.language = element.dataset.language;\r\n\r\n  },\r\n\r\n  open_invite_block: (element) => {\r\n\r\n    let block = document.querySelector('#invite-block');\r\n\r\n    block.classList.toggle('open');\r\n\r\n  },\r\n\r\n  // button is placed to the right of the title of the page\r\n  add: (element) => {\r\n\r\n    // root.send is used to talk to the server\r\n    root.send({ request: 'new_ticket' });\r\n\r\n  },\r\n\r\n  // anytime the user triggers the data-input of the search field, we execute this\r\n  save_search: (element) => {\r\n\r\n    // used inside of tickets.render()\r\n\ttickets.search_query = String(element.value || '').toLowerCase();\r\n\r\n    // see update loop at the bottom of this file\r\n\ttickets.updated = true;\r\n\r\n  },\r\n\r\n  // goes off anytime ticket-related data-input is fired\r\n  edit: (element, options) => {\r\n\r\n    // we always need to provide a request string and the key of the object we are editing\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.ticket\r\n     };\r\n\r\n     // but the value we are changing shall be added dynamically,\r\n     // so we can use this edit function straight from the HTML\r\n     // <input data-input=\"tickets.edit\" data-key=\"[KEY]\">\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     // options.callback can only be used when this function is fired manually in Javascript\r\n     // since we cannot write a function inside of the HTML tag\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n\r\n  list: (element) => {\r\n\r\n    // we are lazy developers that do not want to select the list over and over\r\n    // whenever we use this list function manually\r\n    if(!element) element = document.querySelector('[data-load=\"tickets.list\"]');\r\n\r\n    // element still not found?! we must stop this madness\r\n    if(!element) return;\r\n    \r\n    // we clean out the old HTML should this function be fired after the list already rendered\r\n    element.innerHTML = ``;\r\n\r\n    // we show a loading text\r\n    root.labels.loading(element);\r\n\r\n    // and start the render loop!\r\n    tickets.render(element);\r\n\r\n  },\r\n\r\n\r\n  render: (element, keys, iteration) => {\r\n\r\n    // maybe the user navigated away? Somehow the element is gone, RIP loop :'(\r\n    if(!element) return;\r\n\r\n    // we need to make sure we only run 1 loop at the same time\r\n    // every time render is called outside of its own loop, iteration will be undefined\r\n    // so we use this condition to also update the dataset of the element\r\n    // in order for the old loop to kill itself...\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    // if it turns out this execution is an outdated iteration,\r\n    // the element has updated its dataset.iteration outside of this loop\r\n    // we have to bring this loop to the white shores\r\n    // I offer this line of comment in dedication to the loop whos life will be cut before the natural end\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    // every time render is called outside of its own loop, keys will be undefined\r\n    if(!keys) keys = Object.keys(tickets.memory);\r\n\r\n    // the loop has finished\r\n    if(!keys.length) {\r\n\r\n        // sadly, no children are found inside of the element\r\n        // this can only mean there were no results\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        // we had results, and are no longer loading, so lets clear that loading message\r\n        return element.dataset.message = '';\r\n\r\n    }\r\n\r\n    let search = tickets.search_query, // search value is changed by tickets.save_search()\r\n        ticket = tickets.memory[keys.shift()];\r\n\r\n    if(!ticket || ticket.archived ||\r\n      (search && String(ticket.name).toLowerCase().indexOf(search) == -1) ||\r\n      (tickets.manager_filter.length && tickets.manager_filter.indexOf(ticket.admin) == -1)\r\n    ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         tickets.render(element, keys, iteration);\r\n\r\n       });\r\n\r\n       return tickets.render(element, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      tickets.render(element, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'tickets.render_one';\r\n\r\n    elem.dataset.ticket = ticket.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  archive: (element) => {\r\n\r\n    let ticket = tickets.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: ticket.key }, () => {\r\n\r\n      // see update loop at the bottom of this file\r\n      tickets.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  manager_filter: [],\r\n\r\n  toggle_course: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        filter = tickets.manager_filter,\r\n        index = filter.indexOf(key);\r\n\r\n    element.classList.toggle('active');\r\n\r\n    if(index > -1) filter.splice(index, 1);\r\n\r\n    else filter.push(key);\r\n\r\n    tickets.updated = true;\r\n\r\n  },\r\n\r\n  load_courses: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.courses.memory).reduce((html, key) => {\r\n\r\n      return html + `<div data-click=\"tickets.toggle_course\" data-key=\"${ key }\">\r\n        <span data-load=\"courses.memory.${ key }.name\"></span>\r\n      </div>`;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n\r\n    let ticket = tickets.memory[element.dataset.ticket];\r\n\r\n    element.dataset.key = element.dataset.ticket;\r\n\r\n    element.innerHTML = tickets.mode == 'lists' ? `\r\n      <span data-load=\"tickets.memory.${ element.dataset.key }.name\"></span>\r\n      <pre>${ JSON.stringify(ticket, null, 2) }</pre>\r\n    ` : `\r\n      <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n      ${ tickets.ticket_nav(element) }\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n      <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n    `;\r\n\r\n    if(!ticket.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  ticket_nav: (element) => {\r\n\r\n   return `<div>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.view\" data-load=\"labels.view\"></button>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.invite\" data-load=\"labels.invite\"></button>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.stats\" data-load=\"labels.stats_short\"></button>\r\n      </div>`;\r\n      \r\n  },\r\n\r\n  view: (element) => {\r\n\r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.view\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n\r\n\r\n  invite: (element) => {\r\n\r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.invite\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n  \r\n  stats: (element) => {\r\n    \r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.stats\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n    \r\n  }\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!tickets.updated) return setTimeout(updater, 300);\r\n\r\n  tickets.updated = false;\r\n\r\n  tickets.list();\r\n\r\n  updater();\r\n\r\n}());","let users = module.exports = {\r\n\r\n  memory: {},\r\n\r\n  add: (element) => {\r\n\r\n    root.send({ request: 'new_user' });\r\n\r\n  },\r\n\r\n  load_clients: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.users.memory).reduce((html, key) => {\r\n\r\n      let user = root.users.memory[key];\r\n\r\n      if(user.role == 'client') html += `\r\n\r\n        <div class=\"${ user.key == root.me.user ? 'me' : '' }\" data-key=\"${ user.key }\">\r\n          <img src=\"${ user.avatar }\">\r\n          <span data-load=\"users.memory.${ user.key }.name\"></span>\r\n          <span data-load=\"users.memory.${ user.key }.email\"></span>\r\n        </div>\r\n\r\n      `;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n    \r\n  },\r\n\r\n  load_managers: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.users.memory).reduce((html, key) => {\r\n\r\n      let user = root.users.memory[key];\r\n\r\n      if(user.role == 'admin') html += `\r\n\r\n        <div class=\"${ user.key == root.me.user ? 'me' : '' }\" data-key=\"${ user.key }\">\r\n          <img src=\"${ user.avatar }\">\r\n          <span data-load=\"users.memory.${ user.key }.name\"></span>\r\n          <span data-load=\"users.memory.${ user.key }.email\"></span>\r\n        </div>\r\n\r\n      `;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  load_profile: (element) => {\r\n\r\n    let user = root.users.memory[root.me.user];\r\n\r\n    element.innerHTML = `\r\n\r\n        <img class=\"avatar\" src=\"${ user.avatar }\"><br>\r\n\r\n        <div class=\"divider horizontal grey\"></div>\r\n\r\n        <input type=\"input\" value=\"${ user.name }\"><br>\r\n\r\n        <a data-load=\"labels.sign_out\" data-click=\"sessions.sign_out\"></a>\r\n\r\n    `;\r\n\r\n  },\r\n\r\n  load_profile_link: (element) => {\r\n    \r\n    if(!root.me) return setTimeout(users.load_profile_link, 200, element);\r\n\r\n    if(!root.me.user) return;\r\n\r\n    let user = users.memory[root.me.user];\r\n\r\n    if(!user) return;\r\n\r\n    element.innerHTML = `\r\n\r\n      <div class=\"img-container\"><img src=\"${ user.avatar }\"></div>\r\n      <span>${ user.name }</span>\r\n      \r\n    `;\r\n\r\n  },\r\n  \r\n  load_permissions: (element) => {\r\n\r\n    element.innerHTML = `\r\n      <label class=\"dark-grey\" data-load=\"labels.permissions\"></label><br>\r\n\r\n      <div class=\"row\">\r\n        <input id=\"add\" data-load=\"users.load_permission\" data-change=\"users.update_permission\" type=\"checkbox\">\r\n        <label for=\"add\" class=\"task fa fa-user-plus\"></label>\r\n        <input disabled type=\"text\" value=\"ADMIN\">\r\n      </div>\r\n\r\n     ${ users.render_tasks() }\r\n      `;\r\n    \r\n  },\r\n\r\n  render_tasks: () => {\r\n\r\n    let user = users.memory[root.me.user];\r\n\r\n    return user.tasks.reduce((memo, task, index) => {\r\n\r\n      memo += `\r\n      <div class=\"row\">\r\n        ${ task ? `<input id=\"task-${ index }\" data-load=\"users.load_permission\" data-change=\"users.update_permission\" type=\"checkbox\">` : '' }\r\n        <label for=\"task-${ index + 1 }\" class=\"task task-${ index + 1 }\">${ index + 1 }</label>\r\n        <input placeholder=\"NIEUW\" data-index=\"${ index }\" data-input=\"users.update_task\" type=\"text\" value=\"${ task }\">\r\n      </div>`;\r\n\r\n      return memo;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  load_permission: (input) => {\r\n\r\n    if(\r\n    (input.id == 'add' && root.me.add_permission) ||\r\n    (input.id == 'archive' && root.me.archive_permission) ||\r\n    root.me.tasks[parseInt(input.id.replace('task-', ''), 10)]\r\n    ) input.setAttribute('checked', true);\r\n\r\n  },\r\n\r\n  update_permission: (input) => {\r\n\r\n    if(input.id == 'add') return root.send({ request: 'update_permission', add_permission: input.checked });\r\n\r\n    if(input.id == 'archive') return root.send({ request: 'update_permission', archive_permission: input.checked });\r\n\r\n    let tasks = users.memory[root.me.user].tasks.map((task, index) => {\r\n\r\n      if(index == parseInt(input.id.replace('task-', ''), 10)) return input.checked ? task : '';\r\n\r\n      return root.me.tasks[index] ? task : '';\r\n\r\n    });\r\n\r\n    tasks.pop();\r\n\r\n    root.send({ request: 'update_permission', tasks: tasks });\r\n\r\n  },\r\n\r\n  update_task: (element) => {\r\n\r\n   let index = element.dataset.index,\r\n       tasks = users.memory.users_admin.tasks.slice();\r\n\r\n    tasks[parseInt(element.dataset.index, 10)] = element.value;\r\n\r\n    let update = tasks.reduce((memo, task) => {\r\n\r\n      if(!task) return memo;\r\n\r\n      memo.push(String(task).toUpperCase());\r\n\r\n      return memo;\r\n\r\n    }, []);\r\n\r\n    update.push('');\r\n\r\n    root.send({ request: 'update_tasks', tasks: update }, (user) => {\r\n\r\n      if(tasks.length == update.length) return;\r\n      \r\n      let elem = document.querySelector('[data-load=\"users.load_permissions\"]');\r\n\r\n      users.load_permissions(elem);\r\n\r\n        let input = document.querySelector(`[data-index=\"${ index }\"]`)\r\n\r\n        input.focus();\r\n        \r\n        input.selectionStart = input.selectionEnd = input.value.length;\r\n\r\n    });\r\n\r\n  },\r\n\r\n  save_email: (input) => {\r\n\r\n    localStorage.setItem('remember_email', input.value);\r\n\r\n  },\r\n\r\n  load_email: (input) => {\r\n\r\n    input.value = localStorage.getItem('remember_email') || '';\r\n\r\n    input.focus();\r\n\r\n  },\r\n\r\n\r\n  list: (element) => {\r\n\r\n    if(!element) return;\r\n\r\n    element.innerHTML = ``;\r\n\r\n    root.labels.loading(element);\r\n\r\n    requestAnimationFrame(()=> {\r\n\r\n      let search = String(localStorage.getItem('search') || '').toLowerCase();\r\n\r\n      users.render(element, search);\r\n\r\n    });\r\n\r\n  },\r\n\r\n\r\n  render: (element, search, keys, iteration) => {\r\n\r\n    if(!element) return;\r\n\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    keys = keys || Object.keys(users.memory);\r\n\r\n    if(!keys.length) {\r\n\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        return element.dataset.title = '';\r\n\r\n    }\r\n\r\n    let user = users.memory[keys.shift()];\r\n\r\n    if(!user || user.archived ||\r\n       (search && String(user.name).toLowerCase().indexOf(search) == -1)\r\n     ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         users.render(element, search, keys, iteration);\r\n\r\n       });\r\n\r\n       return users.render(element, search, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      users.render(element, search, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'users.render_one';\r\n\r\n    elem.dataset.user = user.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  edit: (element, options) => {\r\n\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.user\r\n     };\r\n\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n  \r\n  archive: (element) => {\r\n\r\n    let user = users.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: user.key }, () => {\r\n\r\n      users.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n\r\n    let user = users.memory[element.dataset.user];\r\n\r\n    let tasks = users.memory[root.me.user].tasks.reduce((html, task, index) => {\r\n\r\n      if(task) html += `<div data-index=\"${ index }\" data-user=\"${ user.key }\" data-click=\"users.toggle_task\" class=\"small\">${ task }</div>`;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n\r\n    element.innerHTML = `\r\n      <div>\r\n        <input placeholder=\"Name\" data-property=\"name\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"text\" value=\"${ user.name || '' }\">\r\n      </div>\r\n      <div>\r\n        <input placeholder=\"example@email.com\" data-property=\"email\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"text\" value=\"${ user.email || '' }\">\r\n      </div>\r\n      <div>\r\n        <input placeholder=\"Password\" data-property=\"password\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"password\">\r\n      </div>\r\n      <div>\r\n        <select data-property=\"role\" value=\"${ user.role }\" data-user=\"${ user.key }\" data-change=\"users.edit\">\r\n          <option${ user.role == 'intern' ? ' selected' : '' } value=\"intern\">Intern</option>\r\n          <option${ user.role == 'driver' ? ' selected' : '' } value=\"driver\">Chauffeur</option>\r\n          <option${ user.role == 'admin' ? ' selected' : '' } value=\"admin\">Admin</option>\r\n        </select>\r\n      </div>\r\n      <div>\r\n        <button data-click=\"users.archive\" data-key=\"${ user.key }\">ARCHIVEER</button>\r\n      </div>\r\n    `;\r\n\r\n    if(!user.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  save_search: (element) => {\r\n\r\n\tlocalStorage.setItem('search', element.value);\r\n\r\n\tusers.updated = true;\r\n\r\n  }\r\n\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!users.updated) return setTimeout(updater, 300);\r\n\r\n  users.updated = false;\r\n\r\n  // updater();\r\n\r\n}());","const LANGS = ['nl', 'en'];\r\n\r\nlet index = LANGS.indexOf(localStorage.getItem('language'));\r\n\r\nif (index == -1) index = 0;\r\n\r\nlet labels = {\r\n    landing: ['Welkom', 'Landing'],\r\n    landing_text: ['Persoonlijke Training & Persoonlijke Coaching', 'Personal Training & Personal Coaching'],\r\n    landing_description: ['voor het programma Managers Vitality (voor een leef - werkbalans die de managementprestaties verbetert)', 'Program Managers Vitality (for a life - work balance that boosts management performance)'],\r\n    landing_feel_good: ['Goed in je vel zitten', 'Just feel great'],\r\n    landing_feel_good_description: ['Wil jij een gezondere levensstijl hebben, maar vind je het moeilijk om de juiste motivatie te vinden? Wil jij eindelijk eens echt een doel bereiken!!! Fitter zijn, afvallen, resultaat boeken!!. Dan ben je bij ons aan het juiste adres. We bieden zowel specifieke trainingsprogramma\\'s aan als programma\\'s met coaching. Daarbij gaat het vooral om het vinden van een goede werk - privé - balans. Zeker voor de drukke manager een geweldige mogelijkheid! Op deze site tref je meer informatie aan.', 'Do you want a healthier lifestyle, but do you find it difficult to find the right motivation? Do you finally really want to achieve a goal !!! Fitter, lose weight, book books !! Then you have come to the right place. We indicate specific training programs as programs with coaching. This mainly involves finding a good work - private balance. Especially for the busy manager a great opportunity! You will find more information on this site.'],\r\n    landing_share_page: ['Deel deze pagina', 'Share this page'],\r\n    landing_joris_merel: ['Joris Boon en Merel Witkamp', 'Joris Boon and Merel Witkamp'],\r\n    landing_joris_merel_description: [\"Mogen we ons even aan u voorstellen. Wij zijn Joris Boon en Merel Witkamp. We zijn beiden fanatieke sporttrainers waarbij we weten dat individuele training allereerst tot resultaat moet leiden bijvoorbeeld afvallen, vitaler of gewoon \\'je beter voelen\\'. Maar we weten ook dat training alleen vaak niet voldoende is. Vandaar dat we een uniek coachingprogramma hebben geïntroduceerd onder de noemer \\'Managers Vitality: for a work - life balance that boosts your management performance'. Het gaat dan om een programma om een betere werk - privé balans te vinden (ook in relatie tot fitness) alsmede omveel betere resultaten op het werk te behalen. Het focust zich op de '7th habit' van managementgoeroe Stephan Covey waar hij heeft over 'het scherp houden van de zaag'. Inmiddels hebben al vele managers zich voor dit programma ingeschreven.\", \"May we introduce ourselves to you, we are Joris Boon and Merel Witkamp We are both fanatical sports trainers where we know that individual training should lead to results first, for example losing weight, being more vital or just 'feeling better'. also that training alone is often not sufficient, which is why we have introduced a unique coaching program under the heading 'Managers Vitality: for a work - life balance that boosts your management performance' - a program for a better work - private life. To find a balance (also in relation to fitness) as well as to achieve much better results at work, it focuses on the '7th habit' of management guru Stephan Covey, who talks about 'keeping the saw sharp'. managers registered for this program.\"],\r\n    about_text: ['Mogen wij uw personal trainer of personal coach zijn?', 'Can we be your personal trainer or personal coach?'],\r\n    about_joris: [\"Onder andere samen met een collega een sportschool gehad, een sportschool waar ik overigens nog steeds met veel plezier training geef. Maar nu, na zoveel jaren les te hebben gegeven, merk ik ook waar mijn echte persoonlijke voorkeur ligt: personal training, trainen met kleine groepen en personal coaching. Ik merk daarbij dat kickboksen – een sport die ik al 27 jaar heb beoefend, en waar ik al 20 jaar les in geef – nu door grote groepen wordt gebruikt om zich vitaler te voelen, waarbij fysiek contact uiteraard vermeden wordt. Omdat ik dit vooral met ondernemers doe, heb ik de speciale vorm 'business boksen' bedacht: je lekker even op een bijzondere manier afreageren... heerlijk! Overigens gaat het niet alleen om business boksen, ook andere trainingsvormen bied ik als personal trainer aan. Het is juist de combinatie van verschillende vormen die de mensen zo aanspreekt.\", \"Together with a colleague I had a gym, a gym where I still enjoy training. But now, after having taught for so many years, I also notice my true personal preference: personal training, training with small groups and personal coaching. I notice that kick boxing - a sport that I have practiced for 27 years, and for which I have been teaching for 20 years - is now being used by large groups to feel more vital, whereby physical contact is naturally avoided. Because I mainly do this with entrepreneurs, I have come up with the special form of 'business boxing': you can have a nice chat in a special way ... delicious! Incidentally, it is not only about business boxing, other forms of training I offer as a personal trainer. It is precisely the combination of different forms that appeal to people in this way.\"],\r\n    about_merel: [\"Ook mijn leven is door sport bepaald. Ik ben begonnen met een dansopleiding en vanuit de dans ben ik overgestapt naar Yoga en vandaar uit ben ik met heel veel trainingsvormen bezig geweest. Omdat professionaliteit bij mij hoog in het vaandel staat, heb ik waar mogelijk diploma\\'s behaald. Naast de CIOS-opleiding heb ik diploma\\'s in Personal Hormonal Profiling (alles wat te maken heeft met hormonen en hoe die beïnvloed kunnen worden door voeding en training), Fitness diploma A en B, diploma Perfect Pilates en het diploma in Oncologische Revalidatie. Daarnaast ben ik me gaan verdiepen in personal coaching om beter om mensen te kunnen coachen om beter om te kunnen gaan met de balans werk - privé. Veel drukke managers weten hoe belangrijk fysieke training is om dagelijks fit te kunnen blijven. Maar er is meer en met ons speciale coachingprogramma zult u al snel merken hoeveel voordeel u hiervan kunt hebben. Het belangrijkste voor mij is mensen te motiveren om in beweging te blijven.\", \"My life has been determined by sport, I started a dance education and from dance I switched to Yoga and from there I have been busy with a lot of training forms. Because professionalism is of paramount importance to me, I have, wherever possible, I have diplomas in Personal Hormonal Profiling (everything that has to do with hormones and how they can be influenced by nutrition and training), Fitness diploma A and B, diploma Perfect Pilates. and the diploma in Oncological Rehabilitation, I also went into personal coaching in order to better coach people in order to better deal with the work-life balance.Many busy managers know how important physical training is to be able to get fit every day But there is more and with our special coaching program you will soon see how much benefit you can have of this, the most important thing for me is to motivate people to keep moving.\"],\r\n    add: ['Toevoegen', 'Add'],\r\n    invite: ['Uitnodigen', 'Invite'],\r\n    about: ['Over ons', 'About'],\r\n    sign_in: ['Inloggen', 'Sign in'],\r\n    sign_in_input: [value('Inloggen', value('Sign in'))],\r\n    sign_out: ['Uitloggen', 'Sign out'],\r\n    courses: ['Cursussen', 'Courses'],\r\n    invitations: ['Uitnodigingen', 'Invitations'],\r\n    stats: ['Statistieken', 'Statistics'],\r\n    no_results: [\r\n        title('Geen resultaten'),\r\n        title('No results')\r\n    ],\r\n    loading: [\r\n        title('Laden...'),\r\n        title('Loading...')\r\n    ],\r\n    archive: ['Archiveer', 'Archive'],\r\n    view: ['Bekijk', 'View'],\r\n    view_mode: ['VIEW MODE', 'VIEW MODE'],\r\n    search: ['ZOEKEN', 'SEARCH'],\r\n    managers: ['MANAGERS', 'MANAGERS'],\r\n    edit: ['Aanpassen', 'Edit'],\r\n    stats_short: ['Stats', 'Stats'],\r\n    copy: ['Kopi&#xEB;ren', 'Copy'],\r\n    viewed: ['Bekeken:', 'Viewed:'],\r\n    published: ['Gepubliceerd', 'Published'],\r\n    unpublished: ['Niet Gepubliceerd', 'Unpublished'],\r\n    password: ['WACHTWOORD', 'PASSWORD'],\r\n    edit_password: ['WACHTWOORD WIJZIGEN', 'CHANGE PASSWORD'],\r\n    old_password: [placeholder('oud wachtwoord'), placeholder('old password')],\r\n    new_password: [placeholder('nieuw wachtwoord'), placeholder('new password')],\r\n    placeholder_search: [placeholder('Zoeken'), placeholder('Search')],\r\n    save_profile: [value('Sla profiel op'), value('Save profile')],\r\n    clients: ['Klanten', 'Clients'],\r\n    app_settings: ['App instellingen', 'App settings'],\r\n    name: [placeholder('Naam'), placeholder('Name')],\r\n    password: [placeholder('Wachtwoord'), placeholder('Password')],\r\n    send_invite: ['Verstuur uitnodiging', 'Send invite']\r\n};\r\n\r\nfor (let n in labels) {\r\n\r\n    if (!labels.hasOwnProperty(n)) continue;\r\n\r\n    if (labels[n] == false) labels[n] = n;\r\n\r\n    else labels[n] = labels[n][index];\r\n\r\n}\r\n\r\nmodule.exports = labels;\r\n\r\nfunction placeholder(label) {\r\n\r\n    return (el) => el.setAttribute('placeholder', label);\r\n\r\n}\r\n\r\nfunction title(label) {\r\n\r\n    return (el) => el.setAttribute('data-title', label);\r\n\r\n}\r\n\r\nfunction value(label) {\r\n\r\n    return (el) => { el.value = label; };\r\n\r\n}","let modal = module.exports = {\r\n\r\n  load: (element) => {\r\n\r\n\troot.modal_element = element;\r\n\r\n  },\r\n\r\n  open: (element, load) => {\r\n\r\n\tlet modal = root.modal_element;\r\n\r\n\tif(modal.dataset.key) modal.dataset.key = element.dataset.key;\r\n\r\n\t\r\n\r\n\tif(!document.body.classList.contains('modal-open'))\r\n\t\troot.main.style.transform = `translateY(-${ window.scrollY || document.body.scrollTop }px)`;\r\n\r\n\tscroll(0,0);\r\n\r\n\tmodal.dataset.load = element.dataset.modal;\r\n\r\n\trequestAnimationFrame(()=>document.body.classList.add('modal-open'))\r\n\r\n  },\r\n\r\n  close: (element) => {\r\n\r\n\tlet scrolltop = parseInt(root.main.style.transform.replace('translateY(', ''), 10);\r\n\r\n\tdocument.body.classList.remove('modal-open');\r\n\r\n\troot.main.removeAttribute('style');\r\n\r\n\troot.modal_element.load = \"modal.empty\";\r\n\r\n\twindow.scroll(0, -1 * scrolltop);\r\n\r\n  },\r\n\r\n  empty: ''\r\n\r\n};","let prefill = module.exports = {\r\n\r\n  memory: {},\r\n\r\n  load: (element) => {\r\n\r\n    element.dataset.input = 'prefill.edit';\r\n\r\n    if(!element.dataset.key) return;\r\n\r\n    let key = element.dataset.key,\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n\r\n    if(!item[element.dataset.property]) return;\r\n\r\n    let property_key = item[element.dataset.property],\r\n        property_collection = property_key.split('_')[0];\r\n\r\n    if(!root[property_collection]) return;\r\n\r\n    let property = root[property_collection].memory[property_key];\r\n\r\n    element.value = property.name;\r\n\r\n  },\r\n\r\n  select: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n    \r\n    let input = element.parentElement.parentElement.querySelector('input');\r\n\r\n    input.value = item.name;\r\n\r\n    let input_collection = input.dataset.key.split('_')[0];\r\n\r\n    element.parentElement.innerHTML = '';\r\n\r\n    let request = {\r\n       request: 'edit',\r\n       key: input.dataset.key\r\n     };\r\n\r\n     request[input.dataset.property] = item.key;\r\n\r\n     root.send(request);\r\n\r\n  },\r\n\r\n  submit: (element) => {\r\n\r\n    let selection = element.querySelector('li');\r\n\r\n    if(selection) prefill.select(selection);\r\n\r\n  },\r\n\r\n  edit: function search(element, keys) {\r\n\r\n    let ul = element.parentElement.querySelector('ul');\r\n\r\n    if(!keys) ul.innerHTML = '';\r\n\r\n    keys = keys || Object.keys(root[element.dataset.collection].memory);\r\n\r\n    if(prefill.loop && prefill.loop > keys.length) return; // new loop started, this one stops\r\n\r\n    prefill.loop = keys.length - 1;\r\n\r\n    if(!keys.length || !element.value) return; // done looping\r\n\r\n    let key = keys.shift(),\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n\r\n    if(String(item.name || '').toLowerCase().indexOf(String(element.value).toLowerCase()) == -1)\r\n      return search(element, keys);\r\n\r\n    requestAnimationFrame(()=>search(element, keys));\r\n\r\n    ul.innerHTML += `<li data-click=\"prefill.select\" data-key=\"${ item.key }\">${ item.name }</li>`\r\n\r\n  }\r\n\r\n};","let updates = [];\r\n\r\nmodule.exports = init;\r\n\r\nfunction init() {\r\n\r\n  bind();\r\n\r\n  document.documentElement.addEventListener('click', listener);\r\n\r\n  document.documentElement.addEventListener('change', listener);\r\n\r\n  document.documentElement.addEventListener('input', listener);\r\n\r\n  document.documentElement.addEventListener('submit', listener);\r\n\r\n}\r\n\r\nfunction listener(e, element) {\r\n\r\n  element = element || e.target;\r\n\r\n  if(e.type.toLowerCase() == 'submit') e.preventDefault();\r\n\r\n  if (!element.dataset || !element.dataset[e.type]) {\r\n\r\n    if(!element.parentElement) return;\r\n\r\n    return listener(e, element.parentElement);\r\n\r\n  }\r\n\r\n  let target = root;\r\n\r\n  for (let i = 0, parts = element.dataset[e.type].split('.'); i < parts.length; i++) {\r\n\r\n    if (!target) return console.error(element.dataset[e.type] || e.type, 'does not exist');\r\n\r\n    target = target[parts[i]];\r\n\r\n  }\r\n\r\n  if(typeof target == 'string') return element.innerHTML = target;\r\n  \r\n  if(typeof target != 'function') return console.error(element.dataset[e.type] || e.type, 'does not exist');\r\n\r\n  target(element);\r\n\r\n}\r\n\r\nfunction bind() {\r\n\r\n  (function loop(){\r\n\r\n    if(!updates.length) return requestAnimationFrame(loop);\r\n\r\n    let elements = updates.splice(0, updates.length);\r\n\r\n    for(let i = 0; i < elements.length; i++) {\r\n\r\n      [].map.call(elements[i].querySelectorAll('[data-bind], [data-load]'), bind_one);\r\n\r\n    }\r\n\r\n    requestAnimationFrame(loop);\r\n\r\n  }());\r\n\r\n  new MutationObserver(observer).observe(\r\n    document.documentElement,\r\n    {\r\n      attributes: true,\r\n      subtree: true,\r\n      childList: true,\r\n      characterData: true\r\n    }\r\n  );\r\n\r\n}\r\n\r\nfunction observer(mutations) {\r\n\r\n  for(let i = 0; i < mutations.length; i++) {\r\n\r\n    if(mutations[i].type == 'attributes') {\r\n\r\n       if(mutations[i].attributeName == 'data-load') load(mutations[i].target);\r\n\r\n       continue;\r\n\r\n    }\r\n\r\n    if(mutations[i].type != 'childList') return;\r\n\r\n    if(updates.indexOf(mutations[i].target) == -1) updates.push(mutations[i].target);\r\n\r\n  }\r\n\r\n}\r\n\r\nfunction bind_one(element) {\r\n\r\n  let d = element.dataset,\r\n      key = d.bind == 'me' ? root.config.user : d.bind,\r\n      collection;\r\n\r\n  if(d.load) return load(element);\r\n\r\n  if(!key) return collection.error(d);\r\n\r\n  collection = root[key.split('_').slice(0, -1).join('_')];\r\n\r\n  if (!collection || !collection.memory[key]) return console.error(key);\r\n\r\n  let prop = d.value || d.text || d.bg || d.html,\r\n      obj = collection.memory[key];\r\n\r\n  if(d.value) element.value = obj[d.value] || '';\r\n\r\n  if(d.html) element.innerHTML = obj[d.html] || '';\r\n\r\n  if(d.text) element.innerHTML = (obj[d.text] || '').replace(/(>|<)/g, escape);\r\n\r\n  if(d.bg) element.style.backgroundImage = `url(\"${ obj[d.bg] || '' }`;\r\n\r\n}\r\n\r\nfunction load(element) {\r\n\r\n  let target = root;\r\n\r\n  for (let i = 0, parts = element.dataset.load.split('.'); i < parts.length; i++) {\r\n\r\n    target = target[parts[i]];\r\n\r\n    if (typeof target == 'undefined') {\r\n\r\n      if(element.dataset.load.indexOf('.html') != -1) return load_file(element);\r\n\r\n      return console.error(element.dataset.load, 'does not exist');\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if(element.dataset.load.substring(0, 11) == 'labels.user') {\r\n\r\n    let user = root.users.memory[root.config.user],\r\n        str = element.dataset.load;\r\n    \r\n    str = str.substring(12);\r\n\r\n    if(user && typeof(str) == 'string' && user[str]) return element.value = user[str];\r\n\r\n  }\r\n\r\n  if(typeof target == 'string') return element.innerHTML = target;\r\n\r\n  if(typeof target == 'function') return target(element);\r\n\r\n}\r\n\r\nfunction load_file(element) {\r\n\r\n  let xhr = new XMLHttpRequest();\r\n\r\n  xhr.open('GET', `/${ element.dataset.load }`, true);\r\n\r\n  xhr.onreadystatechange = function(e) {\r\n\r\n    if (this.readyState != 4 || this.status != 200) return;\r\n\r\n    root.templates = root.templates || {};\r\n\r\n    let target = root.templates;\r\n\r\n    for (let i = 0, parts = element.dataset.load.split('.'); i + 1 < parts.length; i++) {\r\n\r\n      if (!target) return;\r\n\r\n      target[parts[i]] = target[parts[i]] || {};\r\n\r\n      target = target[parts[i]];\r\n\r\n    }\r\n\r\n    element.innerHTML = target.html = this.responseText;\r\n\r\n  }\r\n\r\n  xhr.send();\r\n\r\n\r\n}\r\n\r\nfunction escape(match) {\r\n\r\n  return match == '>' ? '&gt;' : '&lt;';\r\n\r\n}","if (!Object.assign) {\r\n  Object.defineProperty(Object, 'assign', {\r\n    enumerable: false,\r\n    configurable: true,\r\n    writable: true,\r\n    value: function(target) {\r\n      'use strict';\r\n      if (target === undefined || target === null) {\r\n        throw new TypeError('Cannot convert first argument to object');\r\n      }\r\n\r\n      var to = Object(target);\r\n      for (var i = 1; i < arguments.length; i++) {\r\n        var nextSource = arguments[i];\r\n        if (nextSource === undefined || nextSource === null) {\r\n          continue;\r\n        }\r\n        nextSource = Object(nextSource);\r\n\r\n        var keysArray = Object.keys(Object(nextSource));\r\n        for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n          var nextKey = keysArray[nextIndex];\r\n          var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\r\n          if (desc !== undefined && desc.enumerable) {\r\n            to[nextKey] = nextSource[nextKey];\r\n          }\r\n        }\r\n      }\r\n      return to;\r\n    }\r\n  });\r\n}\r\n\r\n(function () {\r\n\r\n  if (typeof window.Element === \"undefined\" || \"classList\" in document.documentElement) return;\r\n\r\n  var prototype = Array.prototype,\r\n      push = prototype.push,\r\n      splice = prototype.splice,\r\n      join = prototype.join;\r\n\r\n  function DOMTokenList(el) {\r\n    this.el = el;\r\n    // The className needs to be trimmed and split on whitespace\r\n    // to retrieve a list of classes.\r\n    var classes = el.className.replace(/^\\s+|\\s+$/g,'').split(/\\s+/);\r\n    for (var i = 0; i < classes.length; i++) {\r\n      push.call(this, classes[i]);\r\n    }\r\n  };\r\n\r\n  DOMTokenList.prototype = {\r\n    add: function(token) {\r\n      if(this.contains(token)) return;\r\n      push.call(this, token);\r\n      this.el.className = this.toString();\r\n    },\r\n    contains: function(token) {\r\n      return this.el.className.indexOf(token) != -1;\r\n    },\r\n    item: function(index) {\r\n      return this[index] || null;\r\n    },\r\n    remove: function(token) {\r\n      if (!this.contains(token)) return;\r\n      for (var i = 0; i < this.length; i++) {\r\n        if (this[i] == token) break;\r\n      }\r\n      splice.call(this, i, 1);\r\n      this.el.className = this.toString();\r\n    },\r\n    toString: function() {\r\n      return join.call(this, ' ');\r\n    },\r\n    toggle: function(token) {\r\n      if (!this.contains(token)) {\r\n        this.add(token);\r\n      } else {\r\n        this.remove(token);\r\n      }\r\n\r\n      return this.contains(token);\r\n    }\r\n  };\r\n\r\n  window.DOMTokenList = DOMTokenList;\r\n\r\n  function defineElementGetter (obj, prop, getter) {\r\n      if (Object.defineProperty) {\r\n          Object.defineProperty(obj, prop,{\r\n              get : getter\r\n          });\r\n      } else {\r\n          obj.__defineGetter__(prop, getter);\r\n      }\r\n  }\r\n\r\n  defineElementGetter(Element.prototype, 'classList', function () {\r\n    return new DOMTokenList(this);\r\n  });\r\n\r\n})();\r\n\r\n","require('./polyfill.js');\r\n\r\nconst DEV_MODE = true;\r\n\r\nwindow.root = {\r\n\r\n  config: init(),\r\n\r\n  incoming: incoming,\r\n  \r\n  templates: require('./collections/templates.js'),\r\n  \r\n  courses: require('./collections/courses.js'),\r\n  \r\n  blocks: require('./collections/blocks.js'),\r\n\r\n  sessions: require('./collections/sessions.js'),\r\n\r\n  labels: require('./components/labels.js'),\r\n  \r\n  modal: require('./components/modal.js'),\r\n\r\n  editor: require('./components/editor.js'),\r\n  \r\n  prefill: require('./components/prefill.js'),\r\n\r\n  tickets: require('./collections/tickets.js'),\r\n\r\n  users: require('./collections/users.js')\r\n\r\n};\r\n\r\nfunction init(){\r\n\r\n  require('./listeners.js')();\r\n\r\n  requestAnimationFrame(()=> {\r\n\r\n\troot.sessions.load();\r\n\r\n\tcreate_websocket();\r\n\r\n  });\r\n\r\n  return {\r\n    user: '',\r\n    session: '',\r\n    error: error,\r\n    query: location.search.slice(1).split('&').reduce((memo, pair) => {\r\n\r\n\t  let p = pair.split('=');\r\n\r\n\t  memo[p[0]] = p[1];\r\n\r\n\t  return memo;\r\n\r\n\t}, {})\r\n  };\r\n\r\n}\r\n\r\nfunction create_websocket() {\r\n\r\n  let query = '',\r\n      callbacks = [];\r\n\r\n  for(let i in localStorage)\r\n    query += (query ? '&' : '?') + encodeURIComponent(i) + '=' +  encodeURIComponent(localStorage.getItem(i));\r\n\r\n  new WebSocket(DEV_MODE ?\r\n    `ws://localhost:443/${ query }` :\r\n    `wss://vitalityone.fearless-apps.com/${ query }`\r\n  ).addEventListener('message', function listener(e){\r\n\r\n    let ws = e.target;\r\n\r\n    root.send = Send(ws, callbacks);\r\n\r\n    incoming(JSON.parse(e.data), callbacks);\r\n\r\n    ws.removeEventListener('message', listener);\r\n\r\n    ws.addEventListener('message', (e) => incoming(JSON.parse(e.data), callbacks));\r\n\r\n  });\r\n\r\n}\r\n\r\nfunction error(element) {\r\n\r\n  if(element && element.dataset) return console.error(element.dataset.message);\r\n  \r\n  console.error(arguments);\r\n\r\n}\r\n\r\nfunction Send(ws, callbacks) {\r\n\r\n  return function send(data, callback) {\r\n\r\n    let cb = `cb_${ Math.floor(Math.random() * 10000) }`;\r\n\r\n    data.callback = cb;\r\n\r\n    if(callback) callbacks[cb] = callback;\r\n\r\n    ws.send(JSON.stringify(data));\r\n\r\n  };\r\n\r\n}\r\n\r\nfunction incoming(message, callbacks){\r\n\r\n  if(message instanceof Array) {\r\n\r\n  \tfor(let m in message) merge(message[m]);\r\n\r\n\treturn;\r\n\r\n  }\r\n\r\n  merge(message);\r\n  \r\n  if(message.error) notify(message);\r\n\r\n  if(message.redirect) location.href = message.redirect;\r\n\r\n  if(message.callback && callbacks[message.callback]) {\r\n\r\n  \tcallbacks[message.callback](message);\r\n\r\n  \tdelete callbacks[message.callback];\r\n  \t\r\n  }\r\n\r\n  if(typeof message.token == 'undefined') return;\r\n\r\n  root.me = Object.assign(root.me || {}, message);\r\n\r\n  document.body.classList[message.token ? 'add' : 'remove']('authenticated');\r\n\r\n  if(!message.token) root.sessions.url('/');\r\n\r\n  localStorage.setItem('authenticated', message.token || '');\r\n\r\n  root.sessions.load_page(null, { prevent_url: true });\r\n  \r\n}\r\n\r\nfunction notify(message) {\r\n\r\n  \tdocument.body.classList.add('notified');\r\n\r\n\tdocument.querySelector('#notification-message').innerHTML = message.error;\r\n\t\r\n}\r\n\r\nfunction merge(message){\r\n\r\n  if(!message.key) return;\r\n\r\n  let collection = message.key.split('_').slice(0, -1).join('_');\r\n\r\n  if(!root[collection]) return console.log(`collection <${ collection }> not found`);\r\n\r\n  if(!root[collection].memory[message.key]) {\r\n\r\n  \troot[collection].memory[message.key] = message;\r\n\r\n  \treturn root[collection].updated = true;\r\n\r\n  }\r\n  \r\n  root[collection].memory[message.key] = Object.assign(root[collection].memory[message.key] || {}, message);\r\n  \r\n}","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}