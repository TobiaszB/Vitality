{"version":3,"sources":["source/scripts/collections/blocks.js","source/scripts/collections/courses.js","source/scripts/collections/sessions.js","source/scripts/collections/templates.js","source/scripts/collections/tickets.js","source/scripts/collections/users.js","source/scripts/components/editor.js","source/scripts/components/labels.js","source/scripts/components/modal.js","source/scripts/components/prefill.js","source/scripts/listeners.js","source/scripts/polyfill.js","source/scripts/root.js","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":["blocks","module","exports","memory","load","element","innerHTML","Object","keys","reduce","html","key","render_one","dataset","addEventListener","e","drag_x","clientX","drag_y","clientY","drag_block","console","log","document","body","style","right","top","courses","add","root","send","request","view_mode","mode","main","updated","save_search","search_query","String","value","toLowerCase","edit","options","course","v","property","callback","list","querySelector","history","state","load_course","labels","loading","render","iteration","Math","floor","random","length","children","no_results","message","search","shift","archived","name","indexOf","manager_filter","admin","requestAnimationFrame","elem","createElement","appendChild","archive","toggle_manager","filter","index","classList","toggle","splice","push","load_managers","users","user","role","avatar","JSON","stringify","thumbnail","course_nav","focus","format","date","Date","months","getDate","getMonth","getFullYear","getHours","getMinutes","published_at","view","sessions","url","page","load_page","prevent_url","invite","stats","updater","setTimeout","default_page","load_login","me","session","sign_in","email","parentElement","password","sign_out","check_passwords","inputs","querySelectorAll","alert","old_password","res","localStorage","getItem","forEach","c","remove","window","scrollTo","modal","close","operation","replace","decode","location","pathname","title","encode","parts","split","i","change_language","setItem","language","reload","highlight_lang","contains","format_date","format_time","start","hide_notification","tickets","ticket","toggle_course","load_courses","ticket_nav","load_permissions","render_tasks","tasks","memo","task","load_permission","input","id","add_permission","archive_permission","parseInt","setAttribute","update_permission","checked","map","pop","update_task","users_admin","slice","update","toUpperCase","selectionStart","selectionEnd","save_email","load_email","editor","LANGS","landing","introduction_text","introduction_description","about_text","about","sign_in_input","profile","invitations","managers","stats_short","copy","viewed","published","unpublished","edit_password","placeholder","new_password","placeholder_search","n","hasOwnProperty","label","el","modal_element","open","transform","scrollY","scrollTop","scroll","scrolltop","removeAttribute","empty","prefill","collection","item","property_key","property_collection","select","input_collection","submit","selection","ul","loop","updates","init","bind","documentElement","listener","target","type","preventDefault","error","elements","call","bind_one","MutationObserver","observer","observe","attributes","subtree","childList","characterData","mutations","attributeName","d","config","join","prop","text","bg","obj","escape","backgroundImage","load_file","substring","str","xhr","XMLHttpRequest","onreadystatechange","readyState","status","templates","responseText","match","assign","defineProperty","enumerable","configurable","writable","undefined","TypeError","to","arguments","nextSource","keysArray","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","Element","prototype","Array","DOMTokenList","classes","className","token","toString","defineElementGetter","getter","get","__defineGetter__","require","DEV_MODE","incoming","create_websocket","query","pair","p","callbacks","encodeURIComponent","WebSocket","ws","Send","parse","data","removeEventListener","cb","m","merge","notify","redirect","href","MozWebSocket","br","brunch","ar","disabled","_ar","cacheBuster","round","now","browser","navigator","userAgent","forceRepaint","reloaders","stylesheet","link","val","getAttribute","offsetHeight","javascript","scripts","textScripts","script","srcScripts","src","loaded","all","onLoad","eval","newScript","async","onload","head","port","host","server","hostname","connect","connection","onmessage","event","reloader","onerror","onclose"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,SAASC,OAAOC,OAAP,GAAiB;;AAE5BC,UAAQ,EAFoB;;AAI5BC,QAAM,cAACC,OAAD,EAAa;;AAEjBA,YAAQC,SAAR,GAAoBC,OAAOC,IAAP,CAAYR,OAAOG,MAAnB,EAA2BM,MAA3B,CAAkC,UAACC,IAAD,EAAOC,GAAP;AAAA,aAAmBD,IAAnB,kCAC/BC,GAD+B;AAAA,KAAlC,EACqD,EADrD,CAApB;AAGD,GAT2B;;AAW5BC,cAAY,oBAACP,OAAD,EAAa;;AAEvBA,YAAQC,SAAR,QAAwBD,QAAQQ,OAAR,CAAgBF,GAAxC;;AAEAN,YAAQS,gBAAR,CAAyB,WAAzB,EAAsC,UAACC,CAAD,EAAK;;AAEzCf,aAAOgB,MAAP,GAAgBD,EAAEE,OAAlB;;AAEAjB,aAAOkB,MAAP,GAAgBH,EAAEI,OAAlB;;AAEAnB,aAAOoB,UAAP,GAAoBf,OAApB;AACNgB,cAAQC,GAAR,CAAYjB,OAAZ;AACK,KARD;AAUD;;AAzB2B,CAA9B;;AA6BAkB,SAASC,IAAT,CAAcV,gBAAd,CAA+B,WAA/B,EAA4C,UAACC,CAAD,EAAK;;AAE/C,MAAG,CAACf,OAAOoB,UAAX,EAAuB,OAAOL,CAAP;;AAEvBf,SAAOoB,UAAP,CAAkBK,KAAlB,CAAwBC,KAAxB,GAAoC1B,OAAOgB,MAAP,GAAgBD,EAAEE,OAAtD;;AAEAjB,SAAOoB,UAAP,CAAkBK,KAAlB,CAAwBE,GAAxB,GAAkCZ,EAAEI,OAAF,GAAYnB,OAAOkB,MAArD;AAED,CARD;;AAUAK,SAASC,IAAT,CAAcV,gBAAd,CAA+B,SAA/B,EAA0C,UAACC,CAAD;AAAA,SAAKf,OAAOoB,UAAP,GAAoB,IAAzB;AAAA,CAA1C;;;;;;ACvCA,IAAIQ,UAAU3B,OAAOC,OAAP,GAAiB;;AAE7B;AACA;AACAC,YAAQ,EAJqB;;AAM7B;AACA0B,SAAK,aAACxB,OAAD,EAAa;;AAEhB;AACAyB,aAAKC,IAAL,CAAU,EAAEC,SAAS,YAAX,EAAV;AAED,KAZ4B;;AAc7B;AACAC,eAAW,mBAAC5B,OAAD,EAAa;;AAEtBuB,gBAAQM,IAAR,GAAe7B,QAAQQ,OAAR,CAAgBqB,IAA/B;;AAEA;AACAJ,aAAKK,IAAL,CAAUtB,OAAV,CAAkBqB,IAAlB,GAAyB7B,QAAQQ,OAAR,CAAgBqB,IAAzC;;AAEA;AACHN,gBAAQQ,OAAR,GAAkB,IAAlB;AAEE,KAzB4B;;AA2B7B;AACAC,iBAAa,qBAAChC,OAAD,EAAa;;AAExB;AACHuB,gBAAQU,YAAR,GAAuBC,OAAOlC,QAAQmC,KAAR,IAAiB,EAAxB,EAA4BC,WAA5B,EAAvB;;AAEG;AACHb,gBAAQQ,OAAR,GAAkB,IAAlB;AAEE,KApC4B;;AAsC7B;AACAM,UAAM,cAACrC,OAAD,EAAUsC,OAAV,EAAsB;;AAE1B;AACA,YAAIX,UAAU;AACXA,qBAAS,MADE;AAEXrB,iBAAKN,QAAQQ,OAAR,CAAgB+B;AAFV,SAAd;;AAKC;AACA;AACA;AACA,YAAIC,IAAIF,UAAUA,QAAQH,KAAlB,GAA0BnC,QAAQmC,KAA1C;;AAEAR,gBAAQ3B,QAAQQ,OAAR,CAAgBiC,QAAxB,IAAoCD,CAApC;;AAEA;AACA;AACAf,aAAKC,IAAL,CAAUC,OAAV,EAAmBW,UAAUA,QAAQI,QAAlB,GAA6B,IAAhD;AAEF,KA1D4B;;AA4D7BC,UAAM,cAAC3C,OAAD,EAAa;;AAEjB;AACA;AACA,YAAG,CAACA,OAAJ,EAAaA,UAAUkB,SAAS0B,aAAT,CAAuB,4BAAvB,CAAV;;AAEb;AACA,YAAG,CAAC5C,OAAJ,EAAa;;AAEb,YAAG6C,QAAQC,KAAR,CAAcP,MAAjB,EAAyB,OAAOhB,QAAQwB,WAAR,CAAoB/C,OAApB,CAAP;;AAEzB;AACAA,gBAAQC,SAAR;;AAEA;AACAwB,aAAKuB,MAAL,CAAYC,OAAZ,CAAoBjD,OAApB;;AAEA;AACAuB,gBAAQ2B,MAAR,CAAelD,OAAf;AAED,KAhF4B;;AAkF7B+C,iBAAa,qBAAC/C,OAAD,EAAa;;AAExBA,gBAAQC,SAAR,yDAAyE4C,QAAQC,KAAR,CAAcP,MAAvF;AAED,KAtF4B;;AAyF7BW,YAAQ,gBAAClD,OAAD,EAAUG,IAAV,EAAgBgD,SAAhB,EAA8B;;AAEpC;AACA,YAAG,CAACnD,OAAJ,EAAa;;AAEb;AACA;AACA;AACA;AACA,YAAG,CAACmD,SAAJ,EAAeA,YAAYnD,QAAQQ,OAAR,CAAgB2C,SAAhB,GAA4B,MAAMC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,IAA3B,CAA9C;;AAEf;AACA;AACA;AACA;AACA,YAAGtD,QAAQQ,OAAR,CAAgB2C,SAAhB,IAA6BA,SAAhC,EAA2C;;AAE3C;AACA,YAAG,CAAChD,IAAJ,EAAUA,OAAOD,OAAOC,IAAP,CAAYoB,QAAQzB,MAApB,CAAP;;AAEV;AACA,YAAG,CAACK,KAAKoD,MAAT,EAAiB;;AAEb;AACA;AACA,gBAAG,CAACvD,QAAQwD,QAAR,CAAiBD,MAArB,EAA6B,OAAO9B,KAAKuB,MAAL,CAAYS,UAAZ,CAAuBzD,OAAvB,CAAP;;AAE7B;AACA,mBAAOA,QAAQQ,OAAR,CAAgBkD,OAAhB,GAA0B,EAAjC;AAEH;;AAED,YAAIC,SAASpC,QAAQU,YAArB;AAAA,YAAmC;AAC/BM,iBAAShB,QAAQzB,MAAR,CAAeK,KAAKyD,KAAL,EAAf,CADb;;AAGA,YAAG,CAACrB,MAAD,IAAWA,OAAOsB,QAAlB,IACAF,UAAUzB,OAAOK,OAAOuB,IAAd,EAAoB1B,WAApB,GAAkC2B,OAAlC,CAA0CJ,MAA1C,KAAqD,CAAC,CADhE,IAEApC,QAAQyC,cAAR,CAAuBT,MAAvB,IAAiChC,QAAQyC,cAAR,CAAuBD,OAAvB,CAA+BxB,OAAO0B,KAAtC,KAAgD,CAAC,CAFrF,EAGE;;AAEC,gBAAG9D,KAAKoD,MAAL,GAAc,GAAd,IAAqB,CAAxB,EAA2B,OAAOW,sBAAsB,YAAK;;AAE3D3C,wBAAQ2B,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B;AAED,aAJiC,CAAP;;AAM3B,mBAAO5B,QAAQ2B,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B,CAAP;AAED;;AAEDe,8BAAsB,YAAK;;AAE1B3C,oBAAQ2B,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B;AAED,SAJA;;AAMD,YAAIgB,OAAOjD,SAASkD,aAAT,CAAuB,KAAvB,CAAX;;AAEAD,aAAK3D,OAAL,CAAaT,IAAb,GAAoB,oBAApB;;AAEAoE,aAAK3D,OAAL,CAAa+B,MAAb,GAAsBA,OAAOjC,GAA7B;;AAEAN,gBAAQqE,WAAR,CAAoBF,IAApB;AAED,KAzJ4B;;AA2J7BG,aAAS,iBAACtE,OAAD,EAAa;;AAEpB,YAAIuC,SAAShB,QAAQzB,MAAR,CAAeE,QAAQQ,OAAR,CAAgBF,GAA/B,CAAb;;AAEAmB,aAAKC,IAAL,CAAU,EAAEC,SAAS,SAAX,EAAsBrB,KAAKiC,OAAOjC,GAAlC,EAAV,EAAmD,YAAM;;AAEvD;AACAiB,oBAAQQ,OAAR,GAAkB,IAAlB;AAED,SALD;AAOD,KAtK4B;;AAwK7BiC,oBAAgB,EAxKa;;AA0K7BO,oBAAgB,wBAACvE,OAAD,EAAa;;AAE3B,YAAIM,MAAMN,QAAQQ,OAAR,CAAgBF,GAA1B;AAAA,YACIkE,SAASjD,QAAQyC,cADrB;AAAA,YAEIS,QAAQD,OAAOT,OAAP,CAAezD,GAAf,CAFZ;;AAIAN,gBAAQ0E,SAAR,CAAkBC,MAAlB,CAAyB,QAAzB;;AAEA,YAAGF,QAAQ,CAAC,CAAZ,EAAeD,OAAOI,MAAP,CAAcH,KAAd,EAAqB,CAArB,EAAf,KAEKD,OAAOK,IAAP,CAAYvE,GAAZ;;AAELiB,gBAAQQ,OAAR,GAAkB,IAAlB;AAED,KAxL4B;;AA0L7B+C,mBAAe,uBAAC9E,OAAD,EAAa;;AAE1BA,gBAAQC,SAAR,GAAoBC,OAAOC,IAAP,CAAYsB,KAAKsD,KAAL,CAAWjF,MAAvB,EAA+BM,MAA/B,CAAsC,UAACC,IAAD,EAAOC,GAAP,EAAe;;AAEvE,gBAAI0E,OAAOvD,KAAKsD,KAAL,CAAWjF,MAAX,CAAkBQ,GAAlB,CAAX;;AAEA,gBAAG0E,KAAKC,IAAL,IAAa,OAAhB,EAAyB5E,gEAA+D2E,KAAK1E,GAApE,8BACV0E,KAAKE,MADK,kDAEUF,KAAK1E,GAFf;;AAKzB,mBAAOD,IAAP;AAED,SAXmB,EAWjB,EAXiB,CAApB;AAaD,KAzM4B;;AA2M7BE,gBAAY,oBAACP,OAAD,EAAa;;AAEvB,YAAIuC,SAAShB,QAAQzB,MAAR,CAAeE,QAAQQ,OAAR,CAAgB+B,MAA/B,CAAb;;AAEAvC,gBAAQQ,OAAR,CAAgBF,GAAhB,GAAsBN,QAAQQ,OAAR,CAAgB+B,MAAtC;;AAEAvC,gBAAQC,SAAR,GAAoBsB,QAAQM,IAAR,IAAgB,OAAhB,4EAC6CU,OAAOjC,GADpD,uDAC2GiC,OAAOuB,IADlH,uBAEVqB,KAAKC,SAAL,CAAe7C,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CAFU,oFAIoCA,OAAO8C,SAJ3C,yBAKf9D,QAAQ+D,UAAR,CAAmBtF,OAAnB,CALe,0BAMLyB,KAAKsD,KAAL,CAAWjF,MAAX,CAAkByC,OAAO0B,KAAzB,EAAgCiB,MAN3B,8EAO6C3C,OAAOjC,GAPpD,uDAO2GiC,OAAOuB,IAPlH,gDAQevB,OAAO0B,KARtB,yBAApB;;AAWA,YAAG,CAAC1B,OAAOuB,IAAX,EAAiB9D,QAAQ4C,aAAR,CAAsB,OAAtB,EAA+B2C,KAA/B;;AAEjB,iBAASC,MAAT,CAAgBC,IAAhB,EAAsB;;AAEpBA,mBAAO,IAAIC,IAAJ,CAASD,IAAT,CAAP;;AAEA,gBAAIE,SAAS,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,UAAjE,EAA6E,WAA7E,EAA0F,SAA1F,EAAqG,UAArG,EAAiH,UAAjH,CAAb;;AAEA,gBAAI,CAACF,IAAD,IAASvD,OAAOuD,IAAP,EAAarD,WAAb,MAA8B,cAA3C,EAA2D,OAAO,EAAP;;AAE3D,kCACIqD,KAAKG,OAAL,EADJ,SACsBD,OAAOF,KAAKI,QAAL,EAAP,CADtB,SACiDJ,KAAKK,WAAL,EADjD,kBAEKL,KAAKM,QAAL,EAFL,UAE0B7D,OAAOuD,KAAKO,UAAL,EAAP,EAA0BzC,MAA1B,GAAmC,CAAnC,GAAuC,EAAvC,GAA4C,CAFtE,IAE4EkC,KAAKO,UAAL,EAF5E;AAKD;AAEF,KA7O4B;;AA+O7BV,gBAAY,oBAACtF,OAAD,EAAa;;AAExB,YAAIuC,SAASd,KAAKF,OAAL,CAAazB,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEA,uDACQiC,OAAO0D,YAAP,GAAsB,0CAAtB,GAAmE,8CAD3E,oCAEqBjG,QAAQQ,OAAR,CAAgBF,GAFrC,uFAGqBN,QAAQQ,OAAR,CAAgBF,GAHrC,mHAIqBN,QAAQQ,OAAR,CAAgBF,GAJrC;AAOA,KA1P4B;;AA4P7B4F,UAAM,cAAClG,OAAD,EAAa;;AAEjByB,aAAK0E,QAAL,CAAcC,GAAd,CAAkB,EAAEC,MAAM,MAAR,EAAgB9D,QAAQvC,QAAQQ,OAAR,CAAgBF,GAAxC,EAAlB;;AAEAmB,aAAK0E,QAAL,CAAcG,SAAd,CAAwB,IAAxB,EAA8B,EAAEC,aAAa,IAAf,EAA9B;AAED,KAlQ4B;;AAqQ7BC,YAAQ,gBAACxG,OAAD,EAAa;;AAEnB,YAAIuC,SAASd,KAAKF,OAAL,CAAazB,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEAN,gBAAQC,SAAR,6LAG0DsC,OAAO8C,SAHjE,wEAKO9D,QAAQ+D,UAAR,CAAmBtF,OAAnB,CALP,8EAMmEuC,OAAOjC,GAN1E,uDAMiIiC,OAAOuB,IANxI,kDAOqCvB,OAAO0B,KAP5C;AAWD,KApR4B;;AAsR7BwC,WAAO,eAACzG,OAAD,EAAa;;AAElB,YAAIuC,SAASd,KAAKF,OAAL,CAAazB,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEAN,gBAAQC,SAAR,6LAG0DsC,OAAO8C,SAHjE,uEAKO9D,QAAQ+D,UAAR,CAAmBtF,OAAnB,CALP,8EAMmEuC,OAAOjC,GAN1E,uDAMiIiC,OAAOuB,IANxI,kDAOqCvB,OAAO0B,KAP5C;AAWD;;AArS4B,CAA/B;;AAySC,UAASyC,OAAT,GAAkB;;AAEjB,QAAG,CAACnF,QAAQQ,OAAZ,EAAqB,OAAO4E,WAAWD,OAAX,EAAoB,GAApB,CAAP;;AAErBnF,YAAQQ,OAAR,GAAkB,KAAlB;;AAEAR,YAAQoB,IAAR;;AAEA+D;AAED,CAVA,GAAD;;;;;;ACzSA,IAAIP,WAAWvG,OAAOC,OAAP,GAAiB;;AAE9B+G,kBAAc,SAFgB;;AAI9B9G,YAAQ,EAJsB;;AAM9BC,UAAM,SAASA,IAAT,GAAe;;AAEnB0B,aAAKK,IAAL,GAAYZ,SAAS0B,aAAT,CAAuB,MAAvB,CAAZ;;AAEA,YAAG,CAACnB,KAAKK,IAAT,EAAe,OAAO6E,WAAW5G,IAAX,EAAiB,CAAjB,CAAP;;AAEfoG,iBAASC,GAAT,CAAa,IAAb,EAAmB,EAAEG,aAAa,IAAf,EAAnB;AAED,KAd6B;;AAgB9BM,gBAAY,oBAAC7G,OAAD,EAAa;;AAEvB,YAAG,CAACyB,KAAKqF,EAAL,CAAQC,OAAZ,EAAqB;;AAErBZ,iBAASC,GAAT,CAAa,UAAb;;AAEAD,iBAASG,SAAT,CAAmB,IAAnB,EAAyB,EAAEC,aAAa,IAAf,EAAzB;AAED,KAxB6B;;AA0B9BS,aAAS,iBAAChH,OAAD,EAAa;;AAEpByB,aAAKC,IAAL,CAAU;AACRC,qBAAS,SADD;AAERsF,mBAAOjH,QAAQkH,aAAR,CAAsBtE,aAAtB,CAAoC,gBAApC,EAAsDT,KAAtD,IAA+D,EAF9D;AAGRgF,sBAAUnH,QAAQkH,aAAR,CAAsBtE,aAAtB,CAAoC,mBAApC,EAAyDT,KAAzD,IAAkE;AAHpE,SAAV,EAIG,YAAM;;AAEPgE,qBAASC,GAAT,CAAa,UAAb;;AAEAD,qBAASG,SAAT,CAAmB,IAAnB,EAAyB,EAAEC,aAAa,IAAf,EAAzB;AAED,SAVD;AAYD,KAxC6B;;AA0C9Ba,cAAU,kBAACpH,OAAD,EAAa;;AAErByB,aAAKC,IAAL,CAAU,EAAEC,SAAS,UAAX,EAAV;AAED,KA9C6B;;AAgD9B0F,qBAAiB,yBAACrH,OAAD,EAAa;;AAE5B,YAAIsH,SAAS7F,KAAKK,IAAL,CAAUyF,gBAAV,CAA2B,wBAA3B,CAAb;;AAEA,YAAGD,OAAO,CAAP,EAAUnF,KAAV,IAAmBmF,OAAO,CAAP,EAAUnF,KAAhC,EAAuC,OAAOqF,MAAM,WAAN,CAAP;;AAEvC/F,aAAKC,IAAL,CAAU;AACRC,qBAAS,cADD;AAER8F,0BAAcH,OAAO,CAAP,EAAUnF,KAFhB;AAGRgF,sBAAUG,OAAO,CAAP,EAAUnF,KAAV,IAAmB;AAHrB,SAAV,EAIG,UAACuF,GAAD,EAAS,CAIX,CARD;AAUD,KAhE6B;;AAkE9BpB,eAAW,mBAACnC,IAAD,EAAO7B,OAAP,EAAmB;;AAE5B,YAAG,CAACb,KAAKK,IAAT,EAAe,OAAO6E,WAAWlF,KAAKK,IAAhB,EAAsB,CAAtB,EAAyBqC,IAAzB,EAA+B7B,OAA/B,CAAP;;AAEf,YAAI+D,OAAOlC,OAAOA,KAAK3D,OAAL,CAAa6F,IAApB,GAA2BxD,QAAQC,KAAR,GAAgBD,QAAQC,KAAR,CAAcuD,IAA9B,GAAqC,SAA3E;;AAEA,YAAG,CAACsB,aAAaC,OAAb,CAAqB,eAArB,CAAD,IAA0C,CAAC,SAAD,EAAY,OAAZ,EAAqB,OAArB,EAA8B7D,OAA9B,CAAsCsC,IAAtC,KAA+C,CAAC,CAA7F,EAAgG;AAC9FA,mBAAO,SAAP;AACD;;AAEDnF,iBAASC,IAAT,CAAcuD,SAAd,CAAwBmD,OAAxB,CAAgC,UAACC,CAAD,EAAO;;AAErC,gBAAGA,EAAE/D,OAAF,CAAU,OAAV,KAAsB,CAAC,CAA1B,EAA6B;;AAE7B7C,qBAASC,IAAT,CAAcuD,SAAd,CAAwBqD,MAAxB,CAA+BD,CAA/B;AAED,SAND;;AAQA5G,iBAASC,IAAT,CAAcuD,SAAd,CAAwBqD,MAAxB,CAA+B,UAA/B;;AAEA7G,iBAASC,IAAT,CAAcuD,SAAd,CAAwBlD,GAAxB,CAA4B6E,OAAO,OAAnC;;AAEA5E,aAAKK,IAAL,CAAUtB,OAAV,CAAkBT,IAAlB,GAAyBsG,OAAO,OAAhC;;AAEA,YAAG,CAAC/D,OAAD,IAAY,CAACA,QAAQiE,WAAxB,EAAqCJ,SAASC,GAAT,CAAa,MAAMC,IAAnB;;AAErC2B,eAAOC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;;AAEAxG,aAAKyG,KAAL,CAAWC,KAAX;AAED,KAhG6B;;AAkG9B/B,SAAK,aAACtD,KAAD,EAAQR,OAAR,EAAoB;;AAEvB,YAAI8F,YAAY9F,WAAWA,QAAQ+F,OAAnB,GAA6B,cAA7B,GAA8C,WAA9D;;AAEA,YAAIjC,MAAM,OAAOtD,KAAP,IAAgB,QAAhB,GAA2BwF,QAA3B,GAAsCC,SAASC,QAAzD;;AAEA,eAAO3F,QAAQuF,SAAR,EAAmBtF,QAAQA,KAAR,GAAgBwF,QAAnC,EAA6ChG,UAAUA,QAAQmG,KAAlB,GAA0BvH,SAASuH,KAAhF,EAAuF3F,QAAQ4F,QAAR,GAAmBF,QAA1G,CAAP;;AAEA,iBAASE,MAAT,GAAkB;;AAEhB,gBAAIrC,OAAOvD,QAAQA,MAAMuD,IAAN,IAAcF,SAASS,YAA/B,GAA8CT,SAASS,YAAlE;;AAEA,mBAAO1G,OAAOC,IAAP,CAAY2C,KAAZ,EAAmB1C,MAAnB,CAA0B,UAACgG,GAAD,EAAK9F,GAAL,EAAW;;AAE1C,oBAAIA,OAAO,MAAX,EAAmB,OAAO8F,GAAP;;AAEnB,uBAAUA,GAAV,SAAiB9F,GAAjB,SAAyBwC,MAAMxC,GAAN,CAAzB;AAED,aANM,SAOA+F,QAAQF,SAASS,YAAjB,GAAgC,EAAhC,GAAqCP,IAPrC,EAAP;AASD;;AAED,iBAASiC,MAAT,GAAkB;;AAEhB,gBAAIK,QAAQ,CAAC7F,SAASyF,SAASC,QAAnB,EAA6BI,KAA7B,CAAmC,KAAnC,CAAZ;;AAEA9F,oBAAQ,EAAR;;AAEA,iBAAK,IAAI+F,IAAI,CAAb,EAAgBA,IAAIF,MAAMpF,MAA1B,EAAkCsF,KAAK,CAAvC,EAA0C;;AAExC/F,sBAAM6F,MAAME,CAAN,KAAY,MAAlB,IAA4BF,MAAME,IAAI,CAAV,CAA5B;AAED;;AAED/F,kBAAMuD,IAAN,GAAavD,MAAMuD,IAAN,IAAcF,SAASS,YAApC;;AAEA,mBAAO9D,KAAP;AAED;AAEF;;AA3I6B,CAAhC;;;;;;ACAAlD,OAAOC,OAAP,GAAiB;;AAEfiJ,mBAAiB,yBAAC9I,OAAD,EAAa;;AAE/B2H,iBAAaoB,OAAb,CAAqB,UAArB,EAAiC/I,QAAQQ,OAAR,CAAgBwI,QAAjD;;AAEAT,aAASU,MAAT;AAEE,GARc;;AAUfC,kBAAgB,wBAAClJ,OAAD,EAAa;;AAE5B,QAAG,CAACA,QAAQ0E,SAAR,CAAkByE,QAAlB,CAA2BxB,aAAaC,OAAb,CAAqB,UAArB,KAAoC,IAA/D,CAAJ,EAA0E;;AAE1E5H,YAAQ0E,SAAR,CAAkBlD,GAAlB,CAAsB,QAAtB;AAEA,GAhBc;;AAkBf4H,eAAa,qBAACpJ,OAAD,EAAa;;AAEzB,QAAIyF,OAAO,IAAIC,IAAJ,CAAS1F,QAAQQ,OAAR,CAAgBiF,IAAzB,CAAX;AAAA,QACDE,SAAS,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,UAAjE,EAA6E,WAA7E,EAA0F,SAA1F,EAAqG,UAArG,EAAiH,UAAjH,CADR;;AAGF,QAAI,CAACF,IAAD,IAASvD,OAAOuD,IAAP,EAAarD,WAAb,MAA8B,cAA3C,EAA2D;;AAE3DpC,YAAQC,SAAR,GAAuBwF,KAAKG,OAAL,EAAvB,SAAyCD,OAAOF,KAAKI,QAAL,EAAP,CAAzC,SAAoEJ,KAAKK,WAAL,EAApE;AAEE,GA3Bc;;AA6BfuD,eAAa,qBAACrJ,OAAD,EAAa;;AAEzB,QAAIyF,OAAO,IAAIC,IAAJ,CAAS1F,QAAQQ,OAAR,CAAgBiF,IAAzB,CAAX;;AAEF,QAAI,CAACA,IAAD,IAASvD,OAAOuD,IAAP,EAAarD,WAAb,MAA8B,cAA3C,EAA2D;;AAEzDpC,YAAQC,SAAR,GAAwBwF,KAAKM,QAAL,EAAxB,UAA6C7D,OAAOuD,KAAKO,UAAL,EAAP,EAA0BzC,MAA1B,GAAmC,CAAnC,GAAuC,EAAvC,GAA4C,CAAzF,IAA+FkC,KAAKO,UAAL,EAA/F;AAEA,GArCc;;AAuCfsD,SAAO,eAACtJ,OAAD,EAAa;;AAErBgB,YAAQC,GAAR,CAAY,GAAZ,EAAiBjB,OAAjB;AAEE,GA3Cc;;AA6CfuJ,qBAAmB,2BAACvJ,OAAD,EAAa;;AAE/BkB,aAAS0B,aAAT,CAAuB,MAAvB,EAA+B8B,SAA/B,CAAyCqD,MAAzC,CAAgD,UAAhD;AAEA;;AAjDc,CAAjB;;;;;;ACAA,IAAIyB,UAAU5J,OAAOC,OAAP,GAAiB;;AAE7B;AACA;AACAC,UAAQ,EAJqB;;AAM7B;AACA0B,OAAK,aAACxB,OAAD,EAAa;;AAEhB;AACAyB,SAAKC,IAAL,CAAU,EAAEC,SAAS,YAAX,EAAV;AAED,GAZ4B;;AAc7B;AACAK,eAAa,qBAAChC,OAAD,EAAa;;AAExB;AACHwJ,YAAQvH,YAAR,GAAuBC,OAAOlC,QAAQmC,KAAR,IAAiB,EAAxB,EAA4BC,WAA5B,EAAvB;;AAEG;AACHoH,YAAQzH,OAAR,GAAkB,IAAlB;AAEE,GAvB4B;;AAyB7B;AACAM,QAAM,cAACrC,OAAD,EAAUsC,OAAV,EAAsB;;AAE1B;AACA,QAAIX,UAAU;AACXA,eAAS,MADE;AAEXrB,WAAKN,QAAQQ,OAAR,CAAgBiJ;AAFV,KAAd;;AAKC;AACA;AACA;AACA,QAAIjH,IAAIF,UAAUA,QAAQH,KAAlB,GAA0BnC,QAAQmC,KAA1C;;AAEAR,YAAQ3B,QAAQQ,OAAR,CAAgBiC,QAAxB,IAAoCD,CAApC;;AAEA;AACA;AACAf,SAAKC,IAAL,CAAUC,OAAV,EAAmBW,UAAUA,QAAQI,QAAlB,GAA6B,IAAhD;AAEF,GA7C4B;;AA+C7BC,QAAM,cAAC3C,OAAD,EAAa;;AAEjB;AACA;AACA,QAAG,CAACA,OAAJ,EAAaA,UAAUkB,SAAS0B,aAAT,CAAuB,4BAAvB,CAAV;;AAEb;AACA,QAAG,CAAC5C,OAAJ,EAAa;;AAEb;AACAA,YAAQC,SAAR;;AAEA;AACAwB,SAAKuB,MAAL,CAAYC,OAAZ,CAAoBjD,OAApB;;AAEA;AACAwJ,YAAQtG,MAAR,CAAelD,OAAf;AAED,GAjE4B;;AAoE7BkD,UAAQ,gBAAClD,OAAD,EAAUG,IAAV,EAAgBgD,SAAhB,EAA8B;;AAEpC;AACA,QAAG,CAACnD,OAAJ,EAAa;;AAEb;AACA;AACA;AACA;AACA,QAAG,CAACmD,SAAJ,EAAeA,YAAYnD,QAAQQ,OAAR,CAAgB2C,SAAhB,GAA4B,MAAMC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,IAA3B,CAA9C;;AAEf;AACA;AACA;AACA;AACA,QAAGtD,QAAQQ,OAAR,CAAgB2C,SAAhB,IAA6BA,SAAhC,EAA2C;;AAE3C;AACA,QAAG,CAAChD,IAAJ,EAAUA,OAAOD,OAAOC,IAAP,CAAYqJ,QAAQ1J,MAApB,CAAP;;AAEV;AACA,QAAG,CAACK,KAAKoD,MAAT,EAAiB;;AAEb;AACA;AACA,UAAG,CAACvD,QAAQwD,QAAR,CAAiBD,MAArB,EAA6B,OAAO9B,KAAKuB,MAAL,CAAYS,UAAZ,CAAuBzD,OAAvB,CAAP;;AAE7B;AACA,aAAOA,QAAQQ,OAAR,CAAgBkD,OAAhB,GAA0B,EAAjC;AAEH;;AAED,QAAIC,SAAS6F,QAAQvH,YAArB;AAAA,QAAmC;AAC/BwH,aAASD,QAAQ1J,MAAR,CAAeK,KAAKyD,KAAL,EAAf,CADb;;AAGA,QAAG,CAAC6F,MAAD,IAAWA,OAAO5F,QAAlB,IACAF,UAAUzB,OAAOuH,OAAO3F,IAAd,EAAoB1B,WAApB,GAAkC2B,OAAlC,CAA0CJ,MAA1C,KAAqD,CAAC,CADhE,IAEA6F,QAAQxF,cAAR,CAAuBT,MAAvB,IAAiCiG,QAAQxF,cAAR,CAAuBD,OAAvB,CAA+B0F,OAAOxF,KAAtC,KAAgD,CAAC,CAFrF,EAGE;;AAEC,UAAG9D,KAAKoD,MAAL,GAAc,GAAd,IAAqB,CAAxB,EAA2B,OAAOW,sBAAsB,YAAK;;AAE3DsF,gBAAQtG,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B;AAED,OAJiC,CAAP;;AAM3B,aAAOqG,QAAQtG,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B,CAAP;AAED;;AAEDe,0BAAsB,YAAK;;AAE1BsF,cAAQtG,MAAR,CAAelD,OAAf,EAAwBG,IAAxB,EAA8BgD,SAA9B;AAED,KAJA;;AAMD,QAAIgB,OAAOjD,SAASkD,aAAT,CAAuB,KAAvB,CAAX;;AAEAD,SAAK3D,OAAL,CAAaT,IAAb,GAAoB,oBAApB;;AAEAoE,SAAK3D,OAAL,CAAaiJ,MAAb,GAAsBA,OAAOnJ,GAA7B;;AAEAN,YAAQqE,WAAR,CAAoBF,IAApB;AAED,GApI4B;;AAsI7BG,WAAS,iBAACtE,OAAD,EAAa;;AAEpB,QAAIyJ,SAASD,QAAQ1J,MAAR,CAAeE,QAAQQ,OAAR,CAAgBF,GAA/B,CAAb;;AAEAmB,SAAKC,IAAL,CAAU,EAAEC,SAAS,SAAX,EAAsBrB,KAAKmJ,OAAOnJ,GAAlC,EAAV,EAAmD,YAAM;;AAEvD;AACAkJ,cAAQzH,OAAR,GAAkB,IAAlB;AAED,KALD;AAOD,GAjJ4B;;AAmJ7BiC,kBAAgB,EAnJa;;AAqJ7B0F,iBAAe,uBAAC1J,OAAD,EAAa;;AAE1B,QAAIM,MAAMN,QAAQQ,OAAR,CAAgBF,GAA1B;AAAA,QACIkE,SAASgF,QAAQxF,cADrB;AAAA,QAEIS,QAAQD,OAAOT,OAAP,CAAezD,GAAf,CAFZ;;AAIAN,YAAQ0E,SAAR,CAAkBC,MAAlB,CAAyB,QAAzB;;AAEA,QAAGF,QAAQ,CAAC,CAAZ,EAAeD,OAAOI,MAAP,CAAcH,KAAd,EAAqB,CAArB,EAAf,KAEKD,OAAOK,IAAP,CAAYvE,GAAZ;;AAELkJ,YAAQzH,OAAR,GAAkB,IAAlB;AAED,GAnK4B;;AAqK7B4H,gBAAc,sBAAC3J,OAAD,EAAa;;AAEzBA,YAAQC,SAAR,GAAoBC,OAAOC,IAAP,CAAYsB,KAAKF,OAAL,CAAazB,MAAzB,EAAiCM,MAAjC,CAAwC,UAACC,IAAD,EAAOC,GAAP,EAAe;;AAEzE,aAAOD,+DAA6DC,GAA7D,oDAC8BA,GAD9B,kCAAP;AAID,KANmB,EAMjB,EANiB,CAApB;AAQD,GA/K4B;;AAiL7BC,cAAY,oBAACP,OAAD,EAAa;;AAEvB,QAAIyJ,SAASD,QAAQ1J,MAAR,CAAeE,QAAQQ,OAAR,CAAgBiJ,MAA/B,CAAb;;AAEAzJ,YAAQQ,OAAR,CAAgBF,GAAhB,GAAsBN,QAAQQ,OAAR,CAAgBiJ,MAAtC;;AAEAzJ,YAAQC,SAAR,GAAoBuJ,QAAQ3H,IAAR,IAAgB,OAAhB,gDACiB7B,QAAQQ,OAAR,CAAgBF,GADjC,mCAEV6E,KAAKC,SAAL,CAAeqE,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CAFU,oFAIoCA,OAAOpE,SAJ3C,yBAKfmE,QAAQI,UAAR,CAAmB5J,OAAnB,CALe,4EAM6CyJ,OAAOnJ,GANpD,uDAM2GmJ,OAAO3F,IANlH,gDAOe2F,OAAOxF,KAPtB,yBAApB;;AAUA,QAAG,CAACwF,OAAO3F,IAAX,EAAiB9D,QAAQ4C,aAAR,CAAsB,OAAtB,EAA+B2C,KAA/B;;AAEjB,aAASC,MAAT,CAAgBC,IAAhB,EAAsB;;AAEpBA,aAAO,IAAIC,IAAJ,CAASD,IAAT,CAAP;;AAEA,UAAIE,SAAS,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,UAAjE,EAA6E,WAA7E,EAA0F,SAA1F,EAAqG,UAArG,EAAiH,UAAjH,CAAb;;AAEA,UAAI,CAACF,IAAD,IAASvD,OAAOuD,IAAP,EAAarD,WAAb,MAA8B,cAA3C,EAA2D,OAAO,EAAP;;AAE3D,4BACIqD,KAAKG,OAAL,EADJ,SACsBD,OAAOF,KAAKI,QAAL,EAAP,CADtB,SACiDJ,KAAKK,WAAL,EADjD,kBAEKL,KAAKM,QAAL,EAFL,UAE0B7D,OAAOuD,KAAKO,UAAL,EAAP,EAA0BzC,MAA1B,GAAmC,CAAnC,GAAuC,EAAvC,GAA4C,CAFtE,IAE4EkC,KAAKO,UAAL,EAF5E;AAKD;AAEF,GAlN4B;;AAoN7B4D,cAAY,oBAAC5J,OAAD,EAAa;;AAExB,iDAC0BA,QAAQQ,OAAR,CAAgBF,GAD1C,yHAE0BN,QAAQQ,OAAR,CAAgBF,GAF1C,6HAG0BN,QAAQQ,OAAR,CAAgBF,GAH1C;AAMA,GA5N4B;;AA8N7B4F,QAAM,cAAClG,OAAD,EAAa;;AAEjB,QAAIyJ,SAAShI,KAAK+H,OAAL,CAAa1J,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEAN,YAAQC,SAAR,6LAG0DwJ,OAAOpE,SAHjE,sEAKOmE,QAAQI,UAAR,CAAmB5J,OAAnB,CALP,8EAMmEyJ,OAAOnJ,GAN1E,uDAMiImJ,OAAO3F,IANxI,kDAOqC2F,OAAOxF,KAP5C;AAWD,GA7O4B;;AAgP7BuC,UAAQ,gBAACxG,OAAD,EAAa;;AAEnB,QAAIyJ,SAAShI,KAAK+H,OAAL,CAAa1J,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEAN,YAAQC,SAAR,6LAG0DwJ,OAAOpE,SAHjE,wEAKOmE,QAAQI,UAAR,CAAmB5J,OAAnB,CALP,8EAMmEyJ,OAAOnJ,GAN1E,uDAMiImJ,OAAO3F,IANxI,kDAOqC2F,OAAOxF,KAP5C;AAWD,GA/P4B;;AAiQ7BwC,SAAO,eAACzG,OAAD,EAAa;;AAElB,QAAIyJ,SAAShI,KAAK+H,OAAL,CAAa1J,MAAb,CAAoBE,QAAQQ,OAAR,CAAgBF,GAApC,CAAb;;AAEAN,YAAQC,SAAR,6LAG0DwJ,OAAOpE,SAHjE,uEAKOmE,QAAQI,UAAR,CAAmB5J,OAAnB,CALP,8EAMmEyJ,OAAOnJ,GAN1E,uDAMiImJ,OAAO3F,IANxI,kDAOqC2F,OAAOxF,KAP5C;AAWD;;AAhR4B,CAA/B;;AAoRC,UAASyC,OAAT,GAAkB;;AAEjB,MAAG,CAAC8C,QAAQzH,OAAZ,EAAqB,OAAO4E,WAAWD,OAAX,EAAoB,GAApB,CAAP;;AAErB8C,UAAQzH,OAAR,GAAkB,KAAlB;;AAEAyH,UAAQ7G,IAAR;;AAEA+D;AAED,CAVA,GAAD;;;;;;ACpRA,IAAI3B,QAAQnF,OAAOC,OAAP,GAAiB;;AAE3BC,YAAQ,EAFmB;;AAI3B0B,SAAK,aAACxB,OAAD,EAAa;;AAEhByB,aAAKC,IAAL,CAAU,EAAEC,SAAS,UAAX,EAAV;AAED,KAR0B;;AAU3BkI,sBAAkB,0BAAC7J,OAAD,EAAa;;AAE7BA,gBAAQC,SAAR,4WASI8E,MAAM+E,YAAN,EATJ;AAYD,KAxB0B;;AA0B3BA,kBAAc,wBAAM;;AAElB,YAAI9E,OAAOD,MAAMjF,MAAN,CAAa2B,KAAKqF,EAAL,CAAQ9B,IAArB,CAAX;;AAEA,eAAOA,KAAK+E,KAAL,CAAW3J,MAAX,CAAkB,UAAC4J,IAAD,EAAOC,IAAP,EAAaxF,KAAb,EAAuB;;AAE9CuF,6DAEKC,4BAA2BxF,KAA3B,kGAAgI,EAFrI,qCAGsBA,QAAQ,CAH9B,6BAGuDA,QAAQ,CAH/D,YAGuEA,QAAQ,CAH/E,kEAI4CA,KAJ5C,4DAI0GwF,IAJ1G;;AAOA,mBAAOD,IAAP;AAED,SAXM,EAWJ,EAXI,CAAP;AAaD,KA3C0B;;AA6C3BE,qBAAiB,yBAACC,KAAD,EAAW;;AAE1B,YACCA,MAAMC,EAAN,IAAY,KAAZ,IAAqB3I,KAAKqF,EAAL,CAAQuD,cAA9B,IACCF,MAAMC,EAAN,IAAY,SAAZ,IAAyB3I,KAAKqF,EAAL,CAAQwD,kBADlC,IAEA7I,KAAKqF,EAAL,CAAQiD,KAAR,CAAcQ,SAASJ,MAAMC,EAAN,CAAS/B,OAAT,CAAiB,OAAjB,EAA0B,EAA1B,CAAT,EAAwC,EAAxC,CAAd,CAHA,EAIE8B,MAAMK,YAAN,CAAmB,SAAnB,EAA8B,IAA9B;AAEH,KArD0B;;AAuD3BC,uBAAmB,2BAACN,KAAD,EAAW;;AAE5B,YAAGA,MAAMC,EAAN,IAAY,KAAf,EAAsB,OAAO3I,KAAKC,IAAL,CAAU,EAAEC,SAAS,mBAAX,EAAgC0I,gBAAgBF,MAAMO,OAAtD,EAAV,CAAP;;AAEtB,YAAGP,MAAMC,EAAN,IAAY,SAAf,EAA0B,OAAO3I,KAAKC,IAAL,CAAU,EAAEC,SAAS,mBAAX,EAAgC2I,oBAAoBH,MAAMO,OAA1D,EAAV,CAAP;;AAE1B,YAAIX,QAAQhF,MAAMjF,MAAN,CAAa2B,KAAKqF,EAAL,CAAQ9B,IAArB,EAA2B+E,KAA3B,CAAiCY,GAAjC,CAAqC,UAACV,IAAD,EAAOxF,KAAP,EAAiB;;AAEhE,gBAAGA,SAAS8F,SAASJ,MAAMC,EAAN,CAAS/B,OAAT,CAAiB,OAAjB,EAA0B,EAA1B,CAAT,EAAwC,EAAxC,CAAZ,EAAyD,OAAO8B,MAAMO,OAAN,GAAgBT,IAAhB,GAAuB,EAA9B;;AAEzD,mBAAOxI,KAAKqF,EAAL,CAAQiD,KAAR,CAActF,KAAd,IAAuBwF,IAAvB,GAA8B,EAArC;AAED,SANW,CAAZ;;AAQAF,cAAMa,GAAN;;AAEAnJ,aAAKC,IAAL,CAAU,EAAEC,SAAS,mBAAX,EAAgCoI,OAAOA,KAAvC,EAAV;AAED,KAzE0B;;AA2E3Bc,iBAAa,qBAAC7K,OAAD,EAAa;;AAEzB,YAAIyE,QAAQzE,QAAQQ,OAAR,CAAgBiE,KAA5B;AAAA,YACIsF,QAAQhF,MAAMjF,MAAN,CAAagL,WAAb,CAAyBf,KAAzB,CAA+BgB,KAA/B,EADZ;;AAGChB,cAAMQ,SAASvK,QAAQQ,OAAR,CAAgBiE,KAAzB,EAAgC,EAAhC,CAAN,IAA6CzE,QAAQmC,KAArD;;AAEA,YAAI6I,SAASjB,MAAM3J,MAAN,CAAa,UAAC4J,IAAD,EAAOC,IAAP,EAAgB;;AAExC,gBAAG,CAACA,IAAJ,EAAU,OAAOD,IAAP;;AAEVA,iBAAKnF,IAAL,CAAU3C,OAAO+H,IAAP,EAAagB,WAAb,EAAV;;AAEA,mBAAOjB,IAAP;AAED,SARY,EAQV,EARU,CAAb;;AAUAgB,eAAOnG,IAAP,CAAY,EAAZ;;AAEApD,aAAKC,IAAL,CAAU,EAAEC,SAAS,cAAX,EAA2BoI,OAAOiB,MAAlC,EAAV,EAAsD,UAAChG,IAAD,EAAU;;AAE9D,gBAAG+E,MAAMxG,MAAN,IAAgByH,OAAOzH,MAA1B,EAAkC;;AAElC,gBAAIY,OAAOjD,SAAS0B,aAAT,CAAuB,sCAAvB,CAAX;;AAEAmC,kBAAM8E,gBAAN,CAAuB1F,IAAvB;;AAEE,gBAAIgG,QAAQjJ,SAAS0B,aAAT,mBAAwC6B,KAAxC,QAAZ;;AAEA0F,kBAAM5E,KAAN;;AAEA4E,kBAAMe,cAAN,GAAuBf,MAAMgB,YAAN,GAAqBhB,MAAMhI,KAAN,CAAYoB,MAAxD;AAEH,SAdD;AAgBD,KA9G0B;;AAgH3B6H,gBAAY,oBAACjB,KAAD,EAAW;;AAErBxC,qBAAaoB,OAAb,CAAqB,gBAArB,EAAuCoB,MAAMhI,KAA7C;AAED,KApH0B;;AAsH3BkJ,gBAAY,oBAAClB,KAAD,EAAW;;AAErBA,cAAMhI,KAAN,GAAcwF,aAAaC,OAAb,CAAqB,gBAArB,KAA0C,EAAxD;;AAEAuC,cAAM5E,KAAN;AAED,KA5H0B;;AA+H3B5C,UAAM,cAAC3C,OAAD,EAAa;;AAEjB,YAAG,CAACA,OAAJ,EAAa;;AAEbA,gBAAQC,SAAR;;AAEAwB,aAAKuB,MAAL,CAAYC,OAAZ,CAAoBjD,OAApB;;AAEAkE,8BAAsB,YAAK;;AAEzB,gBAAIP,SAASzB,OAAOyF,aAAaC,OAAb,CAAqB,QAArB,KAAkC,EAAzC,EAA6CxF,WAA7C,EAAb;;AAEA2C,kBAAM7B,MAAN,CAAalD,OAAb,EAAsB2D,MAAtB;AAED,SAND;AAQD,KA/I0B;;AAkJ3BT,YAAQ,gBAAClD,OAAD,EAAU2D,MAAV,EAAkBxD,IAAlB,EAAwBgD,SAAxB,EAAsC;;AAE5C,YAAG,CAACnD,OAAJ,EAAa;;AAEb,YAAG,CAACmD,SAAJ,EAAeA,YAAYnD,QAAQQ,OAAR,CAAgB2C,SAAhB,GAA4B,MAAMC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,IAA3B,CAA9C;;AAEf,YAAGtD,QAAQQ,OAAR,CAAgB2C,SAAhB,IAA6BA,SAAhC,EAA2C;;AAE3ChD,eAAOA,QAAQD,OAAOC,IAAP,CAAY4E,MAAMjF,MAAlB,CAAf;;AAEA,YAAG,CAACK,KAAKoD,MAAT,EAAiB;;AAEb,gBAAG,CAACvD,QAAQwD,QAAR,CAAiBD,MAArB,EAA6B,OAAO9B,KAAKuB,MAAL,CAAYS,UAAZ,CAAuBzD,OAAvB,CAAP;;AAE7B,mBAAOA,QAAQQ,OAAR,CAAgBiI,KAAhB,GAAwB,EAA/B;AAEH;;AAED,YAAIzD,OAAOD,MAAMjF,MAAN,CAAaK,KAAKyD,KAAL,EAAb,CAAX;;AAEA,YAAG,CAACoB,IAAD,IAASA,KAAKnB,QAAd,IACCF,UAAUzB,OAAO8C,KAAKlB,IAAZ,EAAkB1B,WAAlB,GAAgC2B,OAAhC,CAAwCJ,MAAxC,KAAmD,CAAC,CADlE,EAEG;;AAEA,gBAAGxD,KAAKoD,MAAL,GAAc,GAAd,IAAqB,CAAxB,EAA2B,OAAOW,sBAAsB,YAAK;;AAE3Da,sBAAM7B,MAAN,CAAalD,OAAb,EAAsB2D,MAAtB,EAA8BxD,IAA9B,EAAoCgD,SAApC;AAED,aAJiC,CAAP;;AAM3B,mBAAO4B,MAAM7B,MAAN,CAAalD,OAAb,EAAsB2D,MAAtB,EAA8BxD,IAA9B,EAAoCgD,SAApC,CAAP;AAED;;AAEDe,8BAAsB,YAAK;;AAE1Ba,kBAAM7B,MAAN,CAAalD,OAAb,EAAsB2D,MAAtB,EAA8BxD,IAA9B,EAAoCgD,SAApC;AAED,SAJA;;AAMD,YAAIgB,OAAOjD,SAASkD,aAAT,CAAuB,KAAvB,CAAX;;AAEAD,aAAK3D,OAAL,CAAaT,IAAb,GAAoB,kBAApB;;AAEAoE,aAAK3D,OAAL,CAAawE,IAAb,GAAoBA,KAAK1E,GAAzB;;AAEAN,gBAAQqE,WAAR,CAAoBF,IAApB;AAED,KAlM0B;;AAoM3B9B,UAAM,cAACrC,OAAD,EAAUsC,OAAV,EAAsB;;AAE1B,YAAIX,UAAU;AACXA,qBAAS,MADE;AAEXrB,iBAAKN,QAAQQ,OAAR,CAAgBwE;AAFV,SAAd;;AAKC,YAAIxC,IAAIF,UAAUA,QAAQH,KAAlB,GAA0BnC,QAAQmC,KAA1C;;AAEAR,gBAAQ3B,QAAQQ,OAAR,CAAgBiC,QAAxB,IAAoCD,CAApC;;AAEAf,aAAKC,IAAL,CAAUC,OAAV,EAAmBW,UAAUA,QAAQI,QAAlB,GAA6B,IAAhD;AAEF,KAjN0B;;AAmN3B4B,aAAS,iBAACtE,OAAD,EAAa;;AAEpB,YAAIgF,OAAOD,MAAMjF,MAAN,CAAaE,QAAQQ,OAAR,CAAgBF,GAA7B,CAAX;;AAEAmB,aAAKC,IAAL,CAAU,EAAEC,SAAS,SAAX,EAAsBrB,KAAK0E,KAAK1E,GAAhC,EAAV,EAAiD,YAAM;;AAErDyE,kBAAMhD,OAAN,GAAgB,IAAhB;AAED,SAJD;AAMD,KA7N0B;;AA+N3BxB,gBAAY,oBAACP,OAAD,EAAa;;AAEvB,YAAIgF,OAAOD,MAAMjF,MAAN,CAAaE,QAAQQ,OAAR,CAAgBwE,IAA7B,CAAX;;AAEA,YAAI+E,QAAQhF,MAAMjF,MAAN,CAAa2B,KAAKqF,EAAL,CAAQ9B,IAArB,EAA2B+E,KAA3B,CAAiC3J,MAAjC,CAAwC,UAACC,IAAD,EAAO4J,IAAP,EAAaxF,KAAb,EAAuB;;AAEzE,gBAAGwF,IAAH,EAAS5J,8BAA6BoE,KAA7B,qBAAoDO,KAAK1E,GAAzD,uDAAgH2J,IAAhH;;AAET,mBAAO5J,IAAP;AAED,SANW,EAMT,EANS,CAAZ;;AAQAL,gBAAQC,SAAR,yFAEiE+E,KAAK1E,GAFtE,sDAE2H0E,KAAKlB,IAAL,IAAa,EAFxI,wHAK+EkB,KAAK1E,GALpF,sDAKyI0E,KAAKiC,KAAL,IAAc,EALvJ,kHAQyEjC,KAAK1E,GAR9E,2HAW2C0E,KAAKC,IAXhD,qBAWsED,KAAK1E,GAX3E,uDAYgB0E,KAAKC,IAAL,IAAa,QAAb,GAAwB,WAAxB,GAAsC,EAZtD,4DAagBD,KAAKC,IAAL,IAAa,QAAb,GAAwB,WAAxB,GAAsC,EAbtD,+DAcgBD,KAAKC,IAAL,IAAa,OAAb,GAAuB,WAAvB,GAAqC,EAdrD,2IAkBoDD,KAAK1E,GAlBzD;;AAsBA,YAAG,CAAC0E,KAAKlB,IAAT,EAAe9D,QAAQ4C,aAAR,CAAsB,OAAtB,EAA+B2C,KAA/B;;AAEf,iBAASC,MAAT,CAAgBC,IAAhB,EAAsB;;AAEpBA,mBAAO,IAAIC,IAAJ,CAASD,IAAT,CAAP;;AAEA,gBAAIE,SAAS,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,UAAjE,EAA6E,WAA7E,EAA0F,SAA1F,EAAqG,UAArG,EAAiH,UAAjH,CAAb;;AAEA,gBAAI,CAACF,IAAD,IAASvD,OAAOuD,IAAP,EAAarD,WAAb,MAA8B,cAA3C,EAA2D,OAAO,EAAP;;AAE3D,kCACIqD,KAAKG,OAAL,EADJ,SACsBD,OAAOF,KAAKI,QAAL,EAAP,CADtB,SACiDJ,KAAKK,WAAL,EADjD,kBAEKL,KAAKM,QAAL,EAFL,UAE0B7D,OAAOuD,KAAKO,UAAL,EAAP,EAA0BzC,MAA1B,GAAmC,CAAnC,GAAuC,EAAvC,GAA4C,CAFtE,IAE4EkC,KAAKO,UAAL,EAF5E;AAKD;AAEF,KAlR0B;;AAoR3BhE,iBAAa,qBAAChC,OAAD,EAAa;;AAE3B2H,qBAAaoB,OAAb,CAAqB,QAArB,EAA+B/I,QAAQmC,KAAvC;;AAEA4C,cAAMhD,OAAN,GAAgB,IAAhB;AAEE;;AA1R0B,CAA7B;;AA+RC,UAAS2E,OAAT,GAAkB;;AAEjB,QAAG,CAAC3B,MAAMhD,OAAV,EAAmB,OAAO4E,WAAWD,OAAX,EAAoB,GAApB,CAAP;;AAEnB3B,UAAMhD,OAAN,GAAgB,KAAhB;;AAEA;AAED,CARA,GAAD;;;;;;AC/RA,IAAIuJ,SAAS1L,OAAOC,OAAP,GAAiB;;AAE5BkD,eAAa,qBAAC/C,OAAD,EAAa;;AAExB,QAAIM,MAAMuC,QAAQC,KAAR,CAAcP,MAAxB;AAAA,QACIA,SAASd,KAAKF,OAAL,CAAazB,MAAb,CAAoBQ,GAApB,CADb;;AAGAU,YAAQC,GAAR,CAAYsB,MAAZ;AAED;;AAT2B,CAA9B;;;;;;ACAA,IAAMgJ,QAAQ,CAAC,IAAD,EAAO,IAAP,CAAd;;AAEA,IAAI9G,QAAQ8G,MAAMxH,OAAN,CAAc4D,aAAaC,OAAb,CAAqB,UAArB,CAAd,CAAZ;;AAEA,IAAGnD,SAAS,CAAC,CAAb,EAAgBA,QAAQ,CAAR;;AAEhB,IAAIzB,SAAS;AACXwI,WAAS,CAAC,QAAD,EAAW,SAAX,CADE;AAEXC,qBAAmB,CAAC,+CAAD,EAAkD,uCAAlD,CAFR;AAGXC,4BAA0B,CAAC,qGAAD,EAAwG,2FAAxG,CAHf;AAIXC,cAAY,CAAC,uDAAD,EAA0D,oDAA1D,CAJD;AAKXnK,OAAK,CAAC,WAAD,EAAc,KAAd,CALM;AAMXgF,UAAQ,CAAC,YAAD,EAAe,QAAf,CANG;AAOXoF,SAAO,CAAC,UAAD,EAAa,OAAb,CAPI;AAQX5E,WAAS,CAAC,UAAD,EAAa,SAAb,CARE;AASX6E,iBAAe,CAAC1J,MAAM,UAAN,EAAkBA,MAAM,SAAN,CAAlB,CAAD,CATJ;AAUXiF,YAAU,CAAC,WAAD,EAAc,UAAd,CAVC;AAWX7F,WAAS,CAAC,WAAD,EAAc,SAAd,CAXE;AAYXuK,WAAS,CAAC,SAAD,EAAY,SAAZ,CAZE;AAaXC,eAAa,CAAC,eAAD,EAAkB,aAAlB,CAbF;AAcXtF,SAAO,CAAC,cAAD,EAAiB,YAAjB,CAdI;AAeXhD,cAAY,CACVgF,MAAM,iBAAN,CADU,EAEVA,MAAM,YAAN,CAFU,CAfD;AAmBXxF,WAAS,CACPwF,MAAM,UAAN,CADO,EAEPA,MAAM,YAAN,CAFO,CAnBE;AAuBXnE,WAAS,CAAC,WAAD,EAAc,SAAd,CAvBE;AAwBX4B,QAAM,CAAC,QAAD,EAAW,MAAX,CAxBK;AAyBXtE,aAAW,CAAC,WAAD,EAAc,WAAd,CAzBA;AA0BX+B,UAAQ,CAAC,QAAD,EAAW,QAAX,CA1BG;AA2BXqI,YAAU,CAAC,UAAD,EAAa,UAAb,CA3BC;AA4BX3J,QAAM,CAAC,WAAD,EAAc,MAAd,CA5BK;AA6BX4J,eAAa,CAAC,OAAD,EAAU,OAAV,CA7BF;AA8BXC,QAAM,CAAC,eAAD,EAAkB,MAAlB,CA9BK;AA+BXC,UAAQ,CAAC,UAAD,EAAa,SAAb,CA/BG;AAgCXC,aAAW,CAAC,cAAD,EAAiB,WAAjB,CAhCA;AAiCXC,eAAa,CAAC,mBAAD,EAAsB,aAAtB,CAjCF;AAkCXlF,YAAU,CAAC,YAAD,EAAe,UAAf,CAlCC;AAmCXmF,iBAAe,CAAC,qBAAD,EAAwB,iBAAxB,CAnCJ;AAoCX7E,gBAAc,CAAC8E,YAAY,gBAAZ,CAAD,EAAgCA,YAAY,cAAZ,CAAhC,CApCH;AAqCXC,gBAAc,CAACD,YAAY,kBAAZ,CAAD,EAAkCA,YAAY,cAAZ,CAAlC,CArCH;AAsCXE,sBAAoB,CAACF,YAAY,QAAZ,CAAD,EAAwBA,YAAY,QAAZ,CAAxB;AAtCT,CAAb;;AAyCA,KAAI,IAAIG,CAAR,IAAa1J,MAAb,EAAqB;;AAEnB,MAAG,CAACA,OAAO2J,cAAP,CAAsBD,CAAtB,CAAJ,EAA8B;;AAE9B,MAAG1J,OAAO0J,CAAP,KAAa,KAAhB,EAAuB1J,OAAO0J,CAAP,IAAYA,CAAZ,CAAvB,KAEK1J,OAAO0J,CAAP,IAAY1J,OAAO0J,CAAP,EAAUjI,KAAV,CAAZ;AAEN;;AAED7E,OAAOC,OAAP,GAAiBmD,MAAjB;;AAEA,SAASuJ,WAAT,CAAqBK,KAArB,EAA2B;;AAEzB,SAAO,UAACC,EAAD;AAAA,WAAQA,GAAGrC,YAAH,CAAgB,aAAhB,EAA+BoC,KAA/B,CAAR;AAAA,GAAP;AAED;;AAED,SAASnE,KAAT,CAAemE,KAAf,EAAqB;;AAEnB,SAAO,UAACC,EAAD;AAAA,WAAQA,GAAGrC,YAAH,CAAgB,YAAhB,EAA8BoC,KAA9B,CAAR;AAAA,GAAP;AAED;;AAED,SAASzK,KAAT,CAAeyK,KAAf,EAAqB;;AAEnB,SAAO,UAACC,EAAD;AAAA,WAAQA,GAAGrC,YAAH,CAAgB,YAAhB,EAA8BoC,KAA9B,CAAR;AAAA,GAAP;AAED;;;;;;AC3ED,IAAI1E,QAAQtI,OAAOC,OAAP,GAAiB;;AAE3BE,OAAM,cAACC,OAAD,EAAa;;AAEpByB,OAAKqL,aAAL,GAAqB9M,OAArB;AAEE,EAN0B;;AAQ3B+M,OAAM,cAAC/M,OAAD,EAAUD,IAAV,EAAmB;;AAE1B,MAAImI,QAAQzG,KAAKqL,aAAjB;;AAEA,MAAG5E,MAAM1H,OAAN,CAAcF,GAAjB,EAAsB4H,MAAM1H,OAAN,CAAcF,GAAd,GAAoBN,QAAQQ,OAAR,CAAgBF,GAApC;;AAItB,MAAG,CAACY,SAASC,IAAT,CAAcuD,SAAd,CAAwByE,QAAxB,CAAiC,YAAjC,CAAJ,EACC1H,KAAKK,IAAL,CAAUV,KAAV,CAAgB4L,SAAhB,qBAA4ChF,OAAOiF,OAAP,IAAkB/L,SAASC,IAAT,CAAc+L,SAA5E;;AAEDC,SAAO,CAAP,EAAS,CAAT;;AAEAjF,QAAM1H,OAAN,CAAcT,IAAd,GAAqBC,QAAQQ,OAAR,CAAgB0H,KAArC;;AAEAhE,wBAAsB;AAAA,UAAIhD,SAASC,IAAT,CAAcuD,SAAd,CAAwBlD,GAAxB,CAA4B,YAA5B,CAAJ;AAAA,GAAtB;AAEE,EAzB0B;;AA2B3B2G,QAAO,eAACnI,OAAD,EAAa;;AAErB,MAAIoN,YAAY7C,SAAS9I,KAAKK,IAAL,CAAUV,KAAV,CAAgB4L,SAAhB,CAA0B3E,OAA1B,CAAkC,aAAlC,EAAiD,EAAjD,CAAT,EAA+D,EAA/D,CAAhB;;AAEAnH,WAASC,IAAT,CAAcuD,SAAd,CAAwBqD,MAAxB,CAA+B,YAA/B;;AAEAtG,OAAKK,IAAL,CAAUuL,eAAV,CAA0B,OAA1B;;AAEA5L,OAAKqL,aAAL,CAAmB/M,IAAnB,GAA0B,aAA1B;;AAEAiI,SAAOmF,MAAP,CAAc,CAAd,EAAiB,CAAC,CAAD,GAAKC,SAAtB;AAEE,EAvC0B;;AAyC3BE,QAAO;;AAzCoB,CAA7B;;;;;;ACAA,IAAIC,UAAU3N,OAAOC,OAAP,GAAiB;;AAE7BC,YAAQ,EAFqB;;AAI7BC,UAAM,cAACC,OAAD,EAAa;;AAEjBA,gBAAQQ,OAAR,CAAgB2J,KAAhB,GAAwB,cAAxB;;AAEA,YAAG,CAACnK,QAAQQ,OAAR,CAAgBF,GAApB,EAAyB;;AAEzB,YAAIA,MAAMN,QAAQQ,OAAR,CAAgBF,GAA1B;AAAA,YACIkN,aAAalN,IAAIsI,KAAJ,CAAU,GAAV,EAAe,CAAf,CADjB;AAAA,YAEI6E,OAAOhM,KAAK+L,UAAL,EAAiB1N,MAAjB,CAAwBQ,GAAxB,CAFX;;AAIA,YAAG,CAACmN,KAAKzN,QAAQQ,OAAR,CAAgBiC,QAArB,CAAJ,EAAoC;;AAEpC,YAAIiL,eAAeD,KAAKzN,QAAQQ,OAAR,CAAgBiC,QAArB,CAAnB;AAAA,YACIkL,sBAAsBD,aAAa9E,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAD1B;;AAGA,YAAG,CAACnH,KAAKkM,mBAAL,CAAJ,EAA+B;;AAE/B,YAAIlL,WAAWhB,KAAKkM,mBAAL,EAA0B7N,MAA1B,CAAiC4N,YAAjC,CAAf;;AAEA1N,gBAAQmC,KAAR,GAAgBM,SAASqB,IAAzB;AAED,KAzB4B;;AA2B7B8J,YAAQ,gBAAC5N,OAAD,EAAa;;AAEnB,YAAIM,MAAMN,QAAQQ,OAAR,CAAgBF,GAA1B;AAAA,YACIkN,aAAalN,IAAIsI,KAAJ,CAAU,GAAV,EAAe,CAAf,CADjB;AAAA,YAEI6E,OAAOhM,KAAK+L,UAAL,EAAiB1N,MAAjB,CAAwBQ,GAAxB,CAFX;;AAIA,YAAI6J,QAAQnK,QAAQkH,aAAR,CAAsBA,aAAtB,CAAoCtE,aAApC,CAAkD,OAAlD,CAAZ;;AAEAuH,cAAMhI,KAAN,GAAcsL,KAAK3J,IAAnB;;AAEA,YAAI+J,mBAAmB1D,MAAM3J,OAAN,CAAcF,GAAd,CAAkBsI,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAAvB;;AAEA5I,gBAAQkH,aAAR,CAAsBjH,SAAtB,GAAkC,EAAlC;;AAEA,YAAI0B,UAAU;AACXA,qBAAS,MADE;AAEXrB,iBAAK6J,MAAM3J,OAAN,CAAcF;AAFR,SAAd;;AAKCqB,gBAAQwI,MAAM3J,OAAN,CAAciC,QAAtB,IAAkCgL,KAAKnN,GAAvC;;AAEAmB,aAAKC,IAAL,CAAUC,OAAV;AAEF,KAlD4B;;AAoD7BmM,YAAQ,gBAAC9N,OAAD,EAAa;;AAEnB,YAAI+N,YAAY/N,QAAQ4C,aAAR,CAAsB,IAAtB,CAAhB;;AAEA,YAAGmL,SAAH,EAAcR,QAAQK,MAAR,CAAeG,SAAf;AAEf,KA1D4B;;AA4D7B1L,UAAM,SAASsB,MAAT,CAAgB3D,OAAhB,EAAyBG,IAAzB,EAA+B;;AAEnC,YAAI6N,KAAKhO,QAAQkH,aAAR,CAAsBtE,aAAtB,CAAoC,IAApC,CAAT;;AAEA,YAAG,CAACzC,IAAJ,EAAU6N,GAAG/N,SAAH,GAAe,EAAf;;AAEVE,eAAOA,QAAQD,OAAOC,IAAP,CAAYsB,KAAKzB,QAAQQ,OAAR,CAAgBgN,UAArB,EAAiC1N,MAA7C,CAAf;;AAEA,YAAGyN,QAAQU,IAAR,IAAgBV,QAAQU,IAAR,GAAe9N,KAAKoD,MAAvC,EAA+C,OARZ,CAQoB;;AAEvDgK,gBAAQU,IAAR,GAAe9N,KAAKoD,MAAL,GAAc,CAA7B;;AAEA,YAAG,CAACpD,KAAKoD,MAAN,IAAgB,CAACvD,QAAQmC,KAA5B,EAAmC,OAZA,CAYQ;;AAE3C,YAAI7B,MAAMH,KAAKyD,KAAL,EAAV;AAAA,YACI4J,aAAalN,IAAIsI,KAAJ,CAAU,GAAV,EAAe,CAAf,CADjB;AAAA,YAEI6E,OAAOhM,KAAK+L,UAAL,EAAiB1N,MAAjB,CAAwBQ,GAAxB,CAFX;;AAIA,YAAG4B,OAAOuL,KAAK3J,IAAL,IAAa,EAApB,EAAwB1B,WAAxB,GAAsC2B,OAAtC,CAA8C7B,OAAOlC,QAAQmC,KAAf,EAAsBC,WAAtB,EAA9C,KAAsF,CAAC,CAA1F,EACE,OAAOuB,OAAO3D,OAAP,EAAgBG,IAAhB,CAAP;;AAEF+D,8BAAsB;AAAA,mBAAIP,OAAO3D,OAAP,EAAgBG,IAAhB,CAAJ;AAAA,SAAtB;;AAEA6N,WAAG/N,SAAH,mDAA8DwN,KAAKnN,GAAnE,UAA6EmN,KAAK3J,IAAlF;AAED;;AArF4B,CAA/B;;;;;;ACAA,IAAIoK,UAAU,EAAd;;AAEAtO,OAAOC,OAAP,GAAiBsO,IAAjB;;AAEA,SAASA,IAAT,GAAgB;;AAEdC;;AAEAlN,WAASmN,eAAT,CAAyB5N,gBAAzB,CAA0C,OAA1C,EAAmD6N,QAAnD;;AAEApN,WAASmN,eAAT,CAAyB5N,gBAAzB,CAA0C,QAA1C,EAAoD6N,QAApD;;AAEApN,WAASmN,eAAT,CAAyB5N,gBAAzB,CAA0C,OAA1C,EAAmD6N,QAAnD;;AAEApN,WAASmN,eAAT,CAAyB5N,gBAAzB,CAA0C,QAA1C,EAAoD6N,QAApD;AAED;;AAED,SAASA,QAAT,CAAkB5N,CAAlB,EAAqBV,OAArB,EAA8B;;AAE5BA,YAAUA,WAAWU,EAAE6N,MAAvB;;AAEA,MAAG7N,EAAE8N,IAAF,CAAOpM,WAAP,MAAwB,QAA3B,EAAqC1B,EAAE+N,cAAF;;AAErC,MAAI,CAACzO,QAAQQ,OAAT,IAAoB,CAACR,QAAQQ,OAAR,CAAgBE,EAAE8N,IAAlB,CAAzB,EAAkD;;AAEhD,QAAG,CAACxO,QAAQkH,aAAZ,EAA2B;;AAE3B,WAAOoH,SAAS5N,CAAT,EAAYV,QAAQkH,aAApB,CAAP;AAED;;AAED,MAAIqH,SAAS9M,IAAb;;AAEA,OAAK,IAAIoH,IAAI,CAAR,EAAWF,QAAQ3I,QAAQQ,OAAR,CAAgBE,EAAE8N,IAAlB,EAAwB5F,KAAxB,CAA8B,GAA9B,CAAxB,EAA4DC,IAAIF,MAAMpF,MAAtE,EAA8EsF,GAA9E,EAAmF;;AAEjF,QAAI,CAAC0F,MAAL,EAAa,OAAOvN,QAAQ0N,KAAR,CAAc1O,QAAQQ,OAAR,CAAgBE,EAAE8N,IAAlB,KAA2B9N,EAAE8N,IAA3C,EAAiD,gBAAjD,CAAP;;AAEbD,aAASA,OAAO5F,MAAME,CAAN,CAAP,CAAT;AAED;;AAED,MAAG,OAAO0F,MAAP,IAAiB,QAApB,EAA8B,OAAOvO,QAAQC,SAAR,GAAoBsO,MAA3B;;AAE9B,MAAG,OAAOA,MAAP,IAAiB,UAApB,EAAgC,OAAOvN,QAAQ0N,KAAR,CAAc1O,QAAQQ,OAAR,CAAgBE,EAAE8N,IAAlB,KAA2B9N,EAAE8N,IAA3C,EAAiD,gBAAjD,CAAP;;AAEhCD,SAAOvO,OAAP;AAED;;AAED,SAASoO,IAAT,GAAgB;;AAEb,YAASH,IAAT,GAAe;;AAEd,QAAG,CAACC,QAAQ3K,MAAZ,EAAoB,OAAOW,sBAAsB+J,IAAtB,CAAP;;AAEpB,QAAIU,WAAWT,QAAQtJ,MAAR,CAAe,CAAf,EAAkBsJ,QAAQ3K,MAA1B,CAAf;;AAEA,SAAI,IAAIsF,IAAI,CAAZ,EAAeA,IAAI8F,SAASpL,MAA5B,EAAoCsF,GAApC,EAAyC;;AAEvC,SAAG8B,GAAH,CAAOiE,IAAP,CAAYD,SAAS9F,CAAT,EAAYtB,gBAAZ,CAA6B,0BAA7B,CAAZ,EAAsEsH,QAAtE;AAED;;AAED3K,0BAAsB+J,IAAtB;AAED,GAdA,GAAD;;AAgBA,MAAIa,gBAAJ,CAAqBC,QAArB,EAA+BC,OAA/B,CACE9N,SAASmN,eADX,EAEE;AACEY,gBAAY,IADd;AAEEC,aAAS,IAFX;AAGEC,eAAW,IAHb;AAIEC,mBAAe;AAJjB,GAFF;AAUD;;AAED,SAASL,QAAT,CAAkBM,SAAlB,EAA6B;;AAE3B,OAAI,IAAIxG,IAAI,CAAZ,EAAeA,IAAIwG,UAAU9L,MAA7B,EAAqCsF,GAArC,EAA0C;;AAExC,QAAGwG,UAAUxG,CAAV,EAAa2F,IAAb,IAAqB,YAAxB,EAAsC;;AAEnC,UAAGa,UAAUxG,CAAV,EAAayG,aAAb,IAA8B,WAAjC,EAA8CvP,KAAKsP,UAAUxG,CAAV,EAAa0F,MAAlB;;AAE9C;AAEF;;AAED,QAAGc,UAAUxG,CAAV,EAAa2F,IAAb,IAAqB,WAAxB,EAAqC;;AAErC,QAAGN,QAAQnK,OAAR,CAAgBsL,UAAUxG,CAAV,EAAa0F,MAA7B,KAAwC,CAAC,CAA5C,EAA+CL,QAAQrJ,IAAR,CAAawK,UAAUxG,CAAV,EAAa0F,MAA1B;AAEhD;AAEF;;AAED,SAASM,QAAT,CAAkB7O,OAAlB,EAA2B;;AAEzB,MAAIuP,IAAIvP,QAAQQ,OAAhB;AAAA,MACIF,MAAMiP,EAAEnB,IAAF,IAAU,IAAV,GAAiB3M,KAAK+N,MAAL,CAAYxK,IAA7B,GAAoCuK,EAAEnB,IADhD;AAAA,MAEIZ,mBAFJ;;AAIA,MAAG+B,EAAExP,IAAL,EAAW,OAAOA,KAAKC,OAAL,CAAP;;AAEX,MAAG,CAACM,GAAJ,EAAS,OAAOkN,WAAWkB,KAAX,CAAiBa,CAAjB,CAAP;;AAET/B,eAAa/L,KAAKnB,IAAIsI,KAAJ,CAAU,GAAV,EAAemC,KAAf,CAAqB,CAArB,EAAwB,CAAC,CAAzB,EAA4B0E,IAA5B,CAAiC,GAAjC,CAAL,CAAb;;AAEA,MAAI,CAACjC,UAAD,IAAe,CAACA,WAAW1N,MAAX,CAAkBQ,GAAlB,CAApB,EAA4C,OAAOU,QAAQ0N,KAAR,CAAcpO,GAAd,CAAP;;AAE5C,MAAIoP,OAAOH,EAAEpN,KAAF,IAAWoN,EAAEI,IAAb,IAAqBJ,EAAEK,EAAvB,IAA6BL,EAAElP,IAA1C;AAAA,MACIwP,MAAMrC,WAAW1N,MAAX,CAAkBQ,GAAlB,CADV;;AAGA,MAAGiP,EAAEpN,KAAL,EAAYnC,QAAQmC,KAAR,GAAgB0N,IAAIN,EAAEpN,KAAN,KAAgB,EAAhC;;AAEZ,MAAGoN,EAAElP,IAAL,EAAWL,QAAQC,SAAR,GAAoB4P,IAAIN,EAAElP,IAAN,KAAe,EAAnC;;AAEX,MAAGkP,EAAEI,IAAL,EAAW3P,QAAQC,SAAR,GAAoB,CAAC4P,IAAIN,EAAEI,IAAN,KAAe,EAAhB,EAAoBtH,OAApB,CAA4B,QAA5B,EAAsCyH,MAAtC,CAApB;;AAEX,MAAGP,EAAEK,EAAL,EAAS5P,QAAQoB,KAAR,CAAc2O,eAAd,cAAyCF,IAAIN,EAAEK,EAAN,KAAa,EAAtD;AAEV;;AAED,SAAS7P,IAAT,CAAcC,OAAd,EAAuB;;AAErB,MAAIuO,SAAS9M,IAAb;;AAEA,OAAK,IAAIoH,IAAI,CAAR,EAAWF,QAAQ3I,QAAQQ,OAAR,CAAgBT,IAAhB,CAAqB6I,KAArB,CAA2B,GAA3B,CAAxB,EAAyDC,IAAIF,MAAMpF,MAAnE,EAA2EsF,GAA3E,EAAgF;;AAE9E0F,aAASA,OAAO5F,MAAME,CAAN,CAAP,CAAT;;AAEA,QAAI,OAAO0F,MAAP,IAAiB,WAArB,EAAkC;;AAEhC,UAAGvO,QAAQQ,OAAR,CAAgBT,IAAhB,CAAqBgE,OAArB,CAA6B,OAA7B,KAAyC,CAAC,CAA7C,EAAgD,OAAOiM,UAAUhQ,OAAV,CAAP;;AAEhD,aAAOgB,QAAQ0N,KAAR,CAAc1O,QAAQQ,OAAR,CAAgBT,IAA9B,EAAoC,gBAApC,CAAP;AAED;AAEF;;AAED,MAAGC,QAAQQ,OAAR,CAAgBT,IAAhB,CAAqBkQ,SAArB,CAA+B,CAA/B,EAAkC,EAAlC,KAAyC,aAA5C,EAA2D;;AAEzD,QAAIjL,OAAOvD,KAAKsD,KAAL,CAAWjF,MAAX,CAAkB2B,KAAK+N,MAAL,CAAYxK,IAA9B,CAAX;AAAA,QACIkL,MAAMlQ,QAAQQ,OAAR,CAAgBT,IAD1B;;AAGAmQ,UAAMA,IAAID,SAAJ,CAAc,EAAd,CAAN;;AAEA,QAAGjL,QAAQ,OAAOkL,GAAP,IAAe,QAAvB,IAAmClL,KAAKkL,GAAL,CAAtC,EAAiD,OAAOlQ,QAAQmC,KAAR,GAAgB6C,KAAKkL,GAAL,CAAvB;AAElD;;AAED,MAAG,OAAO3B,MAAP,IAAiB,QAApB,EAA8B,OAAOvO,QAAQC,SAAR,GAAoBsO,MAA3B;;AAE9B,MAAG,OAAOA,MAAP,IAAiB,UAApB,EAAgC,OAAOA,OAAOvO,OAAP,CAAP;AAEjC;;AAED,SAASgQ,SAAT,CAAmBhQ,OAAnB,EAA4B;;AAE1B,MAAImQ,MAAM,IAAIC,cAAJ,EAAV;;AAEAD,MAAIpD,IAAJ,CAAS,KAAT,QAAqB/M,QAAQQ,OAAR,CAAgBT,IAArC,EAA8C,IAA9C;;AAEAoQ,MAAIE,kBAAJ,GAAyB,UAAS3P,CAAT,EAAY;;AAEnC,QAAI,KAAK4P,UAAL,IAAmB,CAAnB,IAAwB,KAAKC,MAAL,IAAe,GAA3C,EAAgD;;AAEhD9O,SAAK+O,SAAL,GAAiB/O,KAAK+O,SAAL,IAAkB,EAAnC;;AAEA,QAAIjC,SAAS9M,KAAK+O,SAAlB;;AAEA,SAAK,IAAI3H,IAAI,CAAR,EAAWF,QAAQ3I,QAAQQ,OAAR,CAAgBT,IAAhB,CAAqB6I,KAArB,CAA2B,GAA3B,CAAxB,EAAyDC,IAAI,CAAJ,GAAQF,MAAMpF,MAAvE,EAA+EsF,GAA/E,EAAoF;;AAElF,UAAI,CAAC0F,MAAL,EAAa;;AAEbA,aAAO5F,MAAME,CAAN,CAAP,IAAmB0F,OAAO5F,MAAME,CAAN,CAAP,KAAoB,EAAvC;;AAEA0F,eAASA,OAAO5F,MAAME,CAAN,CAAP,CAAT;AAED;;AAED7I,YAAQC,SAAR,GAAoBsO,OAAOlO,IAAP,GAAc,KAAKoQ,YAAvC;AAED,GApBD;;AAsBAN,MAAIzO,IAAJ;AAGD;;AAED,SAASoO,MAAT,CAAgBY,KAAhB,EAAuB;;AAErB,SAAOA,SAAS,GAAT,GAAe,MAAf,GAAwB,MAA/B;AAED;;;;;;ACvMD,IAAI,CAACxQ,OAAOyQ,MAAZ,EAAoB;AAClBzQ,SAAO0Q,cAAP,CAAsB1Q,MAAtB,EAA8B,QAA9B,EAAwC;AACtC2Q,gBAAY,KAD0B;AAEtCC,kBAAc,IAFwB;AAGtCC,cAAU,IAH4B;AAItC5O,WAAO,eAASoM,MAAT,EAAiB;AACtB;;AACA,UAAIA,WAAWyC,SAAX,IAAwBzC,WAAW,IAAvC,EAA6C;AAC3C,cAAM,IAAI0C,SAAJ,CAAc,yCAAd,CAAN;AACD;;AAED,UAAIC,KAAKhR,OAAOqO,MAAP,CAAT;AACA,WAAK,IAAI1F,IAAI,CAAb,EAAgBA,IAAIsI,UAAU5N,MAA9B,EAAsCsF,GAAtC,EAA2C;AACzC,YAAIuI,aAAaD,UAAUtI,CAAV,CAAjB;AACA,YAAIuI,eAAeJ,SAAf,IAA4BI,eAAe,IAA/C,EAAqD;AACnD;AACD;AACDA,qBAAalR,OAAOkR,UAAP,CAAb;;AAEA,YAAIC,YAAYnR,OAAOC,IAAP,CAAYD,OAAOkR,UAAP,CAAZ,CAAhB;AACA,aAAK,IAAIE,YAAY,CAAhB,EAAmBC,MAAMF,UAAU9N,MAAxC,EAAgD+N,YAAYC,GAA5D,EAAiED,WAAjE,EAA8E;AAC5E,cAAIE,UAAUH,UAAUC,SAAV,CAAd;AACA,cAAIG,OAAOvR,OAAOwR,wBAAP,CAAgCN,UAAhC,EAA4CI,OAA5C,CAAX;AACA,cAAIC,SAAST,SAAT,IAAsBS,KAAKZ,UAA/B,EAA2C;AACzCK,eAAGM,OAAH,IAAcJ,WAAWI,OAAX,CAAd;AACD;AACF;AACF;AACD,aAAON,EAAP;AACD;AA5BqC,GAAxC;AA8BD;;AAED,CAAC,YAAY;;AAEX,MAAI,OAAOlJ,OAAO2J,OAAd,KAA0B,WAA1B,IAAyC,eAAezQ,SAASmN,eAArE,EAAsF;;AAEtF,MAAIuD,YAAYC,MAAMD,SAAtB;AAAA,MACI/M,OAAO+M,UAAU/M,IADrB;AAAA,MAEID,SAASgN,UAAUhN,MAFvB;AAAA,MAGI6K,OAAOmC,UAAUnC,IAHrB;;AAKA,WAASqC,YAAT,CAAsBjF,EAAtB,EAA0B;AACxB,SAAKA,EAAL,GAAUA,EAAV;AACA;AACA;AACA,QAAIkF,UAAUlF,GAAGmF,SAAH,CAAa3J,OAAb,CAAqB,YAArB,EAAkC,EAAlC,EAAsCO,KAAtC,CAA4C,KAA5C,CAAd;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIkJ,QAAQxO,MAA5B,EAAoCsF,GAApC,EAAyC;AACvChE,WAAK+J,IAAL,CAAU,IAAV,EAAgBmD,QAAQlJ,CAAR,CAAhB;AACD;AACF;;AAEDiJ,eAAaF,SAAb,GAAyB;AACvBpQ,SAAK,aAASyQ,KAAT,EAAgB;AACnB,UAAG,KAAK9I,QAAL,CAAc8I,KAAd,CAAH,EAAyB;AACzBpN,WAAK+J,IAAL,CAAU,IAAV,EAAgBqD,KAAhB;AACA,WAAKpF,EAAL,CAAQmF,SAAR,GAAoB,KAAKE,QAAL,EAApB;AACD,KALsB;AAMvB/I,cAAU,kBAAS8I,KAAT,EAAgB;AACxB,aAAO,KAAKpF,EAAL,CAAQmF,SAAR,CAAkBjO,OAAlB,CAA0BkO,KAA1B,KAAoC,CAAC,CAA5C;AACD,KARsB;AASvBxE,UAAM,cAAShJ,KAAT,EAAgB;AACpB,aAAO,KAAKA,KAAL,KAAe,IAAtB;AACD,KAXsB;AAYvBsD,YAAQ,gBAASkK,KAAT,EAAgB;AACtB,UAAI,CAAC,KAAK9I,QAAL,CAAc8I,KAAd,CAAL,EAA2B;AAC3B,WAAK,IAAIpJ,IAAI,CAAb,EAAgBA,IAAI,KAAKtF,MAAzB,EAAiCsF,GAAjC,EAAsC;AACpC,YAAI,KAAKA,CAAL,KAAWoJ,KAAf,EAAsB;AACvB;AACDrN,aAAOgK,IAAP,CAAY,IAAZ,EAAkB/F,CAAlB,EAAqB,CAArB;AACA,WAAKgE,EAAL,CAAQmF,SAAR,GAAoB,KAAKE,QAAL,EAApB;AACD,KAnBsB;AAoBvBA,cAAU,oBAAW;AACnB,aAAOzC,KAAKb,IAAL,CAAU,IAAV,EAAgB,GAAhB,CAAP;AACD,KAtBsB;AAuBvBjK,YAAQ,gBAASsN,KAAT,EAAgB;AACtB,UAAI,CAAC,KAAK9I,QAAL,CAAc8I,KAAd,CAAL,EAA2B;AACzB,aAAKzQ,GAAL,CAASyQ,KAAT;AACD,OAFD,MAEO;AACL,aAAKlK,MAAL,CAAYkK,KAAZ;AACD;;AAED,aAAO,KAAK9I,QAAL,CAAc8I,KAAd,CAAP;AACD;AA/BsB,GAAzB;;AAkCAjK,SAAO8J,YAAP,GAAsBA,YAAtB;;AAEA,WAASK,mBAAT,CAA8BtC,GAA9B,EAAmCH,IAAnC,EAAyC0C,MAAzC,EAAiD;AAC7C,QAAIlS,OAAO0Q,cAAX,EAA2B;AACvB1Q,aAAO0Q,cAAP,CAAsBf,GAAtB,EAA2BH,IAA3B,EAAgC;AAC5B2C,aAAMD;AADsB,OAAhC;AAGH,KAJD,MAIO;AACHvC,UAAIyC,gBAAJ,CAAqB5C,IAArB,EAA2B0C,MAA3B;AACH;AACJ;;AAEDD,sBAAoBR,QAAQC,SAA5B,EAAuC,WAAvC,EAAoD,YAAY;AAC9D,WAAO,IAAIE,YAAJ,CAAiB,IAAjB,CAAP;AACD,GAFD;AAID,CArED;;;;;;ACjCAS,QAAQ,eAAR;;AAEA,IAAMC,WAAW,IAAjB;;AAEAxK,OAAOvG,IAAP,GAAc;;AAEZ+N,UAAQrB,MAFI;;AAIZsE,YAAUA,QAJE;;AAMZjC,aAAW+B,QAAQ,4BAAR,CANC;;AAQZhR,WAASgR,QAAQ,0BAAR,CARG;;AAUZ5S,UAAQ4S,QAAQ,yBAAR,CAVI;;AAYZpM,YAAUoM,QAAQ,2BAAR,CAZE;;AAcZvP,UAAQuP,QAAQ,wBAAR,CAdI;;AAgBZrK,SAAOqK,QAAQ,uBAAR,CAhBK;;AAkBZjH,UAAQiH,QAAQ,wBAAR,CAlBI;;AAoBZhF,WAASgF,QAAQ,yBAAR,CApBG;;AAsBZ/I,WAAS+I,QAAQ,0BAAR,CAtBG;;AAwBZxN,SAAOwN,QAAQ,wBAAR;;AAxBK,CAAd;;AA4BA,SAASpE,IAAT,GAAe;;AAEboE,UAAQ,gBAAR;;AAEArO,wBAAsB,YAAK;;AAE5BzC,SAAK0E,QAAL,CAAcpG,IAAd;;AAEA2S;AAEE,GAND;;AAQA,SAAO;AACL1N,UAAM,EADD;AAEL+B,aAAS,EAFJ;AAGL2H,WAAOA,KAHF;AAILiE,WAAOpK,SAAS5E,MAAT,CAAgBoH,KAAhB,CAAsB,CAAtB,EAAyBnC,KAAzB,CAA+B,GAA/B,EAAoCxI,MAApC,CAA2C,UAAC4J,IAAD,EAAO4I,IAAP,EAAgB;;AAEnE,UAAIC,IAAID,KAAKhK,KAAL,CAAW,GAAX,CAAR;;AAEAoB,WAAK6I,EAAE,CAAF,CAAL,IAAaA,EAAE,CAAF,CAAb;;AAEA,aAAO7I,IAAP;AAED,KARS,EAQP,EARO;AAJF,GAAP;AAeD;;AAED,SAAS0I,gBAAT,GAA4B;;AAE1B,MAAIC,QAAQ,EAAZ;AAAA,MACIG,YAAY,EADhB;;AAGA,OAAI,IAAIjK,CAAR,IAAalB,YAAb;AACEgL,aAAS,CAACA,QAAQ,GAAR,GAAc,GAAf,IAAsBI,mBAAmBlK,CAAnB,CAAtB,GAA8C,GAA9C,GAAqDkK,mBAAmBpL,aAAaC,OAAb,CAAqBiB,CAArB,CAAnB,CAA9D;AADF,GAGA,IAAImK,SAAJ,CAAcR,mCACWG,KADX,4CAE4BA,KAF1C,EAGElS,gBAHF,CAGmB,SAHnB,EAG8B,SAAS6N,QAAT,CAAkB5N,CAAlB,EAAoB;;AAEhD,QAAIuS,KAAKvS,EAAE6N,MAAX;;AAEA9M,SAAKC,IAAL,GAAYwR,KAAKD,EAAL,EAASH,SAAT,CAAZ;;AAEAL,aAAStN,KAAKgO,KAAL,CAAWzS,EAAE0S,IAAb,CAAT,EAA6BN,SAA7B;;AAEAG,OAAGI,mBAAH,CAAuB,SAAvB,EAAkC/E,QAAlC;;AAEA2E,OAAGxS,gBAAH,CAAoB,SAApB,EAA+B,UAACC,CAAD;AAAA,aAAO+R,SAAStN,KAAKgO,KAAL,CAAWzS,EAAE0S,IAAb,CAAT,EAA6BN,SAA7B,CAAP;AAAA,KAA/B;AAED,GAfD;AAiBD;;AAED,SAASpE,KAAT,CAAe1O,OAAf,EAAwB;;AAEtB,MAAGA,WAAWA,QAAQQ,OAAtB,EAA+B,OAAOQ,QAAQ0N,KAAR,CAAc1O,QAAQQ,OAAR,CAAgBkD,OAA9B,CAAP;;AAE/B1C,UAAQ0N,KAAR,CAAcyC,SAAd;AAED;;AAED,SAAS+B,IAAT,CAAcD,EAAd,EAAkBH,SAAlB,EAA6B;;AAE3B,SAAO,SAASpR,IAAT,CAAc0R,IAAd,EAAoB1Q,QAApB,EAA8B;;AAEnC,QAAI4Q,aAAYlQ,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,KAA3B,CAAhB;;AAEA8P,SAAK1Q,QAAL,GAAgB4Q,EAAhB;;AAEA,QAAG5Q,QAAH,EAAaoQ,UAAUQ,EAAV,IAAgB5Q,QAAhB;;AAEbuQ,OAAGvR,IAAH,CAAQyD,KAAKC,SAAL,CAAegO,IAAf,CAAR;AAED,GAVD;AAYD;;AAED,SAASX,QAAT,CAAkB/O,OAAlB,EAA2BoP,SAA3B,EAAqC;;AAEnC,MAAGpP,mBAAmBmO,KAAtB,EAA6B;;AAE5B,SAAI,IAAI0B,CAAR,IAAa7P,OAAb;AAAsB8P,YAAM9P,QAAQ6P,CAAR,CAAN;AAAtB,KAEF;AAEE;;AAEDC,QAAM9P,OAAN;;AAEA,MAAGA,QAAQgL,KAAX,EAAkB+E,OAAO/P,OAAP;;AAElB,MAAGA,QAAQgQ,QAAX,EAAqBnL,SAASoL,IAAT,GAAgBjQ,QAAQgQ,QAAxB;;AAErB,MAAGhQ,QAAQhB,QAAR,IAAoBoQ,UAAUpP,QAAQhB,QAAlB,CAAvB,EAAoD;;AAEnDoQ,cAAUpP,QAAQhB,QAAlB,EAA4BgB,OAA5B;;AAEA,WAAOoP,UAAUpP,QAAQhB,QAAlB,CAAP;AAEA;;AAED,MAAG,OAAOgB,QAAQuO,KAAf,IAAwB,WAA3B,EAAwC;;AAExCxQ,OAAKqF,EAAL,GAAU5G,OAAOyQ,MAAP,CAAclP,KAAKqF,EAAL,IAAW,EAAzB,EAA6BpD,OAA7B,CAAV;;AAEAxC,WAASC,IAAT,CAAcuD,SAAd,CAAwBhB,QAAQuO,KAAR,GAAgB,KAAhB,GAAwB,QAAhD,EAA0D,eAA1D;;AAEA,MAAG,CAACvO,QAAQuO,KAAZ,EAAmBxQ,KAAK0E,QAAL,CAAcC,GAAd,CAAkB,GAAlB;;AAEnBuB,eAAaoB,OAAb,CAAqB,eAArB,EAAsCrF,QAAQuO,KAAR,IAAiB,EAAvD;;AAEAxQ,OAAK0E,QAAL,CAAcG,SAAd,CAAwB,IAAxB,EAA8B,EAAEC,aAAa,IAAf,EAA9B;AAED;;AAED,SAASkN,MAAT,CAAgB/P,OAAhB,EAAyB;;AAEtBxC,WAASC,IAAT,CAAcuD,SAAd,CAAwBlD,GAAxB,CAA4B,UAA5B;;AAEFN,WAAS0B,aAAT,CAAuB,uBAAvB,EAAgD3C,SAAhD,GAA4DyD,QAAQgL,KAApE;AAEA;;AAED,SAAS8E,KAAT,CAAe9P,OAAf,EAAuB;;AAErB,MAAG,CAACA,QAAQpD,GAAZ,EAAiB;;AAEjB,MAAIkN,aAAa9J,QAAQpD,GAAR,CAAYsI,KAAZ,CAAkB,GAAlB,EAAuBmC,KAAvB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC0E,IAApC,CAAyC,GAAzC,CAAjB;;AAEA,MAAG,CAAChO,KAAK+L,UAAL,CAAJ,EAAsB,OAAOxM,QAAQC,GAAR,kBAA4BuM,UAA5B,iBAAP;;AAEtB,MAAG,CAAC/L,KAAK+L,UAAL,EAAiB1N,MAAjB,CAAwB4D,QAAQpD,GAAhC,CAAJ,EAA0C;;AAEzCmB,SAAK+L,UAAL,EAAiB1N,MAAjB,CAAwB4D,QAAQpD,GAAhC,IAAuCoD,OAAvC;;AAEA,WAAOjC,KAAK+L,UAAL,EAAiBzL,OAAjB,GAA2B,IAAlC;AAEA;;AAEDN,OAAK+L,UAAL,EAAiB1N,MAAjB,CAAwB4D,QAAQpD,GAAhC,IAAuCJ,OAAOyQ,MAAP,CAAclP,KAAK+L,UAAL,EAAiB1N,MAAjB,CAAwB4D,QAAQpD,GAAhC,KAAwC,EAAtD,EAA0DoD,OAA1D,CAAvC;AAED;;;;;;;;;AChLD;AACA,CAAC,YAAW;AACV,MAAIsP,YAAYhL,OAAOgL,SAAP,IAAoBhL,OAAO4L,YAA3C;AACA,MAAIC,KAAK7L,OAAO8L,MAAP,GAAiB9L,OAAO8L,MAAP,IAAiB,EAA3C;AACA,MAAIC,KAAKF,GAAG,aAAH,IAAqBA,GAAG,aAAH,KAAqB,EAAnD;AACA,MAAI,CAACb,SAAD,IAAce,GAAGC,QAArB,EAA+B;AAC/B,MAAIhM,OAAOiM,GAAX,EAAgB;AAChBjM,SAAOiM,GAAP,GAAa,IAAb;;AAEA,MAAIC,cAAc,SAAdA,WAAc,CAAS9N,GAAT,EAAa;AAC7B,QAAIX,OAAOrC,KAAK+Q,KAAL,CAAWzO,KAAK0O,GAAL,KAAa,IAAxB,EAA8BlC,QAA9B,EAAX;AACA9L,UAAMA,IAAIiC,OAAJ,CAAY,yBAAZ,EAAuC,EAAvC,CAAN;AACA,WAAOjC,OAAOA,IAAIrC,OAAJ,CAAY,GAAZ,KAAoB,CAApB,GAAwB,GAAxB,GAA8B,GAArC,IAA2C,cAA3C,GAA4D0B,IAAnE;AACD,GAJD;;AAMA,MAAI4O,UAAUC,UAAUC,SAAV,CAAoBnS,WAApB,EAAd;AACA,MAAIoS,eAAeT,GAAGS,YAAH,IAAmBH,QAAQtQ,OAAR,CAAgB,QAAhB,IAA4B,CAAC,CAAnE;;AAEA,MAAI0Q,YAAY;AACdpO,UAAM,gBAAU;AACd2B,aAAOO,QAAP,CAAgBU,MAAhB,CAAuB,IAAvB;AACD,KAHa;;AAKdyL,gBAAY,sBAAU;AACpB,SAAG3J,KAAH,CACG6D,IADH,CACQ1N,SAASqG,gBAAT,CAA0B,sBAA1B,CADR,EAEG/C,MAFH,CAEU,UAASmQ,IAAT,EAAe;AACrB,YAAIC,MAAMD,KAAKE,YAAL,CAAkB,iBAAlB,CAAV;AACA,eAAOF,KAAKhB,IAAL,IAAaiB,OAAO,OAA3B;AACD,OALH,EAMG/M,OANH,CAMW,UAAS8M,IAAT,EAAe;AACtBA,aAAKhB,IAAL,GAAYO,YAAYS,KAAKhB,IAAjB,CAAZ;AACD,OARH;;AAUA;AACA,UAAIa,YAAJ,EAAkB7N,WAAW,YAAW;AAAEzF,iBAASC,IAAT,CAAc2T,YAAd;AAA6B,OAArD,EAAuD,EAAvD;AACnB,KAlBa;;AAoBdC,gBAAY,sBAAU;AACpB,UAAIC,UAAU,GAAGjK,KAAH,CAAS6D,IAAT,CAAc1N,SAASqG,gBAAT,CAA0B,QAA1B,CAAd,CAAd;AACA,UAAI0N,cAAcD,QAAQrK,GAAR,CAAY,UAASuK,MAAT,EAAiB;AAAE,eAAOA,OAAOvF,IAAd;AAAoB,OAAnD,EAAqDnL,MAArD,CAA4D,UAASmL,IAAT,EAAe;AAAE,eAAOA,KAAKpM,MAAL,GAAc,CAArB;AAAwB,OAArG,CAAlB;AACA,UAAI4R,aAAaH,QAAQxQ,MAAR,CAAe,UAAS0Q,MAAT,EAAiB;AAAE,eAAOA,OAAOE,GAAd;AAAmB,OAArD,CAAjB;;AAEA,UAAIC,SAAS,CAAb;AACA,UAAIC,MAAMH,WAAW5R,MAArB;AACA,UAAIgS,SAAS,SAATA,MAAS,GAAW;AACtBF,iBAASA,SAAS,CAAlB;AACA,YAAIA,WAAWC,GAAf,EAAoB;AAClBL,sBAAYpN,OAAZ,CAAoB,UAASqN,MAAT,EAAiB;AAAEM,iBAAKN,MAAL;AAAe,WAAtD;AACD;AACF,OALD;;AAOAC,iBACGtN,OADH,CACW,UAASqN,MAAT,EAAiB;AACxB,YAAIE,MAAMF,OAAOE,GAAjB;AACAF,eAAOnN,MAAP;AACA,YAAI0N,YAAYvU,SAASkD,aAAT,CAAuB,QAAvB,CAAhB;AACAqR,kBAAUL,GAAV,GAAgBlB,YAAYkB,GAAZ,CAAhB;AACAK,kBAAUC,KAAV,GAAkB,IAAlB;AACAD,kBAAUE,MAAV,GAAmBJ,MAAnB;AACArU,iBAAS0U,IAAT,CAAcvR,WAAd,CAA0BoR,SAA1B;AACD,OATH;AAUD;AA5Ca,GAAhB;AA8CA,MAAII,OAAO9B,GAAG8B,IAAH,IAAW,IAAtB;AACA,MAAIC,OAAOjC,GAAGkC,MAAH,IAAa/N,OAAOO,QAAP,CAAgByN,QAA7B,IAAyC,WAApD;;AAEA,MAAIC,UAAU,SAAVA,OAAU,GAAU;AACtB,QAAIC,aAAa,IAAIlD,SAAJ,CAAc,UAAU8C,IAAV,GAAiB,GAAjB,GAAuBD,IAArC,CAAjB;AACAK,eAAWC,SAAX,GAAuB,UAASC,KAAT,EAAe;AACpC,UAAIrC,GAAGC,QAAP,EAAiB;AACjB,UAAItQ,UAAU0S,MAAMhD,IAApB;AACA,UAAIiD,WAAW5B,UAAU/Q,OAAV,KAAsB+Q,UAAUpO,IAA/C;AACAgQ;AACD,KALD;AAMAH,eAAWI,OAAX,GAAqB,YAAU;AAC7B,UAAIJ,WAAW5F,UAAf,EAA2B4F,WAAW/N,KAAX;AAC5B,KAFD;AAGA+N,eAAWK,OAAX,GAAqB,YAAU;AAC7BvO,aAAOrB,UAAP,CAAkBsP,OAAlB,EAA2B,IAA3B;AACD,KAFD;AAGD,GAdD;AAeAA;AACD,CAlFD;AAmFA","file":"dist/script.js","sourcesContent":["let blocks = module.exports = {\n\n  memory: [],\n\n  load: (element) => {\n\n    element.innerHTML = Object.keys(blocks.memory).reduce((html, key) => `${ html }\n      <div><a data-key=\"${ key }\" data-load=\"blocks.render_one\"></a></div>`, '');\n      \n  },\n\n  render_one: (element) => {\n\n    element.innerHTML = `${ element.dataset.key }`;\n    \n    element.addEventListener('mousedown', (e)=>{\n\n      blocks.drag_x = e.clientX;\n\n      blocks.drag_y = e.clientY;\n\n      blocks.drag_block = element;\nconsole.log(element)\n    });\n\n  }\n\n};\n\ndocument.body.addEventListener('mousemove', (e)=>{\n\n  if(!blocks.drag_block) return e;\n\n  blocks.drag_block.style.right = `${ blocks.drag_x - e.clientX }px`;\n\n  blocks.drag_block.style.top = `${ e.clientY - blocks.drag_y }px`;\n\n});\n\ndocument.body.addEventListener('mouseup', (e)=>blocks.drag_block = null);","let courses = module.exports = {\r\n\r\n  // here we save all courses in client memory\r\n  // { [key]: OBJECT }\r\n  memory: {},\r\n\r\n  // button is placed to the right of the title of the page\r\n  add: (element) => {\r\n\r\n    // root.send is used to talk to the server\r\n    root.send({ request: 'new_course' });\r\n\r\n  },\r\n\r\n  // view mode can be cards or list, it has a button in the left top of the interface\r\n  view_mode: (element) => {\r\n\r\n    courses.mode = element.dataset.mode;\r\n\r\n    // we put the mode also in the main, to support CSS styling\r\n    root.main.dataset.mode = element.dataset.mode;\r\n\r\n    // see update loop at the bottom of this file\r\n\tcourses.updated = true;\r\n    \r\n  },\r\n  \r\n  // anytime the user triggers the data-input of the search field, we execute this\r\n  save_search: (element) => {\r\n\r\n    // used inside of courses.render()\r\n\tcourses.search_query = String(element.value || '').toLowerCase();\r\n\r\n    // see update loop at the bottom of this file\r\n\tcourses.updated = true;\r\n\r\n  },\r\n\r\n  // goes off anytime course-related data-input is fired\r\n  edit: (element, options) => {\r\n\r\n    // we always need to provide a request string and the key of the object we are editing\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.course\r\n     };\r\n\r\n     // but the value we are changing shall be added dynamically,\r\n     // so we can use this edit function straight from the HTML\r\n     // <input data-input=\"courses.edit\" data-key=\"[KEY]\">\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     // options.callback can only be used when this function is fired manually in Javascript\r\n     // since we cannot write a function inside of the HTML tag\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n\r\n  list: (element) => {\r\n\r\n    // we are lazy developers that do not want to select the list over and over\r\n    // whenever we use this list function manually\r\n    if(!element) element = document.querySelector('[data-load=\"courses.list\"]');\r\n\r\n    // element still not found?! we must stop this madness\r\n    if(!element) return;\r\n\r\n    if(history.state.course) return courses.load_course(element);\r\n    \r\n    // we clean out the old HTML should this function be fired after the list already rendered\r\n    element.innerHTML = ``;\r\n\r\n    // we show a loading text\r\n    root.labels.loading(element);\r\n\r\n    // and start the render loop!\r\n    courses.render(element);\r\n\r\n  },\r\n\r\n  load_course: (element) => {\r\n\r\n    element.innerHTML = `<div data-load=\"courses.render_one\" data-course=\"${ history.state.course }\"></div>`;\r\n\r\n  },\r\n\r\n\r\n  render: (element, keys, iteration) => {\r\n\r\n    // maybe the user navigated away? Somehow the element is gone, RIP loop :'(\r\n    if(!element) return;\r\n\r\n    // we need to make sure we only run 1 loop at the same time\r\n    // every time render is called outside of its own loop, iteration will be undefined\r\n    // so we use this condition to also update the dataset of the element\r\n    // in order for the old loop to kill itself...\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    // if it turns out this execution is an outdated iteration,\r\n    // the element has updated its dataset.iteration outside of this loop\r\n    // we have to bring this loop to the white shores\r\n    // I offer this line of comment in dedication to the loop whos life will be cut before the natural end\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    // every time render is called outside of its own loop, keys will be undefined\r\n    if(!keys) keys = Object.keys(courses.memory);\r\n\r\n    // the loop has finished\r\n    if(!keys.length) {\r\n\r\n        // sadly, no children are found inside of the element\r\n        // this can only mean there were no results\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        // we had results, and are no longer loading, so lets clear that loading message\r\n        return element.dataset.message = '';\r\n\r\n    }\r\n\r\n    let search = courses.search_query, // search value is changed by courses.save_search()\r\n        course = courses.memory[keys.shift()];\r\n\r\n    if(!course || course.archived ||\r\n      (search && String(course.name).toLowerCase().indexOf(search) == -1) ||\r\n      (courses.manager_filter.length && courses.manager_filter.indexOf(course.admin) == -1)\r\n    ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         courses.render(element, keys, iteration);\r\n\r\n       });\r\n\r\n       return courses.render(element, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      courses.render(element, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'courses.render_one';\r\n\r\n    elem.dataset.course = course.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  archive: (element) => {\r\n\r\n    let course = courses.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: course.key }, () => {\r\n\r\n      // see update loop at the bottom of this file\r\n      courses.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  manager_filter: [],\r\n\r\n  toggle_manager: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        filter = courses.manager_filter,\r\n        index = filter.indexOf(key);\r\n\r\n    element.classList.toggle('active');\r\n\r\n    if(index > -1) filter.splice(index, 1);\r\n\r\n    else filter.push(key);\r\n\r\n    courses.updated = true;\r\n\r\n  },\r\n\r\n  load_managers: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.users.memory).reduce((html, key) => {\r\n\r\n      let user = root.users.memory[key];\r\n\r\n      if(user.role == 'admin') html += `<div data-click=\"courses.toggle_manager\" data-key=\"${ user.key }\">\r\n        <img src=\"${ user.avatar }\">\r\n        <span data-load=\"users.memory.${ user.key }.name\"></span>\r\n      </div>`;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n    \r\n    let course = courses.memory[element.dataset.course];\r\n\r\n    element.dataset.key = element.dataset.course;\r\n\r\n    element.innerHTML = courses.mode == 'lists' ? `\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n      <pre>${ JSON.stringify(course, null, 2) }</pre>\r\n    ` : `\r\n      <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n      ${ courses.course_nav(element) }\r\n      <img src=\"${ root.users.memory[course.admin].avatar }\">\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n      <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n    `;\r\n\r\n    if(!course.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  course_nav: (element) => {\r\n\r\n   let course = root.courses.memory[element.dataset.key];\r\n\r\n   return `<div class=\"course-nav\">\r\n        ${ course.published_at ? '<span class=\"published\">PUBLISHED</span>' : '<span class=\"unpublished\">UNPUBLISHED</span>' }<br>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"courses.view\" data-load=\"labels.view\"></a>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"courses.invite\" data-load=\"labels.invite\"></a>\r\n        <a data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"courses.stats\" data-load=\"labels.stats_short\"></a>\r\n      </div>`;\r\n      \r\n  },\r\n\r\n  view: (element) => {\r\n\r\n    root.sessions.url({ page: 'edit', course: element.dataset.key });\r\n\r\n    root.sessions.load_page(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n\r\n  invite: (element) => {\r\n\r\n    let course = root.courses.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.invite\"></h3>\r\n        ${ courses.course_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n        <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n  \r\n  stats: (element) => {\r\n    \r\n    let course = root.courses.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ course.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.stats\"></h3>\r\n        ${ courses.course_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-course=\"${ course.key }\" data-input=\"courses.edit\" type=\"text\" value=\"${ course.name }\">\r\n        <span data-load=\"users.memory.${ course.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n    \r\n  }\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!courses.updated) return setTimeout(updater, 300);\r\n\r\n  courses.updated = false;\r\n\r\n  courses.list();\r\n\r\n  updater();\r\n\r\n}());","let sessions = module.exports = {\r\n\r\n  default_page: 'landing',\r\n\r\n  memory: {},\r\n  \r\n  load: function load(){\r\n\r\n    root.main = document.querySelector('main');\r\n\r\n    if(!root.main) return setTimeout(load, 0);\r\n    \r\n    sessions.url(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n  load_login: (element) => {\r\n\r\n    if(!root.me.session) return;\r\n\r\n    sessions.url('/courses');\r\n\r\n    sessions.load_page(null, { prevent_url: true });\r\n\r\n  },\r\n\r\n  sign_in: (element) => {\r\n\r\n    root.send({\r\n      request: 'sign_in',\r\n      email: element.parentElement.querySelector('[type=\"email\"]').value || '',\r\n      password: element.parentElement.querySelector('[type=\"password\"]').value || '',\r\n    }, () => {\r\n\r\n      sessions.url('/courses');\r\n\r\n      sessions.load_page(null, { prevent_url: true });\r\n\r\n    });\r\n  \t\r\n  },\r\n\r\n  sign_out: (element) => {\r\n\r\n    root.send({ request: 'sign_out' });\r\n\r\n  },\r\n\r\n  check_passwords: (element) => {\r\n\r\n    let inputs = root.main.querySelectorAll('input[type=\"password\"]');\r\n\r\n    if(inputs[0].value != inputs[1].value) return alert('not equal');\r\n\r\n    root.send({\r\n      request: 'set_password',\r\n      old_password: inputs[0].value,\r\n      password: inputs[2].value || ''\r\n    }, (res) => {\r\n\r\n   \r\n\r\n    });\r\n\r\n  },\r\n\r\n  load_page: (elem, options) => {\r\n\r\n    if(!root.main) return setTimeout(root.main, 0, elem, options);\r\n\r\n    let page = elem ? elem.dataset.page : history.state ? history.state.page : 'landing';\r\n\r\n    if(!localStorage.getItem('authenticated') && ['landing', 'login', 'about'].indexOf(page) == -1) {\r\n      page = 'landing';\r\n    }\r\n\r\n    document.body.classList.forEach((c) => {\r\n\r\n      if(c.indexOf('-page') == -1) return;\r\n\r\n      document.body.classList.remove(c);\r\n\r\n    });\r\n\r\n    document.body.classList.remove('notified');\r\n\r\n    document.body.classList.add(page + '-page');\r\n    \r\n    root.main.dataset.load = page + '.html';\r\n\r\n    if(!options || !options.prevent_url) sessions.url('/' + page);\r\n\r\n    window.scrollTo(0, 0);\r\n\r\n    root.modal.close();\r\n\r\n  },\r\n\r\n  url: (state, options) => {\r\n\r\n    let operation = options && options.replace ? 'replaceState' : 'pushState';\r\n\r\n    let url = typeof state == 'string' ? decode() : location.pathname;\r\n\r\n    return history[operation](state ? state : decode(), options ? options.title : document.title, state ? encode() : pathname);\r\n\r\n    function encode() {\r\n\r\n      let page = state ? state.page || sessions.default_page : sessions.default_page;\r\n\r\n      return Object.keys(state).reduce((url,key)=>{\r\n\r\n        if (key == 'page') return url;\r\n\r\n        return `${url}/${key}/${ state[key] }`;\r\n\r\n      }\r\n      , `/${ page == sessions.default_page ? '' : page }`);\r\n\r\n    }\r\n\r\n    function decode() {\r\n\r\n      let parts = (state || location.pathname).split(/\\//g);\r\n\r\n      state = {};\r\n\r\n      for (let i = 0; i < parts.length; i += 2) {\r\n\r\n        state[parts[i] || 'page'] = parts[i + 1];\r\n\r\n      }\r\n\r\n      state.page = state.page || sessions.default_page;\r\n      \r\n      return state;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};","module.exports = {\r\n\r\n  change_language: (element) => {\r\n\r\n\tlocalStorage.setItem('language', element.dataset.language);\r\n\r\n\tlocation.reload();\r\n\r\n  },\r\n\r\n  highlight_lang: (element) => {\r\n\r\n  \tif(!element.classList.contains(localStorage.getItem('language') || 'nl')) return;\r\n\r\n  \telement.classList.add('active');\r\n  \t\r\n  },\r\n\r\n  format_date: (element) => {\r\n\r\n  \tlet date = new Date(element.dataset.date),\r\n\t\tmonths = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n\tif (!date || String(date).toLowerCase() == 'invalid date') return;\r\n\r\n\telement.innerHTML = `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;\r\n\r\n  },\r\n\r\n  format_time: (element) => {\r\n\r\n  \tlet date = new Date(element.dataset.date);\r\n\r\n\tif (!date || String(date).toLowerCase() == 'invalid date') return;\r\n\r\n  \telement.innerHTML = `${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }`;\r\n\r\n  },\r\n\r\n  start: (element) => {\r\n\r\n\tconsole.log('e', element);\r\n  \t\r\n  },\r\n\r\n  hide_notification: (element) => {\r\n  \t\r\n  \tdocument.querySelector('body').classList.remove('notified');\r\n\r\n  }\r\n\r\n};","let tickets = module.exports = {\r\n\r\n  // here we save all tickets in client memory\r\n  // { [key]: OBJECT }\r\n  memory: {},\r\n\r\n  // button is placed to the right of the title of the page\r\n  add: (element) => {\r\n\r\n    // root.send is used to talk to the server\r\n    root.send({ request: 'new_ticket' });\r\n\r\n  },\r\n\r\n  // anytime the user triggers the data-input of the search field, we execute this\r\n  save_search: (element) => {\r\n\r\n    // used inside of tickets.render()\r\n\ttickets.search_query = String(element.value || '').toLowerCase();\r\n\r\n    // see update loop at the bottom of this file\r\n\ttickets.updated = true;\r\n\r\n  },\r\n\r\n  // goes off anytime ticket-related data-input is fired\r\n  edit: (element, options) => {\r\n\r\n    // we always need to provide a request string and the key of the object we are editing\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.ticket\r\n     };\r\n\r\n     // but the value we are changing shall be added dynamically,\r\n     // so we can use this edit function straight from the HTML\r\n     // <input data-input=\"tickets.edit\" data-key=\"[KEY]\">\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     // options.callback can only be used when this function is fired manually in Javascript\r\n     // since we cannot write a function inside of the HTML tag\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n\r\n  list: (element) => {\r\n\r\n    // we are lazy developers that do not want to select the list over and over\r\n    // whenever we use this list function manually\r\n    if(!element) element = document.querySelector('[data-load=\"tickets.list\"]');\r\n\r\n    // element still not found?! we must stop this madness\r\n    if(!element) return;\r\n    \r\n    // we clean out the old HTML should this function be fired after the list already rendered\r\n    element.innerHTML = ``;\r\n\r\n    // we show a loading text\r\n    root.labels.loading(element);\r\n\r\n    // and start the render loop!\r\n    tickets.render(element);\r\n\r\n  },\r\n\r\n\r\n  render: (element, keys, iteration) => {\r\n\r\n    // maybe the user navigated away? Somehow the element is gone, RIP loop :'(\r\n    if(!element) return;\r\n\r\n    // we need to make sure we only run 1 loop at the same time\r\n    // every time render is called outside of its own loop, iteration will be undefined\r\n    // so we use this condition to also update the dataset of the element\r\n    // in order for the old loop to kill itself...\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    // if it turns out this execution is an outdated iteration,\r\n    // the element has updated its dataset.iteration outside of this loop\r\n    // we have to bring this loop to the white shores\r\n    // I offer this line of comment in dedication to the loop whos life will be cut before the natural end\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    // every time render is called outside of its own loop, keys will be undefined\r\n    if(!keys) keys = Object.keys(tickets.memory);\r\n\r\n    // the loop has finished\r\n    if(!keys.length) {\r\n\r\n        // sadly, no children are found inside of the element\r\n        // this can only mean there were no results\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        // we had results, and are no longer loading, so lets clear that loading message\r\n        return element.dataset.message = '';\r\n\r\n    }\r\n\r\n    let search = tickets.search_query, // search value is changed by tickets.save_search()\r\n        ticket = tickets.memory[keys.shift()];\r\n\r\n    if(!ticket || ticket.archived ||\r\n      (search && String(ticket.name).toLowerCase().indexOf(search) == -1) ||\r\n      (tickets.manager_filter.length && tickets.manager_filter.indexOf(ticket.admin) == -1)\r\n    ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         tickets.render(element, keys, iteration);\r\n\r\n       });\r\n\r\n       return tickets.render(element, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      tickets.render(element, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'tickets.render_one';\r\n\r\n    elem.dataset.ticket = ticket.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  archive: (element) => {\r\n\r\n    let ticket = tickets.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: ticket.key }, () => {\r\n\r\n      // see update loop at the bottom of this file\r\n      tickets.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  manager_filter: [],\r\n\r\n  toggle_course: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        filter = tickets.manager_filter,\r\n        index = filter.indexOf(key);\r\n\r\n    element.classList.toggle('active');\r\n\r\n    if(index > -1) filter.splice(index, 1);\r\n\r\n    else filter.push(key);\r\n\r\n    tickets.updated = true;\r\n\r\n  },\r\n\r\n  load_courses: (element) => {\r\n\r\n    element.innerHTML = Object.keys(root.courses.memory).reduce((html, key) => {\r\n\r\n      return html + `<div data-click=\"tickets.toggle_course\" data-key=\"${ key }\">\r\n        <span data-load=\"courses.memory.${ key }.name\"></span>\r\n      </div>`;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n\r\n    let ticket = tickets.memory[element.dataset.ticket];\r\n\r\n    element.dataset.key = element.dataset.ticket;\r\n\r\n    element.innerHTML = tickets.mode == 'lists' ? `\r\n      <span data-load=\"tickets.memory.${ element.dataset.key }.name\"></span>\r\n      <pre>${ JSON.stringify(ticket, null, 2) }</pre>\r\n    ` : `\r\n      <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n      ${ tickets.ticket_nav(element) }\r\n      <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n      <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n    `;\r\n\r\n    if(!ticket.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  ticket_nav: (element) => {\r\n\r\n   return `<div>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.view\" data-load=\"labels.view\"></button>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.invite\" data-load=\"labels.invite\"></button>\r\n        <button data-key=\"${ element.dataset.key }\" data-click=\"modal.open\" data-modal=\"tickets.stats\" data-load=\"labels.stats_short\"></button>\r\n      </div>`;\r\n      \r\n  },\r\n\r\n  view: (element) => {\r\n\r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.view\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n\r\n\r\n  invite: (element) => {\r\n\r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.invite\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n\r\n  },\r\n  \r\n  stats: (element) => {\r\n    \r\n    let ticket = root.tickets.memory[element.dataset.key];\r\n\r\n    element.innerHTML = `<div class=\"modal\">\r\n      <i class=\"fa fa-times close-modal\" data-click=\"modal.close\"></i>\r\n      <div class=\"content\">\r\n        <div class=\"thumbnail\" style=\"background-image:url(${ ticket.thumbnail })\"></div>\r\n        <h3 data-load=\"labels.stats\"></h3>\r\n        ${ tickets.ticket_nav(element) }\r\n        <input placeholder=\"Naam\" data-property=\"name\" data-ticket=\"${ ticket.key }\" data-input=\"tickets.edit\" type=\"text\" value=\"${ ticket.name }\">\r\n        <span data-load=\"users.memory.${ ticket.admin }.name\"></span>\r\n      </div>\r\n    </div>`;\r\n    \r\n  }\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!tickets.updated) return setTimeout(updater, 300);\r\n\r\n  tickets.updated = false;\r\n\r\n  tickets.list();\r\n\r\n  updater();\r\n\r\n}());","let users = module.exports = {\r\n\r\n  memory: {},\r\n\r\n  add: (element) => {\r\n\r\n    root.send({ request: 'new_user' });\r\n\r\n  },\r\n  \r\n  load_permissions: (element) => {\r\n\r\n    element.innerHTML = `\r\n      <label class=\"dark-grey\" data-load=\"labels.permissions\"></label><br>\r\n\r\n      <div class=\"row\">\r\n        <input id=\"add\" data-load=\"users.load_permission\" data-change=\"users.update_permission\" type=\"checkbox\">\r\n        <label for=\"add\" class=\"task fa fa-user-plus\"></label>\r\n        <input disabled type=\"text\" value=\"ADMIN\">\r\n      </div>\r\n\r\n     ${ users.render_tasks() }\r\n      `;\r\n    \r\n  },\r\n\r\n  render_tasks: () => {\r\n\r\n    let user = users.memory[root.me.user];\r\n\r\n    return user.tasks.reduce((memo, task, index) => {\r\n\r\n      memo += `\r\n      <div class=\"row\">\r\n        ${ task ? `<input id=\"task-${ index }\" data-load=\"users.load_permission\" data-change=\"users.update_permission\" type=\"checkbox\">` : '' }\r\n        <label for=\"task-${ index + 1 }\" class=\"task task-${ index + 1 }\">${ index + 1 }</label>\r\n        <input placeholder=\"NIEUW\" data-index=\"${ index }\" data-input=\"users.update_task\" type=\"text\" value=\"${ task }\">\r\n      </div>`;\r\n\r\n      return memo;\r\n\r\n    }, '');\r\n\r\n  },\r\n\r\n  load_permission: (input) => {\r\n\r\n    if(\r\n    (input.id == 'add' && root.me.add_permission) ||\r\n    (input.id == 'archive' && root.me.archive_permission) ||\r\n    root.me.tasks[parseInt(input.id.replace('task-', ''), 10)]\r\n    ) input.setAttribute('checked', true);\r\n\r\n  },\r\n\r\n  update_permission: (input) => {\r\n\r\n    if(input.id == 'add') return root.send({ request: 'update_permission', add_permission: input.checked });\r\n\r\n    if(input.id == 'archive') return root.send({ request: 'update_permission', archive_permission: input.checked });\r\n\r\n    let tasks = users.memory[root.me.user].tasks.map((task, index) => {\r\n\r\n      if(index == parseInt(input.id.replace('task-', ''), 10)) return input.checked ? task : '';\r\n\r\n      return root.me.tasks[index] ? task : '';\r\n\r\n    });\r\n\r\n    tasks.pop();\r\n\r\n    root.send({ request: 'update_permission', tasks: tasks });\r\n\r\n  },\r\n\r\n  update_task: (element) => {\r\n\r\n   let index = element.dataset.index,\r\n       tasks = users.memory.users_admin.tasks.slice();\r\n\r\n    tasks[parseInt(element.dataset.index, 10)] = element.value;\r\n\r\n    let update = tasks.reduce((memo, task) => {\r\n\r\n      if(!task) return memo;\r\n\r\n      memo.push(String(task).toUpperCase());\r\n\r\n      return memo;\r\n\r\n    }, []);\r\n\r\n    update.push('');\r\n\r\n    root.send({ request: 'update_tasks', tasks: update }, (user) => {\r\n\r\n      if(tasks.length == update.length) return;\r\n      \r\n      let elem = document.querySelector('[data-load=\"users.load_permissions\"]');\r\n\r\n      users.load_permissions(elem);\r\n\r\n        let input = document.querySelector(`[data-index=\"${ index }\"]`)\r\n\r\n        input.focus();\r\n        \r\n        input.selectionStart = input.selectionEnd = input.value.length;\r\n\r\n    });\r\n\r\n  },\r\n\r\n  save_email: (input) => {\r\n\r\n    localStorage.setItem('remember_email', input.value);\r\n\r\n  },\r\n\r\n  load_email: (input) => {\r\n\r\n    input.value = localStorage.getItem('remember_email') || '';\r\n\r\n    input.focus();\r\n\r\n  },\r\n\r\n\r\n  list: (element) => {\r\n\r\n    if(!element) return;\r\n\r\n    element.innerHTML = ``;\r\n\r\n    root.labels.loading(element);\r\n\r\n    requestAnimationFrame(()=> {\r\n\r\n      let search = String(localStorage.getItem('search') || '').toLowerCase();\r\n\r\n      users.render(element, search);\r\n\r\n    });\r\n\r\n  },\r\n\r\n\r\n  render: (element, search, keys, iteration) => {\r\n\r\n    if(!element) return;\r\n\r\n    if(!iteration) iteration = element.dataset.iteration = 'i' + Math.floor(Math.random() * 1000);\r\n\r\n    if(element.dataset.iteration != iteration) return;\r\n\r\n    keys = keys || Object.keys(users.memory);\r\n\r\n    if(!keys.length) {\r\n\r\n        if(!element.children.length) return root.labels.no_results(element);\r\n\r\n        return element.dataset.title = '';\r\n\r\n    }\r\n\r\n    let user = users.memory[keys.shift()];\r\n\r\n    if(!user || user.archived ||\r\n       (search && String(user.name).toLowerCase().indexOf(search) == -1)\r\n     ) {\r\n\r\n       if(keys.length % 100 == 0) return requestAnimationFrame(()=> {\r\n\r\n         users.render(element, search, keys, iteration);\r\n\r\n       });\r\n\r\n       return users.render(element, search, keys, iteration);\r\n\r\n     }\r\n\r\n     requestAnimationFrame(()=> {\r\n\r\n      users.render(element, search, keys, iteration);\r\n\r\n    });\r\n\r\n    let elem = document.createElement('div');\r\n\r\n    elem.dataset.load = 'users.render_one';\r\n\r\n    elem.dataset.user = user.key;\r\n\r\n    element.appendChild(elem);\r\n\r\n  },\r\n\r\n  edit: (element, options) => {\r\n\r\n    let request = {\r\n       request: 'edit',\r\n       key: element.dataset.user\r\n     };\r\n\r\n     let v = options ? options.value : element.value;\r\n\r\n     request[element.dataset.property] = v;\r\n\r\n     root.send(request, options ? options.callback : null);\r\n\r\n  },\r\n  \r\n  archive: (element) => {\r\n\r\n    let user = users.memory[element.dataset.key];\r\n\r\n    root.send({ request: 'archive', key: user.key }, () => {\r\n\r\n      users.updated = true;\r\n      \r\n    });\r\n\r\n  },\r\n\r\n  render_one: (element) => {\r\n\r\n    let user = users.memory[element.dataset.user];\r\n\r\n    let tasks = users.memory[root.me.user].tasks.reduce((html, task, index) => {\r\n\r\n      if(task) html += `<div data-index=\"${ index }\" data-user=\"${ user.key }\" data-click=\"users.toggle_task\" class=\"small\">${ task }</div>`;\r\n\r\n      return html;\r\n\r\n    }, '');\r\n\r\n    element.innerHTML = `\r\n      <div>\r\n        <input placeholder=\"Name\" data-property=\"name\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"text\" value=\"${ user.name || '' }\">\r\n      </div>\r\n      <div>\r\n        <input placeholder=\"example@email.com\" data-property=\"email\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"text\" value=\"${ user.email || '' }\">\r\n      </div>\r\n      <div>\r\n        <input placeholder=\"Password\" data-property=\"password\" data-user=\"${ user.key }\" data-input=\"users.edit\" type=\"password\">\r\n      </div>\r\n      <div>\r\n        <select data-property=\"role\" value=\"${ user.role }\" data-user=\"${ user.key }\" data-change=\"users.edit\">\r\n          <option${ user.role == 'intern' ? ' selected' : '' } value=\"intern\">Intern</option>\r\n          <option${ user.role == 'driver' ? ' selected' : '' } value=\"driver\">Chauffeur</option>\r\n          <option${ user.role == 'admin' ? ' selected' : '' } value=\"admin\">Admin</option>\r\n        </select>\r\n      </div>\r\n      <div>\r\n        <button data-click=\"users.archive\" data-key=\"${ user.key }\">ARCHIVEER</button>\r\n      </div>\r\n    `;\r\n\r\n    if(!user.name) element.querySelector('input').focus();\r\n\r\n    function format(date) {\r\n\r\n      date = new Date(date);\r\n\r\n      let months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\r\n\r\n      if (!date || String(date).toLowerCase() == 'invalid date') return '';\r\n\r\n      return `\r\n        ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}\r\n        ${ date.getHours() }:${ String(date.getMinutes()).length > 1 ? '' : 0 }${ date.getMinutes() }\r\n      `;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  save_search: (element) => {\r\n\r\n\tlocalStorage.setItem('search', element.value);\r\n\r\n\tusers.updated = true;\r\n\r\n  }\r\n\r\n  \r\n};\r\n\r\n(function updater(){\r\n\r\n  if(!users.updated) return setTimeout(updater, 300);\r\n\r\n  users.updated = false;\r\n\r\n  // updater();\r\n\r\n}());","let editor = module.exports = {\n\n  load_course: (element) => {\n\n    let key = history.state.course,\n        course = root.courses.memory[key];\n\n    console.log(course);\n\n  }\n\n};","const LANGS = ['nl', 'en'];\r\n\r\nlet index = LANGS.indexOf(localStorage.getItem('language'));\r\n\r\nif(index == -1) index = 0;\r\n\r\nlet labels = {\r\n  landing: ['Welkom', 'Landing'],\r\n  introduction_text: ['Persoonlijke Training & Persoonlijke Coaching', 'Personal Training & Personal Coaching'],\r\n  introduction_description: ['voor het programma Managers Vitality (for a life - work balance that boosts management performance)', 'Program Managers Vitality (for a life - work balance that boosts management performance.)'],\r\n  about_text: ['Mogen wij uw personal trainer of personal coach zijn?', 'Can we be your personal trainer or personal coach?'],\r\n  add: ['Toevoegen', 'Add'],\r\n  invite: ['Uitnodigen', 'Invite'],\r\n  about: ['Over ons', 'About'],\r\n  sign_in: ['Inloggen', 'Sign in'],\r\n  sign_in_input: [value('Inloggen', value('Sign in'))],\r\n  sign_out: ['Uitloggen', 'Sign out'],\r\n  courses: ['Cursussen', 'Courses'],\r\n  profile: ['Profiel', 'Profile'],\r\n  invitations: ['Uitnodigingen', 'Invitations'],\r\n  stats: ['Statistieken', 'Statistics'],\r\n  no_results: [\r\n    title('Geen resultaten'),\r\n    title('No results')\r\n  ],\r\n  loading: [\r\n    title('Laden...'),\r\n    title('Loading...')\r\n  ],\r\n  archive: ['Archiveer', 'Archive'],\r\n  view: ['Bekijk', 'View'],\r\n  view_mode: ['VIEW MODE', 'VIEW MODE'],\r\n  search: ['ZOEKEN', 'SEARCH'],\r\n  managers: ['MANAGERS', 'MANAGERS'],\r\n  edit: ['Aanpassen', 'Edit'],\r\n  stats_short: ['Stats', 'Stats'],\r\n  copy: ['Kopi&#xEB;ren', 'Copy'],\r\n  viewed: ['Bekeken:', 'Viewed:'],\r\n  published: ['Gepubliceerd', 'Published'],\r\n  unpublished: ['Niet Gepubliceerd', 'Unpublished'],\r\n  password: ['WACHTWOORD', 'PASSWORD'],\r\n  edit_password: ['WACHTWOORD WIJZIGEN', 'CHANGE PASSWORD'],\r\n  old_password: [placeholder('oud wachtwoord'), placeholder('old password')],\r\n  new_password: [placeholder('nieuw wachtwoord'), placeholder('new password')],\r\n  placeholder_search: [placeholder('Zoeken'), placeholder('Search')]\r\n};\r\n\r\nfor(let n in labels) {\r\n\r\n  if(!labels.hasOwnProperty(n)) continue;\r\n\r\n  if(labels[n] == false) labels[n] = n;\r\n\r\n  else labels[n] = labels[n][index];\r\n\r\n}\r\n\r\nmodule.exports = labels;\r\n\r\nfunction placeholder(label){\r\n\r\n  return (el) => el.setAttribute('placeholder', label);\r\n\r\n}\r\n\r\nfunction title(label){\r\n\r\n  return (el) => el.setAttribute('data-title', label);\r\n\r\n}\r\n\r\nfunction value(label){\r\n\r\n  return (el) => el.setAttribute('data-value', label);\r\n\r\n}","let modal = module.exports = {\r\n\r\n  load: (element) => {\r\n\r\n\troot.modal_element = element;\r\n\r\n  },\r\n\r\n  open: (element, load) => {\r\n\r\n\tlet modal = root.modal_element;\r\n\r\n\tif(modal.dataset.key) modal.dataset.key = element.dataset.key;\r\n\r\n\t\r\n\r\n\tif(!document.body.classList.contains('modal-open'))\r\n\t\troot.main.style.transform = `translateY(-${ window.scrollY || document.body.scrollTop }px)`;\r\n\r\n\tscroll(0,0);\r\n\r\n\tmodal.dataset.load = element.dataset.modal;\r\n\r\n\trequestAnimationFrame(()=>document.body.classList.add('modal-open'))\r\n\r\n  },\r\n\r\n  close: (element) => {\r\n\r\n\tlet scrolltop = parseInt(root.main.style.transform.replace('translateY(', ''), 10);\r\n\r\n\tdocument.body.classList.remove('modal-open');\r\n\r\n\troot.main.removeAttribute('style');\r\n\r\n\troot.modal_element.load = \"modal.empty\";\r\n\r\n\twindow.scroll(0, -1 * scrolltop);\r\n\r\n  },\r\n\r\n  empty: ''\r\n\r\n};","let prefill = module.exports = {\r\n\r\n  memory: {},\r\n\r\n  load: (element) => {\r\n\r\n    element.dataset.input = 'prefill.edit';\r\n\r\n    if(!element.dataset.key) return;\r\n\r\n    let key = element.dataset.key,\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n\r\n    if(!item[element.dataset.property]) return;\r\n\r\n    let property_key = item[element.dataset.property],\r\n        property_collection = property_key.split('_')[0];\r\n\r\n    if(!root[property_collection]) return;\r\n\r\n    let property = root[property_collection].memory[property_key];\r\n\r\n    element.value = property.name;\r\n\r\n  },\r\n\r\n  select: (element) => {\r\n\r\n    let key = element.dataset.key,\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n    \r\n    let input = element.parentElement.parentElement.querySelector('input');\r\n\r\n    input.value = item.name;\r\n\r\n    let input_collection = input.dataset.key.split('_')[0];\r\n\r\n    element.parentElement.innerHTML = '';\r\n\r\n    let request = {\r\n       request: 'edit',\r\n       key: input.dataset.key\r\n     };\r\n\r\n     request[input.dataset.property] = item.key;\r\n\r\n     root.send(request);\r\n\r\n  },\r\n\r\n  submit: (element) => {\r\n\r\n    let selection = element.querySelector('li');\r\n\r\n    if(selection) prefill.select(selection);\r\n\r\n  },\r\n\r\n  edit: function search(element, keys) {\r\n\r\n    let ul = element.parentElement.querySelector('ul');\r\n\r\n    if(!keys) ul.innerHTML = '';\r\n\r\n    keys = keys || Object.keys(root[element.dataset.collection].memory);\r\n\r\n    if(prefill.loop && prefill.loop > keys.length) return; // new loop started, this one stops\r\n\r\n    prefill.loop = keys.length - 1;\r\n\r\n    if(!keys.length || !element.value) return; // done looping\r\n\r\n    let key = keys.shift(),\r\n        collection = key.split('_')[0],\r\n        item = root[collection].memory[key];\r\n\r\n    if(String(item.name || '').toLowerCase().indexOf(String(element.value).toLowerCase()) == -1)\r\n      return search(element, keys);\r\n\r\n    requestAnimationFrame(()=>search(element, keys));\r\n\r\n    ul.innerHTML += `<li data-click=\"prefill.select\" data-key=\"${ item.key }\">${ item.name }</li>`\r\n\r\n  }\r\n\r\n};","let updates = [];\r\n\r\nmodule.exports = init;\r\n\r\nfunction init() {\r\n\r\n  bind();\r\n\r\n  document.documentElement.addEventListener('click', listener);\r\n\r\n  document.documentElement.addEventListener('change', listener);\r\n\r\n  document.documentElement.addEventListener('input', listener);\r\n\r\n  document.documentElement.addEventListener('submit', listener);\r\n\r\n}\r\n\r\nfunction listener(e, element) {\r\n\r\n  element = element || e.target;\r\n\r\n  if(e.type.toLowerCase() == 'submit') e.preventDefault();\r\n\r\n  if (!element.dataset || !element.dataset[e.type]) {\r\n\r\n    if(!element.parentElement) return;\r\n\r\n    return listener(e, element.parentElement);\r\n\r\n  }\r\n\r\n  let target = root;\r\n\r\n  for (let i = 0, parts = element.dataset[e.type].split('.'); i < parts.length; i++) {\r\n\r\n    if (!target) return console.error(element.dataset[e.type] || e.type, 'does not exist');\r\n\r\n    target = target[parts[i]];\r\n\r\n  }\r\n\r\n  if(typeof target == 'string') return element.innerHTML = target;\r\n  \r\n  if(typeof target != 'function') return console.error(element.dataset[e.type] || e.type, 'does not exist');\r\n\r\n  target(element);\r\n\r\n}\r\n\r\nfunction bind() {\r\n\r\n  (function loop(){\r\n\r\n    if(!updates.length) return requestAnimationFrame(loop);\r\n\r\n    let elements = updates.splice(0, updates.length);\r\n\r\n    for(let i = 0; i < elements.length; i++) {\r\n\r\n      [].map.call(elements[i].querySelectorAll('[data-bind], [data-load]'), bind_one);\r\n\r\n    }\r\n\r\n    requestAnimationFrame(loop);\r\n\r\n  }());\r\n\r\n  new MutationObserver(observer).observe(\r\n    document.documentElement,\r\n    {\r\n      attributes: true,\r\n      subtree: true,\r\n      childList: true,\r\n      characterData: true\r\n    }\r\n  );\r\n\r\n}\r\n\r\nfunction observer(mutations) {\r\n\r\n  for(let i = 0; i < mutations.length; i++) {\r\n\r\n    if(mutations[i].type == 'attributes') {\r\n\r\n       if(mutations[i].attributeName == 'data-load') load(mutations[i].target);\r\n\r\n       continue;\r\n\r\n    }\r\n\r\n    if(mutations[i].type != 'childList') return;\r\n\r\n    if(updates.indexOf(mutations[i].target) == -1) updates.push(mutations[i].target);\r\n\r\n  }\r\n\r\n}\r\n\r\nfunction bind_one(element) {\r\n\r\n  let d = element.dataset,\r\n      key = d.bind == 'me' ? root.config.user : d.bind,\r\n      collection;\r\n\r\n  if(d.load) return load(element);\r\n\r\n  if(!key) return collection.error(d);\r\n\r\n  collection = root[key.split('_').slice(0, -1).join('_')];\r\n\r\n  if (!collection || !collection.memory[key]) return console.error(key);\r\n\r\n  let prop = d.value || d.text || d.bg || d.html,\r\n      obj = collection.memory[key];\r\n\r\n  if(d.value) element.value = obj[d.value] || '';\r\n\r\n  if(d.html) element.innerHTML = obj[d.html] || '';\r\n\r\n  if(d.text) element.innerHTML = (obj[d.text] || '').replace(/(>|<)/g, escape);\r\n\r\n  if(d.bg) element.style.backgroundImage = `url(\"${ obj[d.bg] || '' }`;\r\n\r\n}\r\n\r\nfunction load(element) {\r\n\r\n  let target = root;\r\n\r\n  for (let i = 0, parts = element.dataset.load.split('.'); i < parts.length; i++) {\r\n\r\n    target = target[parts[i]];\r\n\r\n    if (typeof target == 'undefined') {\r\n\r\n      if(element.dataset.load.indexOf('.html') != -1) return load_file(element);\r\n\r\n      return console.error(element.dataset.load, 'does not exist');\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if(element.dataset.load.substring(0, 11) == 'labels.user') {\r\n\r\n    let user = root.users.memory[root.config.user],\r\n        str = element.dataset.load;\r\n    \r\n    str = str.substring(12);\r\n\r\n    if(user && typeof(str) == 'string' && user[str]) return element.value = user[str];\r\n\r\n  }\r\n\r\n  if(typeof target == 'string') return element.innerHTML = target;\r\n\r\n  if(typeof target == 'function') return target(element);\r\n\r\n}\r\n\r\nfunction load_file(element) {\r\n\r\n  let xhr = new XMLHttpRequest();\r\n\r\n  xhr.open('GET', `/${ element.dataset.load }`, true);\r\n\r\n  xhr.onreadystatechange = function(e) {\r\n\r\n    if (this.readyState != 4 || this.status != 200) return;\r\n\r\n    root.templates = root.templates || {};\r\n\r\n    let target = root.templates;\r\n\r\n    for (let i = 0, parts = element.dataset.load.split('.'); i + 1 < parts.length; i++) {\r\n\r\n      if (!target) return;\r\n\r\n      target[parts[i]] = target[parts[i]] || {};\r\n\r\n      target = target[parts[i]];\r\n\r\n    }\r\n\r\n    element.innerHTML = target.html = this.responseText;\r\n\r\n  }\r\n\r\n  xhr.send();\r\n\r\n\r\n}\r\n\r\nfunction escape(match) {\r\n\r\n  return match == '>' ? '&gt;' : '&lt;';\r\n\r\n}","if (!Object.assign) {\r\n  Object.defineProperty(Object, 'assign', {\r\n    enumerable: false,\r\n    configurable: true,\r\n    writable: true,\r\n    value: function(target) {\r\n      'use strict';\r\n      if (target === undefined || target === null) {\r\n        throw new TypeError('Cannot convert first argument to object');\r\n      }\r\n\r\n      var to = Object(target);\r\n      for (var i = 1; i < arguments.length; i++) {\r\n        var nextSource = arguments[i];\r\n        if (nextSource === undefined || nextSource === null) {\r\n          continue;\r\n        }\r\n        nextSource = Object(nextSource);\r\n\r\n        var keysArray = Object.keys(Object(nextSource));\r\n        for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n          var nextKey = keysArray[nextIndex];\r\n          var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\r\n          if (desc !== undefined && desc.enumerable) {\r\n            to[nextKey] = nextSource[nextKey];\r\n          }\r\n        }\r\n      }\r\n      return to;\r\n    }\r\n  });\r\n}\r\n\r\n(function () {\r\n\r\n  if (typeof window.Element === \"undefined\" || \"classList\" in document.documentElement) return;\r\n\r\n  var prototype = Array.prototype,\r\n      push = prototype.push,\r\n      splice = prototype.splice,\r\n      join = prototype.join;\r\n\r\n  function DOMTokenList(el) {\r\n    this.el = el;\r\n    // The className needs to be trimmed and split on whitespace\r\n    // to retrieve a list of classes.\r\n    var classes = el.className.replace(/^\\s+|\\s+$/g,'').split(/\\s+/);\r\n    for (var i = 0; i < classes.length; i++) {\r\n      push.call(this, classes[i]);\r\n    }\r\n  };\r\n\r\n  DOMTokenList.prototype = {\r\n    add: function(token) {\r\n      if(this.contains(token)) return;\r\n      push.call(this, token);\r\n      this.el.className = this.toString();\r\n    },\r\n    contains: function(token) {\r\n      return this.el.className.indexOf(token) != -1;\r\n    },\r\n    item: function(index) {\r\n      return this[index] || null;\r\n    },\r\n    remove: function(token) {\r\n      if (!this.contains(token)) return;\r\n      for (var i = 0; i < this.length; i++) {\r\n        if (this[i] == token) break;\r\n      }\r\n      splice.call(this, i, 1);\r\n      this.el.className = this.toString();\r\n    },\r\n    toString: function() {\r\n      return join.call(this, ' ');\r\n    },\r\n    toggle: function(token) {\r\n      if (!this.contains(token)) {\r\n        this.add(token);\r\n      } else {\r\n        this.remove(token);\r\n      }\r\n\r\n      return this.contains(token);\r\n    }\r\n  };\r\n\r\n  window.DOMTokenList = DOMTokenList;\r\n\r\n  function defineElementGetter (obj, prop, getter) {\r\n      if (Object.defineProperty) {\r\n          Object.defineProperty(obj, prop,{\r\n              get : getter\r\n          });\r\n      } else {\r\n          obj.__defineGetter__(prop, getter);\r\n      }\r\n  }\r\n\r\n  defineElementGetter(Element.prototype, 'classList', function () {\r\n    return new DOMTokenList(this);\r\n  });\r\n\r\n})();\r\n\r\n","require('./polyfill.js');\r\n\r\nconst DEV_MODE = true;\r\n\r\nwindow.root = {\r\n\r\n  config: init(),\r\n\r\n  incoming: incoming,\r\n  \r\n  templates: require('./collections/templates.js'),\r\n  \r\n  courses: require('./collections/courses.js'),\r\n  \r\n  blocks: require('./collections/blocks.js'),\r\n\r\n  sessions: require('./collections/sessions.js'),\r\n\r\n  labels: require('./components/labels.js'),\r\n  \r\n  modal: require('./components/modal.js'),\r\n\r\n  editor: require('./components/editor.js'),\r\n  \r\n  prefill: require('./components/prefill.js'),\r\n\r\n  tickets: require('./collections/tickets.js'),\r\n\r\n  users: require('./collections/users.js')\r\n\r\n};\r\n\r\nfunction init(){\r\n\r\n  require('./listeners.js')();\r\n\r\n  requestAnimationFrame(()=> {\r\n\r\n\troot.sessions.load();\r\n\r\n\tcreate_websocket();\r\n\r\n  });\r\n\r\n  return {\r\n    user: '',\r\n    session: '',\r\n    error: error,\r\n    query: location.search.slice(1).split('&').reduce((memo, pair) => {\r\n\r\n\t  let p = pair.split('=');\r\n\r\n\t  memo[p[0]] = p[1];\r\n\r\n\t  return memo;\r\n\r\n\t}, {})\r\n  };\r\n\r\n}\r\n\r\nfunction create_websocket() {\r\n\r\n  let query = '',\r\n      callbacks = [];\r\n\r\n  for(let i in localStorage)\r\n    query += (query ? '&' : '?') + encodeURIComponent(i) + '=' +  encodeURIComponent(localStorage.getItem(i));\r\n\r\n  new WebSocket(DEV_MODE ?\r\n    `ws://localhost:443/${ query }` :\r\n    `wss://vitalityone.fearless-apps.com/${ query }`\r\n  ).addEventListener('message', function listener(e){\r\n\r\n    let ws = e.target;\r\n\r\n    root.send = Send(ws, callbacks);\r\n\r\n    incoming(JSON.parse(e.data), callbacks);\r\n\r\n    ws.removeEventListener('message', listener);\r\n\r\n    ws.addEventListener('message', (e) => incoming(JSON.parse(e.data), callbacks));\r\n\r\n  });\r\n\r\n}\r\n\r\nfunction error(element) {\r\n\r\n  if(element && element.dataset) return console.error(element.dataset.message);\r\n  \r\n  console.error(arguments);\r\n\r\n}\r\n\r\nfunction Send(ws, callbacks) {\r\n\r\n  return function send(data, callback) {\r\n\r\n    let cb = `cb_${ Math.floor(Math.random() * 10000) }`;\r\n\r\n    data.callback = cb;\r\n\r\n    if(callback) callbacks[cb] = callback;\r\n\r\n    ws.send(JSON.stringify(data));\r\n\r\n  };\r\n\r\n}\r\n\r\nfunction incoming(message, callbacks){\r\n\r\n  if(message instanceof Array) {\r\n\r\n  \tfor(let m in message) merge(message[m]);\r\n\r\n\treturn;\r\n\r\n  }\r\n\r\n  merge(message);\r\n  \r\n  if(message.error) notify(message);\r\n\r\n  if(message.redirect) location.href = message.redirect;\r\n\r\n  if(message.callback && callbacks[message.callback]) {\r\n\r\n  \tcallbacks[message.callback](message);\r\n\r\n  \tdelete callbacks[message.callback];\r\n  \t\r\n  }\r\n\r\n  if(typeof message.token == 'undefined') return;\r\n\r\n  root.me = Object.assign(root.me || {}, message);\r\n\r\n  document.body.classList[message.token ? 'add' : 'remove']('authenticated');\r\n\r\n  if(!message.token) root.sessions.url('/');\r\n\r\n  localStorage.setItem('authenticated', message.token || '');\r\n\r\n  root.sessions.load_page(null, { prevent_url: true });\r\n  \r\n}\r\n\r\nfunction notify(message) {\r\n\r\n  \tdocument.body.classList.add('notified');\r\n\r\n\tdocument.querySelector('#notification-message').innerHTML = message.error;\r\n\t\r\n}\r\n\r\nfunction merge(message){\r\n\r\n  if(!message.key) return;\r\n\r\n  let collection = message.key.split('_').slice(0, -1).join('_');\r\n\r\n  if(!root[collection]) return console.log(`collection <${ collection }> not found`);\r\n\r\n  if(!root[collection].memory[message.key]) {\r\n\r\n  \troot[collection].memory[message.key] = message;\r\n\r\n  \treturn root[collection].updated = true;\r\n\r\n  }\r\n  \r\n  root[collection].memory[message.key] = Object.assign(root[collection].memory[message.key] || {}, message);\r\n  \r\n}","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}